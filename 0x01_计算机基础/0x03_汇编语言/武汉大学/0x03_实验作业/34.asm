IO MACRO X,Y
   MOV AH,X
   LEA DX,Y
   INT 21H
   ENDM
DATAS SEGMENT USE16
   ARY DW 100H,250AH,0FF88H,8660H,40H,9500H,6000H,1200H,8008H,0A200H,2800H,0FF60H,0F50H
   LEN DW ($-ARY)/2
   V DW 1 DUP(0)
   COUN DB 1 DUP(0)
   TEN DW 10
   PROMPT1 DB 'The number is:',13,10,'$'
   PROMPT2 DB 'this average is:',13,10,'$'
   PROMPT3 DB 'The number bigger than average is:',13,10,'$'
   CRLF DB 13,10,'$'
   STR DB 7 DUP(0);用来储存显示的字符串
DATAS ENDS

STACKS SEGMENT USE16
   DB 128 DUP(0)
STACKS ENDS

CODES SEGMENT USE16
   ASSUME CS:CODES,DS:DATAS,SS:STACKS

START:
    MOV AX,DATAS
    MOV DS,AX

    IO 09H,PROMPT1
    LEA SI,ARY
    MOV CX,LEN
L:  MOV AX,[SI]
    CALL DISP
    CMP CL,1
    JZ S
    MOV DL,','
    MOV AH,2H
    INT 21H
S:  ADD SI,2
    LOOP L
    IO 09H,CRLF
    IO 09H,PROMPT2
    CALL AVER
    IO 09H,CRLF
    IO 09H,PROMPT3
    CALL BIG
    IO 09H,CRLF
    MOV AH,4CH
    INT 21H

DISP PROC NEAR
   PUSH BX
   PUSH AX
   PUSH SI
   PUSH CX
   PUSH DI
   MOV DI,0
   MOV CX,0
   OR AX,AX
   JNS L1
   MOV STR[DI],'-'
   INC DI
   NEG AX
L1:  XOR DX,DX
   DIV TEN
   PUSH DX
   INC CX
   CMP AX,0
   JNZ L1
L2: POP AX
   ADD AL,30H
   MOV STR[DI],AL
   INC DI
   LOOP L2
   MOV STR[DI],'$'
   IO 09H,STR 
   POP DI
   POP CX
   POP SI
   POP AX
   POP BX
   RET
DISP ENDP 
      
AVER PROC NEAR
   PUSH BX
   PUSH AX
   PUSH SI
   PUSH CX
   PUSH DI
   PUSH DX
   LEA SI,ARY
   MOV CX,LEN
   XOR AX,AX 
   XOR DX,DX
L3:  MOV BX,[SI]
   OR BX,BX
   JNS L5
   ADD DX,0FFFFH
L5:  ADD AX,BX
   ADC DX,0
   ADD SI,2
   LOOP L3
   MOV BX,LEN
   IDIV BX
   CALL DISP
   MOV V[0],AX
   POP DX
   POP DI
   POP CX
   POP SI
   POP AX
   POP BX
   RET
AVER ENDP

BIG PROC NEAR
   PUSH BX
   PUSH AX
   PUSH SI
   PUSH CX
   PUSH DI
   PUSH DX
   LEA SI,ARY
   MOV CX,LEN
   MOV BX,V[0]
L4:  MOV AX,[SI]
   CMP AX,BX
   JNG NEXT
   INC COUN
NEXT: ADD SI,2
   LOOP L4
   XOR AX,AX
   MOV AL,COUN
   CALL DISP   
   POP DX
   POP DI
   POP CX
   POP SI
   POP AX
   POP BX
   RET
BIG ENDP

CODES ENDS
   END START
