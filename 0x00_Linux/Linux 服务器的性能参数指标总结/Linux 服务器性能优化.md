Linux<br />Linux服务器全球知名，它和Windows之间最主要的差异在于，Linux服务器默认情况下一般不提供GUI(图形用户界面)，而是命令行界面，它的主要目的是高效处理非交互式进程，响应时间并不是那么重要，相反，能够长时间处理高负载才是最关键的。<br />Linux高可用服务器集群解决方案让IT系统管理员可以从容应对许多常见的硬件和软件故障，允许多台计算机一起工作，为关键服务正常运行提供保障，系统管理员可以不中断服务执行维护和升级。<br />Linux服务器有各种用途，如Web服务器或分支机构内部服务器，CMS或CRS服务器，文件服务器(为Windows和或Linux用户服务)，VoIP电话服务器，邮件或域名服务器，数据库服务器，云计算配置中的基础设施节点等。<br />Linux功能丰富、强大、灵活，可以用它完成各种任务，在这篇文章中，将讨论一些提高Linux服务器性能的技巧。
<a name="TifuC"></a>
## 1、为磁盘I/O调整Linux内核电梯算法
在选择文件系统后，有一些内核和挂载选项可能会影响到它的性能表现，其中一个内核设置是电梯算法，通过调整电梯算法，系统可以平衡低延迟需求，收集足够的数据，以有效地组织对磁盘的读和写请求。
<a name="ngOis"></a>
## 2、 禁用不必要的守护进程
每台服务器上都运行着许多守护进程或服务，而具有讽刺意味的是，有很多通常不是必需的，这些服务没有发挥作用，但却消耗了宝贵的内存和CPU时间。此外，它们可能将服务器置于危险境地，多运行一个服务就等于多向黑客打开一扇长驱直入的门，因此，应该将它们从服务器移除，禁用它们最大的好处是可以加快启动时间，释放内存。另外，可以减少CPU需要处理的进程数，禁用它们的另一个好处是增强服务器的安全性，因为越少的守护进程意味着可被攻击和利用的漏洞越少。<br />**下面是一些应该被禁用的Linux守护进程，默认情况下，它们都是自动运行的：**<br />序号     守护进程    描述<br />1    Apmd    高级电源管理守护进程<br />2    Nfslock    用于NFS文件锁定<br />3    Isdn    ISDN Moderm支持<br />4    Autofs    在后台自动挂载文件系统(如自动挂载CD-ROM)<br />5    Sendmail    邮件传输代理<br />6    Xfs    X Window的字体服务器
<a name="SQEEP"></a>
## 3、关掉GUI
一般说来，Linux服务器是不需要GUI的，所有管理任务都可以在命令行下完成，因此最好关掉GUI，重定向X显示或通过一个Web浏览器界面显示。为了禁用GUI，“init level(启动级别)”应该被设置为3(命令行登录)，而不是5(图形登录)，如果需要GUI，可以随时运行startx进入图形用户界面。
<a name="WJDxU"></a>
## 4、清理不需要的模块或功能
在服务器软件包中有太多被启动的功能或模块实际上是不需要的(如Apache中的许多功能模块)，仔细查看Apache配置文件，确定FrontPage支持或其它额外的模块是否真的要用到，如果不需要，应该毫不犹豫地从服务器禁用掉，这样有助于提高系统内存可用量，腾出更多资源给那些真正需要的软件，让它们运行得更快。
<a name="ZZMRA"></a>
## 5、禁用控制面板
在Linux中，有许多流行的控制面板，如Cpanel，Plesk，Webmin和phpMyAdmin等，相信每个Linux初级用户都很喜欢这些控制面板，但是，禁用掉这些软件包可以释放出大约120MB内存，因此，强烈建议禁用掉这些控制面板，除非它们真的需要用到，它们可以通过PHP脚本(尽管有些不安全)，或命令行命令启用，这样做后，内存使用量大约可以下降30-40%。
<a name="aIGF0"></a>
## 6、改善Linux Exim服务器性能
有许多种方法改善服务器的Exim性能，其中一个办法是使用DNS缓存守护进程，它可以降低解析DNS记录需要的带宽和CPU时间，DNS缓存通过消除每次都从根节点开始查找DNS记录的需求，从而改善网络性能，Djbdns是一个非常强大的DNS服务器，它具有DNS缓存功能，Djbdns比BIND DNS服务器更安全，性能更好，可以直接通过http://cr.yp.to/下载，或通过Red Hat提供的软件包获得。
<a name="U1tje"></a>
## 7、使用AES256增强gpg文件加密安全
为了提高备份文件或敏感信息的安全，许多Linux系统管理员都会使用gpg进行加密，在使用gpg时，最好指定gpg使用AES256加密算法，AES256使用256位密钥，它是一个开放的加密算法，美国国家安全局(NSA)都使用它保护绝密信息，没有什么比它更安全的了。
<a name="odR7L"></a>
## 8、远程备份服务安全
安全是选择远程备份服务最重要的因素，大多数系统管理员都害怕两件事：(黑客)可以删除备份文件，不能从备份恢复系统。<br />为了保证备份文件100%的安全，备份服务公司提供远程备份服务器，使用scp脚本或RSYNC通过SSH传输数据，这样，没有人可以直接进入和访问远程系统，因此，也没有人可以从备份服务删除数据。在选择远程备份服务提供商时，最好从多个方面了解其服务强壮性，如果可以，可以亲自测试一下。
<a name="Jc7WI"></a>
## 9、更新默认内核参数设置
为了顺利和成功运行企业应用程序，如数据库服务器，可能需要更新一些默认的内核参数设置，例如，2.4.x系列内核消息队列参数msgmni有一个默认值(例如，共享内存，或shmmax在Red Hat系统上默认只有33554432字节)，它只允许有限的数据库并发连接，下面为数据库服务器更好地运行提供了一些建议值(来自IBM DB2支持网站)：<br />kernel.shmmax=268435456 (32位) <br />kernel.shmmax=1073741824 (64位) <br />kernel.msgmni=1024 <br />fs.file-max=8192 <br />kernel.sem=”250 32000 32 1024″
<a name="oELnp"></a>
## 10、优化TCP
优化TCP协议有助于提高网络吞吐量，跨广域网的通信使用的带宽越大，延迟时间越长时，建议使用越大的TCP Linux大小，以提高数据传输速率，TCP Linux大小决定了发送主机在没有收到数据传输确认时，可以向接收主机发送多少数据。
<a name="RJjuW"></a>
## 11、选择正确的文件系统
使用ext4文件系统取代ext3

- Ext4是ext3文件系统的增强版，扩展了存储限制
- 它具有日志功能，保证高水平的数据完整性(在非正常关闭事件中)
- 在非正常关闭和重启时，它不需要检查磁盘(这是一个非常耗时的动作)
- 更快的写入速度，ext4日志优化了硬盘磁头动作
<a name="YKWCl"></a>
## 12、使用noatime文件系统挂载选项
在文件系统启动配置文件fstab中使用noatime选项，如果使用了外部存储，这个挂载选项可以有效改善性能。
<a name="ggEzZ"></a>
## 13、调整Linux文件描述符限制
Linux限制了任何进程可以打开的文件描述符数量，默认限制是每进程1024，这些限制可能会阻碍基准测试客户端(如httperf和apachebench)和Web服务器本身获得最佳性能，Apache每个连接使用一个进程，因此不会受到影响，但单进程Web服务器，如Zeus是每连接使用一个文件描述符，因此很容易受默认限制的影响。<br />打开文件限制是一个可以用ulimit命令调整的限制，ulimit -aS命令显示当前的限制，ulimit -aH命令显示硬限制(在未调整/proc中的内核参数前，不能增加限制)。
<a name="Rgf51"></a>
## Linux第三方应用程序性能技巧
对于运行在Linux上的第三方应用程序，一样有许多性能优化技巧，这些技巧可以提高Linux服务器的性能，降低运行成本。
<a name="EqhgT"></a>
## 14、正确配置MySQL
为了给MySQL分配更多的内存，可设置MySQL缓存大小，要是MySQL服务器实例使用了更多内存，就减少缓存大小，如果MySQL在请求增多时停滞不动，就增加MySQL缓存。
<a name="gnxyY"></a>
## 15、正确配置Apache
检查Apache使用了多少内存，再调整StartServers和MinSpareServers参数，以释放更多的内存，将有助于节省30-40%的内存。<br />下面是一些提高Linux服务器监控和故障排除的技巧：
<a name="mha2n"></a>
## 16、分析Linux服务器性能
提高系统效率最好的办法是找出导致整体速度下降的瓶颈并解决掉，下面是找出系统关键瓶颈的一些基本技巧：

- 当大型应用程序，如OpenOffice和Firefox同时运行时，计算机可能会开始变慢，内存不足的出现几率更高。
- 如果启动时真的很慢，可能是应用程序初次启动需要较长的加载时间，一旦启动好后运行就正常了，否则很可能是硬盘太慢了。
- CPU负载持续很高，内存也够用，但CPU利用率很低，可以使用CPU负载分析工具监控负载时间。
<a name="YEtBe"></a>
## 17、学习5个Linux性能命令
使用几个命令就可以管理Linux系统的性能了，下面列出了5个最常用的Linux性能命令，包括top、vmstat、iostat、free和sar，它们有助于系统管理员快速解决性能问题。
<a name="FCFiL"></a>
### 1、top
Top命令不仅显示了当前内核服务的任务，还显示了许多关于主机状态的统计数据，默认情况下，它每隔5秒自动更新一次显示的数据(这个时间间隔是可以配置的)，通过top命令，可以得知几个结果，如：当前正常运行时间，系统负载，进程数量和内存使用率，此外，这个命令也显示了那些使用最多CPU时间的进程(包括每个进程的各种信息，如运行用户，执行的命令等)。
<a name="ttt22"></a>
### 2、vmstat
Vmstat命令提供当前CPU、IO、进程和内存使用率的快照，它和top命令类似，自动更新数据，如：
```bash
$ vmstat 10
```
<a name="A3OTV"></a>
### 3、iostat
Iostat命令(在Ubuntu，Red Hat/Fedora上包含在sysstat软件包中)提供三个报告：CPU利用率、设备利用率和网络文件系统利用率，不加任何参数运行时，iostat将显示这三个报告，使用-c，-d和-h参数可以分别独立显示这三个报告。
<a name="kXivQ"></a>
### 4、free
Free命令显示主内存和交换空间的内存统计数据，指定-t参数可以显示总内存数量，指定-b参数可以按字节为单位进行显示，使用-m则以兆为单位显示，默认情况下是以千字节为单位的。<br />Free命令也可以使用-s参数加一个延迟时间(单位：秒)连续运行，如：
```bash
$ free -s 5
```
<a name="oEQsX"></a>
### 5、sar
Sar命令收集，查看和记录性能数据，这个命令比前面几个命令历史更悠久，它可以收集和显示较长周期的数据。
<a name="la4bt"></a>
## 其它
下面是一些归类为其它的性能技巧：
<a name="aswqg"></a>
## 18、将日志文件转移到内存中
当一台机器处于运行中时，最好是将系统日志放在内存中，当系统关闭时再将其复制到硬盘，当运行一台开启了syslog功能的笔记本电脑或移动设备时，ramlog可以提高系统电池或移动设备闪存驱动器的寿命，使用ramlog的一个好处是，不用再担心某个守护进程每隔30秒向syslog发送一条消息，放在以前，硬盘必须随时保持运转，这样对硬盘和电池都不好。
<a name="YD9xq"></a>
## 19、先打包，后写入
在内存中划分出固定大小的空间保存日志文件，这意味着笔记本电脑硬盘不用一直保持运转，只有当某个守护进程需要写入日志时才运转，注意ramlog使用的内存空间大小是固定的，否则系统内存会很快被用光，如果笔记本使用固态硬盘，可以分配50-80MB内存给ramlog使用，ramlog可以减少许多写入周期，极大地提高固态硬盘的使用寿命。
<a name="ivHu9"></a>
## 20、一般调优技巧
尽可能使用静态内容替代动态内容，如果在生成天气预告，或其它每隔1小时就必须更新的数据，最好是写一个程序，每隔1小时生成一个静态的文件，而不是让用户运行一个CGI动态地生成报告。<br />为动态应用程序选择最快最合适的API，CGI可能最容易编程，但它会为每个请求产生一个进程，通常，这是一个成本很高，且不必要的过程，FastCGI是更好的选择，和Apache的mod_perl一样，都可以极大地提高应用程序的性能。
