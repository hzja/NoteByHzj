Python<br />![](./img/1676171197483-f4aca66b-0acb-48dc-8d39-41010c73b881.gif)<br />è¿™æ˜¯ä¸€ä½ä¸“æ”»Pythonè¯­è¨€çš„ç¨‹åºå‘˜å¼€å‘çš„å®‰è£…åŒ…ï¼Œåå«Pynimateã€‚<br />ç›®å‰å¯ä»¥ç›´æ¥é€šè¿‡PyPIå®‰è£…ä½¿ç”¨ã€‚
<a name="t4bJS"></a>
## ä½¿ç”¨æŒ‡å—
æƒ³è¦ä½¿ç”¨Pynimateï¼Œç›´æ¥`import`ä¸€ä¸‹å°±è¡Œã€‚
```python
import pynimate as nim
```
è¾“å…¥æ•°æ®åï¼ŒPynimateå°†ä½¿ç”¨å‡½æ•°`Barplot()`æ¥åˆ›å»ºæ¡å½¢æ•°æ®åŠ¨ç”»ã€‚<br />è€Œåˆ›å»ºè¿™ç§åŠ¨ç”»ï¼Œè¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯pandasæ•°æ®ç»“æ„ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œå…¶ä¸­å°†æ—¶é—´åˆ—è®¾ç½®ä¸ºç´¢å¼•ï¼Œæ¢å¥è¯è¯´ç´¢å¼•ä»£è¡¨çš„æ˜¯è‡ªå˜é‡ã€‚
```
time, col1, col2, col3
2012   1     2     1
2013   1     1     2
2014   2     1.5   3
2015   2.5   2     3.5
```
å…·ä½“çš„ä»£ç å½¢å¼å¦‚ä¸‹ï¼š
```python
import pandas as pd
df = pd.read_csv('data'csv').set_index('time')
```
æ¯”å¦‚è¦å¤„ç†å…·ä½“çš„æ•°æ®ï¼Œå†™æˆä»£ç åº”è¯¥æ˜¯è¿™æ ·å­çš„ã€‚
```python
df = pd.DataFrame(
    {
        "time": ["1960-01-01", "1961-01-01", "1962-01-01"],
        "Afghanistan": [1, 2, 3],
        "Angola": [2, 3, 4],
        "Albania": [1, 2, 5],
        "USA": [5, 3, 4],
        "Argentina": [1, 4, 5],
    }
).set_index("time")
```
æ­¤å¤–ï¼Œè¦åˆ¶ä½œæ¡å½¢æ•°æ®åŠ¨ç”»ï¼ŒBarplotè¿˜æœ‰ä¸‰ä¸ªå¿…éœ€çš„å‚æ•°å¾—æ³¨æ„ï¼šdataã€time_formatå’Œip_freqï¼ˆInterpolation frequencyï¼‰ã€‚<br />dataå°±æ˜¯è¡¨æ ¼çš„æ•°æ®ï¼Œè¿™é‡Œä¹Ÿå°±ä¸å†èµ˜è¿°ã€‚<br />time_formatæ˜¯æŒ‡æ•°æ®ç´¢å¼•çš„æ—¶é—´æ—¥æœŸæ ¼å¼ï¼Œä¸€èˆ¬ä¸ºï¼šâ€%Y-%m-%dâ€ã€‚<br />æœ€åæ˜¯ip_freqï¼Œå®ƒæ˜¯åˆ¶ä½œåŠ¨ç”»ä¸­æ¯”è¾ƒå…³é”®çš„ä¸€æ­¥ï¼Œé€šè¿‡çº¿æ€§æ’å€¼ä½¿åŠ¨ç”»æ›´åŠ æµç•…ä¸æ»‘ã€‚<br />ä¸€èˆ¬æ¥è¯´ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åŸå§‹æ•°æ®éƒ½é€‚åˆåšæˆåŠ¨ç”»ï¼Œç°åœ¨ä¸€ä¸ªå…¸å‹çš„è§†é¢‘æ˜¯24fpsï¼Œå³æ¯ç§’æœ‰24å¸§ã€‚<br />ä¸¾ä¸ªæ —å­ğŸŒ°ï¼Œä¸‹é¢è¿™ä¸ªè¡¨æ ¼ä¸­çš„æ•°æ®åªæœ‰ä¸‰ä¸ªæ—¶é—´ç‚¹ï¼ŒæŒ‰ç†è¯´åªèƒ½ç”Ÿæˆ3å¸§è§†é¢‘ï¼Œæœ€ç»ˆåŠ¨ç”»ä¹Ÿåªæœ‰3/24ç§’ã€‚
```
time, col1, col2
2012   1     3  
2013   2     2   
2014   3     1
```
è¿™æ—¶å€™ï¼Œip_freqæ’å€¼ï¼ˆçº¿æ€§ï¼‰å°±å¼€å§‹å‘æŒ¥ä½œç”¨äº†ï¼Œå¦‚æœæ’å€¼æ˜¯ä¸€ä¸ªå­£åº¦ï¼Œåˆ™å¾—å‡ºçš„æ•°æ®å°±å˜æˆäº†è¿™æ ·ï¼š
```
time     col1  col2
2012-01-01  1.00  3.00
2012-04-01  1.25  2.75
2012-07-01  1.50  2.50
2012-10-01  1.75  2.25
2013-01-01  2.00  2.00
2013-04-01  2.25  1.75
2013-07-01  2.50  1.50
2013-10-01  2.75  1.25
2014-01-01  3.00  1.00
```
å…·ä½“çš„æ’å€¼æ—¶é—´é—´éš”ä¸ºå¤šä¹…ï¼Œåˆ™è¦è§†å…·ä½“çš„æ•°æ®è€Œå®šï¼Œä¸€èˆ¬ç»˜åˆ¶å¤§æ•°æ®æ—¶ï¼Œè®¾ç½®ä¸º`ip_freq = None`ã€‚<br />è‡³æ­¤ï¼Œå°±èƒ½ç”Ÿæˆæ•°æ®åŠ¨ç”»äº†ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š
```python
from matplotlib import pyplot as plt
import pandas as pd
import pynimate as nim

df = pd.DataFrame(
    {
        "time": ["1960-01-01", "1961-01-01", "1962-01-01"],
        "Afghanistan": [1, 2, 3],
        "Angola": [2, 3, 4],
        "Albania": [1, 2, 5],
        "USA": [5, 3, 4],
        "Argentina": [1, 4, 5],
    }
).set_index("time")

cnv = nim.Canvas()
bar = nim.Barplot(df, "%Y-%m-%d", "2d")
bar.set_time(callback=lambda i, datafier: datafier.data.index[i].year)
cnv.add_plot(bar)
cnv.animate()
plt.show()
```
è¿™æ˜¯æ’å€¼ä¸ºä¸¤å¤©ï¼Œç”Ÿæˆçš„åŠ¨ç”»æ•ˆæœã€‚<br />![](./img/1676171182454-e06de51a-fada-4392-87a0-c867beedaff5.gif)<br />æœ€åè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¿å­˜åŠ¨ç”»ï¼Œæœ‰ä¸¤ä¸ªæ ¼å¼å¯ä»¥é€‰æ‹©ï¼šgifæˆ–è€…mp4ã€‚<br />ä¿å­˜ä¸ºåŠ¨å›¾ä¸€èˆ¬ä½¿ç”¨ï¼š
```python
cnv.save("file", 24, "gif")
```
è‹¥è¦ä¿å­˜ä¸ºmp4çš„è¯ï¼Œffmpegæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå®ƒæ˜¯ä¿å­˜ä¸ºmp4çš„æ ‡å‡†ç¼–å†™å™¨ã€‚
```bash
pip install ffmpeg-python
```
æˆ–è€…
```bash
conda install ffmpeg
```
å½“ç„¶ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨`Canvas.save()`æ¥ä¿å­˜ã€‚
```python
cnv.save("file", 24 ,"mp4")
```
