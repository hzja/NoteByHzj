​	信息论是应用数学的一个分支，主要研究的是对一个信号包含信息的多少进行量化。信息论的基本想法是一个不太可能发生的事件居然发生了，要比一个非常可能发生的事件发生，能提供更多的信息。消息说“今天早上太阳升起”，信息量是如此之少，但一条消息说“今天早上有日食”，信息量就很丰富了。我们想通过这种基本想法来量化信息

- 非常可能发生的事件信息量比较少，并且极端情况下，确保能够发生的事件应该没有信息量
- 较不可能发生的事件具有更高的信息量
- 独立事件应具有增量的信息。如扔硬币两次正面朝上传递的信息量，应是投掷一次正面朝上的信息量的两倍



​	信息论可和深度神经网络的每一层一一对应，从而无缝链接到神经网络中，构造完美的损失函数。换句话说，香农的信息论是概率论和深度学习的完美桥梁。

- 第一层，信息量：概率分布能带来的信息，对应神经网络的一个神经元。
- 第二层，香农熵：概率分布的系统的混乱程度，对应神经元组成的神经网络。
- 第三层，KL散度/交叉熵：两个概率系统的相对混乱程度，对应人脑和人工神经网络（深度学习网络）。

![信息论.jpeg](./img/信息论.jpeg)


# 信息熵

​	如果![](./img/02129bb861061d1a052c592e2dc6b383 (6).svg)是一个离散型随机变量，取值空间为![](./img/2369a2488f59aa39a3fca53e0eff9f88.svg)，其概率分布为![](./img/d81c89f127111ab9020bcae2509e68d8.svg)，那么熵：

![](./img/18616b727fd8a9ebb0f07f0495002125.svg)

​	熵又称为自信息，可以视为描述一个随机变量的不确定性的数量。它表示信号源![](./img/02129bb861061d1a052c592e2dc6b383 (6).svg)每发一个符号所提供的的平均信息量。一个随机变量的熵越大，它的不确定性越大，那么正确估计其值的可能性就越小。越不确定的随机变量越需要大的信息量用以确定其值。

​	在只掌握关于未知分布的部分知识的情况下，符合已知知识的概率分布可能有多个，但使熵值最大的概率分布最真实地反映了事件的分布情况，因为熵定义了随机变量的不确定性，当熵最大时，随机变量最不确定，最难准确地预测其行为。也就是说，在已知部分知识的前提下，关于未知分布最合理的推断应该是符合已知知识最不确定或最大随机的推断。最大熵概念被广泛地应用于自然语言处理中，通常的做法是，根据已知样本设计特征函数，假设存在![](./img/8ce4b16b22b58894aa86c421e8759df3 (4).svg)个特征函数![](./img/6937e7a58617639b0eb4dffcd1f4cc9f.svg)，它们都在建模过程中对输出有影响，那么，所建立的模型应满足所有这些特征的约束，即所建立的模型![](./img/83878c91171338902e0fe0fb97a8c47a (2).svg)应该属于这![](./img/8ce4b16b22b58894aa86c421e8759df3 (4).svg)个特征函数约束下所产生的所有模型的集合![](./img/0d61f8370cad1d412f80b84d143e1257 (1).svg)。使熵![](./img/aab15aa2fab55413f9061332a16f15f1.svg)值最大的模型用来推断某种语言现象存在的可能性，或者作为进行某种处理操作的可靠性依据，即：

![](./img/eabc50eac797d10be612ce4668b9b3e3.svg)



**Example**

​	**例子1：**设a,b,c,d,e,f这6个字符在某一语言中随机出现，出现概率为1/8,1/4,1/8,1/4,1/8,1/8。每个字符的熵为

![](./img/4b76f714600f0b87a010a00967d5e7fb.svg)

​	这个结果表明，我们可以设计一种编码，传输一个字符平均只需要2.5个比特。



​	**例子2：**我面试时遇到这样一道题，1000杯水中只有1杯有毒，问需要最少几只小白鼠能找到有毒的那杯。

​	解答即![](./img/5d732a30a89aa5e477a11366a059128d.svg)

​	10只就可以。实际操作方案就是1000可用10位2进制(到1024)表示，看哪几只小白鼠挂掉就可以找到对应编号水



​	**例子3：**例2进阶版，为防止爱鼠人士表示谴责，我们改为可爱的猪。1000桶水，其中一桶有毒，猪喝毒水后会在15分钟内死去，想用1个小时找到这桶毒水，至少需要几头猪？

​	有了前面简化的版本(例子2)的理解，我们容易得知“1000桶水其中有一桶有毒”的信息熵为

![](./img/9f494dbdf8c05c5646cd56ffdb5f0652.svg)



而对于猪的状态就不太一样了，我们可以想象一下，一只猪在一个小时内会有几种状态？

1. 在第0分钟的时候喝了一桶水以后，第15分钟死去
2. 第15分钟依然活着，喝了一桶水后，第30分钟死去
3. 第30分钟依然活着，喝了一桶水后，第45分钟死去
4. 第45分钟依然活着，喝了一桶水后，第60分钟死去
5. 第45分钟依然活着，喝了一桶水后，第60分钟依然活着

可见，1只可爱的猪猪在有5种状态，“1只猪1个小时后的状态”的信息熵为

![](./img/2f2c9da63eaa1222c78b94de8c84d417.svg)

![](./img/7b8b965ad4bca0e41ab51de7b31363a1 (6).svg)只猪1小时后有![](./img/846cb42ab1af34d8270104cd7cc59528.svg)种状态，即“![](./img/7b8b965ad4bca0e41ab51de7b31363a1 (6).svg)只猪1个小时后的状态”的信息墒为

![](./img/c4c1e9ed37e6faf26c4eb7e1bf0cb452.svg)

所以，按照题目要求![](./img/7b8b965ad4bca0e41ab51de7b31363a1 (6).svg)头猪能够找到这桶毒水，那么信息墒![](./img/57cec4137b614c87cb4e24a3d003a3e0 (2).svg)必须要大于信息墒![](./img/02129bb861061d1a052c592e2dc6b383 (7).svg)，也就是

![](./img/8e5c72672ec89775f06b2d0ca2efec52.svg)，即![](./img/d41d4fa6548c0fc3b5325c8a3ba5caba.svg)，其![](./img/44d21af66b0874d9b45905ea79807cb3.svg)
# 条件熵

给定随机变量![](./img/02129bb861061d1a052c592e2dc6b383 (6).svg)的情况下，随机变量![](./img/57cec4137b614c87cb4e24a3d003a3e0 (3).svg)的条件熵定义为：

![](./img/d52c1e4e31fdffaa136c3e25532c917e.svg)

                                                               ![](./img/82e49ef4770c1f34d41c142da5f318bb.svg)

                                                               ![](./img/c8de634b6daa11e9fb88923da8cf87f8.svg)



# 联合熵

如果![](./img/02129bb861061d1a052c592e2dc6b383 (6).svg)，![](./img/57cec4137b614c87cb4e24a3d003a3e0 (3).svg)是一对离散型随机变量![](./img/2f5a5dc2695578057c79f75139e973e0.svg)，![](./img/02129bb861061d1a052c592e2dc6b383 (8).svg)，![](./img/57cec4137b614c87cb4e24a3d003a3e0 (3).svg)的联合熵![](./img/963967609ae26f6264c08a8755114f86.svg)定义为

![](./img/ed2f167b4b581ea0696d50b44c0cb55a.svg)

联合熵实际上就是描述一对随机变量平均所需要的信息量。将上式中的联合概率![](./img/a2d41460e1beae942cab9332c0c421ca.svg)展开可得：

![](./img/ed2f167b4b581ea0696d50b44c0cb55a (1).svg)

                                                           ![](./img/90d22f4009fa670b4fe44e3ac5a11910.svg)

                                                           ![](./img/f2e42e51dfb2a608ca1c53ad1ce37022.svg)

                                                           ![](./img/a5eca565262fb8b43aa15e8dd77bd0bd.svg)

                                                           ![](./img/ee15e1e13020ca11535ed91ca879880c.svg)

                                                           ![](./img/1f4619d217c4cd00355b7f2018485da6.svg)

我们称![](./img/4c75a15acaeee97458b33cf0f37365b8.svg)为熵的连锁规则。推广到一般情况，有

![](./img/f93f51b32e737825040991e76be45b1c.svg)



**Example**

​	假设某种语言的字符有元音和辅音两类，其中，元音随机变量![](./img/dd6f61ac4d901bc4645bd20ddf346b0b.svg)，辅音随机变量![](./img/124e3033a086dd5a36fa7d905c007d46.svg)。如果该语言的所有单词都由辅音-元音音节序列组成，其联合概率分布![](./img/b5f5c4e2dbc219de2361c1cdb83bd915.svg)如下

| 元/辅 | p | t | k |
| --- | --- | --- | --- |
| a | 1/16 | 3/8 | 1/16 |
| i | 1/16 | 3/16 | 0 |
| u | 0 | 3/16 | 1/16 |



​	我们不难算出p,t,k,a,i,u这6个字符的边缘概率(就是单词中含有这个音的概率)分别为：![](./img/c3e55906a11a266b0345349c3ec379a0.svg) , 3/4, 1/8, 1/2, 1/4, 1/4。但需要注意的是，这些边缘概率是基于音节的，每个字符的概率是基于音节的边缘概率的![](./img/93b05c90d14a117ba52da1d743a43ab1.svg)（即若选中t，前提是先选中辅音音节，又元-辅概率为![](./img/93b05c90d14a117ba52da1d743a43ab1.svg))，因此每个字符的概率值实际为：1/16, 3/8, 1/16, 1/4, 1/8, 1/8。现求联合熵：

方法一（套公式）：

![](./img/7e3cb399887f2f34f54fc6000feedafc.svg)

![](./img/46f1d68c648702688841ff4f93756bdc.svg)



方法二（连锁规则）：

![](./img/b211d97cc651e1435781495601774856.svg)

![](./img/a5235c4860a308684f15f1093132246b.svg)

![](./img/21e152c3d880368c24b679908fa444ad.svg)



# 互信息

根据熵的连锁规则，有

![](./img/88989840d4df077bd0d3142465255fff.svg)

因此，

![](./img/5eaa55703f6dd717a55b5f6cf471bfd2.svg)

这个差叫做![](./img/02129bb861061d1a052c592e2dc6b383 (6).svg)和![](./img/57cec4137b614c87cb4e24a3d003a3e0 (3).svg)的互信息(Mutual Information, MI)，记作![](./img/72268ae9e9e089bc0ae3c61b7435f434.svg)。或者定义为：如果![](./img/89e48f279aed58ed8254b130f14f1248.svg)，则![](./img/d23a4ce8bca0f4891e037439a79b45a6.svg)之间的互信息![](./img/f5858d01b70d43246d4922d42fbea690.svg)

![](./img/72268ae9e9e089bc0ae3c61b7435f434 (1).svg)反映的是在知道了![](./img/57cec4137b614c87cb4e24a3d003a3e0 (4).svg)的值以后![](./img/02129bb861061d1a052c592e2dc6b383 (9).svg)的不确定性的减少量。可以理解为![](./img/57cec4137b614c87cb4e24a3d003a3e0 (4).svg)的值透露了多少关于![](./img/02129bb861061d1a052c592e2dc6b383 (9).svg)的信息量。

![互信息.png](./img/1592207021754-8c5b7c11-22a0-4e72-965c-6bd6cf2d8171.png)

​	互信息度量的是两个随机变量之间的统计相关性，是从随机变量整体角度，在平均的意义上观察问题，因此通常称之为平均互信息。平均互信息是非负的额，即![](./img/c0228477ba02927d81e47f775f1ff732.svg)。在自然语言处理中通常利用这一测度判断两个对象之间的关系，如根据主题类别和词之间互信息大小进行特征词提取。互信息在词汇聚类、汉语自动分词、词义消歧、文本分类和聚类等问题研究中有重要通途。

# 相对熵

相对熵又称KL散度，衡量相同事件空间里两个概率分布相对差距。两个概率分布![](./img/4130c89f2d12c3ac81aba3adbff28685.svg)和![](./img/9dbcf8f4523b910764da7f544a192a69.svg)的相对熵定义为

![](./img/bf373ef671b950e44d50507f99679db9.svg)

该定义中约定![](./img/a893e90131c995f3831939fccd5d9a71.svg)。表示成期望为：

![](./img/cec22495484f969c002012b34220217b.svg)

当两个随机分布完全相同时，即![](./img/135775cf204e9ca61b62e5b1cb21e493.svg)，其相对熵为![](./img/cfcd208495d565ef66e7dff9f98764da (3).svg)。当两个随机分布的差别增大时，其相对熵期望值也增大。

互信息实际上就是衡量一个联合分布与独立性差距多大的测度：

![](./img/680f909be7585a10c38654d755673ae6.svg)

                                                                 ![](./img/2cbacbcad800f7090463845b5ab58370.svg)

                                                                 ![](./img/c4a477d9e67258b3a798a285eac64895.svg)

                                                                 ![](./img/5fe3c20fe5caf793fe61dc2c1e1202ba.svg)

                                                                 ![](./img/916332499bf9f14e556b3d07ec254348.svg)





# 交叉熵

根据熵的定义，知道熵是一个不确定性的测度，也就是说，我们对于某件事情知道得越多，那么，熵就越小，因而对于试验的结果我们越不感到意外。交叉熵的概念就是用来衡量估计模型与真实概率分布之间差异情况的。

如果一个随机变量![](./img/280fafd2337ea81d4b1ac699d3b0f6a4.svg)，![](./img/9dbcf8f4523b910764da7f544a192a69 (1).svg)为用于近似![](./img/4130c89f2d12c3ac81aba3adbff28685 (1).svg)的概率分布，那随机变量![](./img/02129bb861061d1a052c592e2dc6b383 (10).svg)和模型![](./img/7694f4a66316e53c8cdd9d9954bd611d.svg)之间的交叉熵定义为：

![](./img/49f78b70ee7f16bc1d69c2891d738050.svg)


# Source
[香农的信息论究竟牛在哪里？ - 知乎](https://www.zhihu.com/question/27068465/answer/2517655344)
