哈希编码就如同从一组图像中学习到一种映射![](./img/8fa14cdd754f91cc6554c9e71929cce7.svg)，![](./img/8fa14cdd754f91cc6554c9e71929cce7.svg)可以使图像映射至二值的哈希编码上。可以想见，这是一个困难的问题。对于这个问题，传统方法的解决思路是：先对原图像用人工提取的特征来表达，即先从原图像压缩至特征表达，然后再从特征表达映射至哈希编码。

以[KSH（Supervised Hashing with Kernel）](https://dl.acm.org/citation.cfm?id=2355047)为例，其所代表的算法如下。

1. 提取特征。在训练集![](./img/b9ece18c950afbfa6b0fdbfa4ff731d3.svg)内共含![](./img/69691c7bdcc3ce6d5d8a1361f22d04ac.svg)张图，遍历![](./img/71b9ad04aff480dd7485124a1a8feff3.svg)，对第![](./img/6f8f57715090da2632453988d9a1501b.svg)张图提取人工特征，如HoG、SIFT等，然后将特征连接起来形成一个长向量来表达该图：![](./img/cea692e48ca6e3df3b531b7964927a67.svg)。
2. 分解相似度矩阵。
   1. 将![](./img/b9ece18c950afbfa6b0fdbfa4ff731d3.svg)按照标准的两两相似/不相似结果构建矩阵![](./img/5dbc98dcc983a70728bd082d1a47546e.svg)。（即1为相似，0为不相似，则![](./img/5dbc98dcc983a70728bd082d1a47546e.svg)为0和1组成的矩阵，且![](./img/6d0b74a16b5d60fa56c04e0e31579c4f.svg)为图![](./img/865c0c0b4ab0e063e5caa3387c1a8741.svg)和图![](./img/363b122c528f54df4a0446b6bab05515.svg)相似与否的标注结果。）
   2. 将![](./img/5dbc98dcc983a70728bd082d1a47546e.svg)分解成![](./img/814300e61d392b1418176bca5559ad5d.svg)，使得![](./img/48cab0a91d41fb8568a0dee345e086fa.svg)，则![](./img/c1d9f50f86825a1a2302ec2449c17196.svg)为训练集![](./img/b9ece18c950afbfa6b0fdbfa4ff731d3.svg)对应的哈希编码矩阵，其第![](./img/6f8f57715090da2632453988d9a1501b.svg)行对应图片![](./img/6f8f57715090da2632453988d9a1501b.svg)的哈希编码值。
3. 求得特征表达至哈希值的映射![](./img/b2f5ff47436671b6e533d8dc3614845d.svg)：![](./img/817f8b45f5e5822b002cd518c27b0353.svg)。训练学习结束。
4. 测试时，对应图片![](./img/dd7536794b63bf90eccfd37f9b147d7f.svg)，先同样提取特征表达![](./img/481b463dd6cb8082493e0e9d2c52c974.svg)，再根据映射![](./img/b2f5ff47436671b6e533d8dc3614845d.svg)得到其哈希编码![](./img/de6095d44382866a6b75cda959b8ba93.svg)

从以上步骤可以看出，难点集中在第（2b）步，即将相似度矩阵![](./img/5dbc98dcc983a70728bd082d1a47546e.svg)分解成可能的哈希编码矩阵![](./img/814300e61d392b1418176bca5559ad5d.svg)，并且约束![](./img/c1d9f50f86825a1a2302ec2449c17196.svg)的取值为0或1。因此，研究者针对如何近似分解相似度矩阵做了大量艰苦的工作。尽管如此，传统方法还是有很大的局限性的。比如，如果训练集过大，则意味着![](./img/5dbc98dcc983a70728bd082d1a47546e.svg)也会过大，分解起来会变的十分困难，甚至不可达成。

而深度学习介入后，这些局限被逐渐打破。深度学习的应用也不是一蹴而就的，在逐步尝试和摸索后，终于找到了一条简捷有力的途径。
