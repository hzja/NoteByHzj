<a name="XVKvh"></a>
## R-gghalves包将图表“合”起来
要想使多个图合理放置，做到既不能互相遮挡又不能更改大小、位置等属性，确实较为麻烦。而R-gghalves包则可以很好的解决这个问题，gghalves包可轻松绘制半面图，如将箱线图分半，这样就可以实现在箱线图旁绘制其他的图表类型。官网为：[https://erocoar.github.io/gghalves/](https://erocoar.github.io/gghalves/)。接下来，简单介绍下R-gghalves的主要绘图函数：

- `geom_half_boxplot()`：绘制半箱线图
- `geom_half_violin()`：绘制半小提琴图
- `geom_half_point()`：绘制半点图

由于以上绘图函数和ggplot2中对应的`geom_boxplot()`、`geom_violin()`、`geom_point()`参数类似，这里不再过多赘述。需要注意的是上述三个绘图函数中有一个特殊参数`-side`用于显示哪一半图形，`l`代表左，`r`代表右，默认值为`l`。
<a name="JCIw8"></a>
## R-gghalves包实例演示
<a name="g0asp"></a>
### 「`geom_half_point()`」
在使用`geom_half_point()`函数绘制之前，先使用`geom_point()`绘制，以便大家更好理解：
```r
point <- ggplot(iris, aes(x = Species, y = Sepal.Width)) + 
  geom_point(shape=21,size=3,fill="#A593E0",colour="black",stroke=.8) +
  labs(
    title = "Example of <span style='color:#D20F26'>gghalves::geom_half_point function</span>",
    subtitle = "processed charts with <span style='color:#1A73E8'>geom_point()</span>",
    caption = "Visualization by <span style='color:#DD6449'>DataCharm</span>") +
  hrbrthemes::theme_ipsum(base_family = "Roboto Condensed") +
  theme(
    plot.title = element_markdown(hjust = 0.5,vjust = .5,color = "black",
                                  size = 20, margin = margin(t = 1, b = 12)),
    plot.subtitle = element_markdown(hjust = 0,vjust = .5,size=15),
    plot.caption = element_markdown(face = 'bold',size = 12))
```
![](https://cdn.nlark.com/yuque/0/2021/png/396745/1622900946322-4693fec8-04c3-4d41-a8a1-36ede8c7f679.png#clientId=ub0f10706-f17f-4&from=paste&id=u98feaa14&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=u10fc86a3-9473-43b5-9e51-8db56b3b06a)<br />Example of geom_point()<br />接下来使用`geom_half_point()`绘制：
```r
half_point <- ggplot(iris, aes(x = Species, y = Sepal.Width)) + 
  geom_half_point(shape=21,size=3,fill="#A593E0",colour="black",stroke=.8,side = "l") 
```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900946296-ca37d9ea-dfc1-4e86-a5ab-33c67a5fd10d.webp#clientId=ub0f10706-f17f-4&from=paste&id=u0e54192b&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=ud6b4e16f-06ce-4383-a111-2df0cc97f77)<br />Example of geom_half_point<br />可以看出，`geom_half_point()`使点在水平或者垂直方向上进行抖动，而 `side = "l"` 的设置则使其左移。<br />此外，当对不同类别的数据点进行绘制时，则需要使用`geom_half_point_panel()`，这里和箱线图一同绘制：
```r
ggplot(iris, aes(y = Sepal.Width)) +
  geom_boxplot(fill="#A593E0") +
  geom_half_point_panel(shape=21,size=2.5,colour="black",stroke=.8,
                        aes(x = 0.5, fill = Species),
                        transformation = ggbeeswarm:::position_quasirandom()) 
```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900946201-547c97c1-24fe-4848-b8d6-c41b396b419b.webp#clientId=ub0f10706-f17f-4&from=paste&id=u9880ca50&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=u3a799b4f-f002-458a-903b-084909505fe)<br />Example of geom_half_point_panel and geom_boxplot
<a name="WHfDs"></a>
### 「`geom_half_boxplot()`」
还是一样，首先使用`geom_boxplot()`绘制：
```r
gplot(iris, aes(x = Species, y = Sepal.Width,fill=Species)) +
  geom_boxplot() +
  ggsci::scale_fill_nejm()+
  labs(
    title = "Example of <span style='color:#D20F26'>gghalves::geom_half_boxplot function</span>",
    subtitle = "processed charts with <span style='color:#1A73E8'>geom_boxplot()</span>",
    caption = "Visualization by <span style='color:#0057FF'>DataCharm</span>") +
  hrbrthemes::theme_ipsum(base_family = "Roboto Condensed") +
  theme(
    plot.title = element_markdown(hjust = 0.5,vjust = .5,color = "black",
                                  size = 20, margin = margin(t = 1, b = 12)),
    plot.subtitle = element_markdown(hjust = 0,vjust = .5,size=15),
    plot.caption = element_markdown(face = 'bold',size = 12))
```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900946221-79dc0a51-9d5c-41e2-938e-1c4cc9ddbdaf.webp#clientId=ub0f10706-f17f-4&from=paste&id=ua9e57ef7&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=ua2aae045-6bd0-4bf6-9077-04db31483a1)<br />Example of geom_boxplot<br />`geom_half_boxplot()`:
```r
ggplot(iris, aes(x = Species, y = Sepal.Width,fill=Species)) +
  geom_half_boxplot(side = "r")
```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900945916-5756635d-f456-487f-8e8f-dc8ea29f0098.webp#clientId=ub0f10706-f17f-4&from=paste&id=u842dfa16&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=ueeb78e83-8de0-40c4-bc49-1f8967655b2)<br />Example of geom_half_boxplot
<a name="DNtWW"></a>
### 「`geom_half_violin()`」
这里直接绘制`geom_half_violin()`结果：
```r
ggplot(iris, aes(x = Species, y = Sepal.Width,fill=Species)) +
  geom_half_violin(side="r") +
  ggsci::scale_fill_nejm() +
  labs(
    title = "Example of <span style='color:#D20F26'>gghalves::geom_half_violin function</span>",
    subtitle = "processed charts with <span style='color:#1A73E8'>geom_half_violin()</span>",
    caption = "Visualization by <span style='color:#0057FF'>DataCharm</span>") +
  hrbrthemes::theme_ipsum(base_family = "Roboto Condensed") +
  theme(
    plot.title = element_markdown(hjust = 0.5,vjust = .5,color = "black",
                                  size = 20, margin = margin(t = 1, b = 12)),
    plot.subtitle = element_markdown(hjust = 0,vjust = .5,size=15),
    plot.caption = element_markdown(face = 'bold',size = 12))
```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900946655-8514fac2-7490-45a6-879b-1a5e02649b23.webp#clientId=ub0f10706-f17f-4&from=paste&id=ueb66f16f&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=ud2675697-6243-479b-a396-e1c6040ae8c)<br />Example of geom_half_violin()
<a name="nrYZD"></a>
### 「`geom_half_dotplot()`」
```r
ggplot(iris, aes(x = Species, y = Sepal.Width)) +
  geom_half_violin(data = iris,aes(fill=Species)) + 
  geom_dotplot(shape=21,binaxis = "y", method="histodot", stackdir="up",fill="#A593E0",
              colour="black",stroke=1)+
  ggsci::scale_fill_nejm() +
  labs(
    title = "Example of <span style='color:#D20F26'>gghalves::geom_half_violin function</span>",
    subtitle = "processed charts with <span style='color:#1A73E8'>geom_violin()+geom_dotplot</span>",
    caption = "Visualization by <span style='color:#0057FF'>DataCharm</span>") +
  hrbrthemes::theme_ipsum(base_family = "Roboto Condensed") +
  theme(
    plot.title = element_markdown(hjust = 0.5,vjust = .5,color = "black",
                                  size = 20, margin = margin(t = 1, b = 12)),
    plot.subtitle = element_markdown(hjust = 0,vjust = .5,size=15),
    plot.caption = element_markdown(face = 'bold',size = 12))

```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900947138-d6a83526-a761-446f-868b-42d57391a3cd.webp#clientId=ub0f10706-f17f-4&from=paste&id=u866245da&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=u91a87cb6-fad8-4251-9af8-6d28ab9b88f)<br />Example of geom_half_violin_dotplot()<br />当然，还可以这样：
```r
ggplot(iris, aes(x = Species, y = Sepal.Width,fill=Species)) +
  geom_half_violin() + 
  geom_dotplot(shape=21,binaxis = "y", method="histodot", stackdir="up",
              colour="black",stroke=1) +
  ggsci::scale_fill_jco()
```
![](https://cdn.nlark.com/yuque/0/2021/webp/396745/1622900947015-7f2691a2-6dfb-4b99-8d47-fc7eb6d7c1a3.webp#clientId=ub0f10706-f17f-4&from=paste&id=u59773ec7&originHeight=810&originWidth=1080&originalType=url&ratio=3&status=done&style=shadow&taskId=udb112d3d-86ff-4916-afe1-982a336e40f)<br />Example02 of geom_half_violin_dotplot()
