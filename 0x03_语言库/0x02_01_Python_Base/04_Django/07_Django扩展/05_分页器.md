# 分页器

当页面因需要展示的数据条目过多，导致无法在一个页面全部显示。这时，页面经常会采用分页形式进行展示，然后每页显示 20 或者 50 等条数据。分页经常在网站上随处可见。



## 使用方法

### Paginator

Paginator 类的作用是将我们需要分页的数据分割成若干份。当我们实现化一个 Paginator 类的实例时，需要给 Paginator 传入两个参数。第一个参数是数据源，可以是**一个列表、元组、以及查询结果集 QuerySet**。第二个参数**需要传入一个整数，表示每页显示数据条数**。



### page

Paginator 类提供一个  **page(number) **  函数，该函数返回就是一个 Page 对象。参数 number 表示第几个分页。如果 number = 1，那么 page() 返回的对象是第一分页的 Page 对象。在前端页面中显示数据，我们主要的操作都是基于 Page 对象。

~~~ python
# 需要使用分页器Paginator，最后返回分页结果page
from django.core.paginator import Paginator


def blog_message(request):
    
    # 查询所有留言
    messages = Message.objects.all()
    
    # 调用分页器，每页显示8个
    paginator = Paginator(messages, 8)
    
    # 获取页码数
    page = request.GET.get('page', 1)
    
    # 返回的是page对象，参数就是页码数
    page = paginator.get_page(page)

    if request.method == 'GET':
        return render(request, 'article/lmessage.html', context={'page':page})
    else:
        # 获取用户提交的留言
        name = request.POST.get('name')
        mycall = request.POST.get('mycall')
        lytext = request.POST.get('lytext')
        if name and lytext:
            message = Message.objects.create(nickname=name, icon=mycall, content=lytext)
            if message:
                return redirect(reverse('article:message'))
        return render(request, 'article/lmessage.html', context={'page':page, 'error': '必须输入用户名和内容'})
~~~

~~~ html
    <div class="page">
        <a title="Total record"><b>{{ page.paginator.num_pages }}</b></a>
        {#        <a href="/news/index_5.html">&lt;&lt;</a></div>#}
            <a href="{% url 'article:show' %}?page={% if page.has_previous %}{{ page.previous_page_number }}{% else %}1{% endif %}&tid={{ tid }}">&lt;</a>
        {% for page_number in  page.paginator.page_range %}
            {% if page.number == page_number %}
                <b>{{ page_number }}</b>
            {% else %}
                <a href="{% url 'article:show' %}?page={{ page_number }}&tid={{ tid }}">{{ page_number }}</a>
            {% endif %}
        {% endfor %}

        <a href="{% url 'article:show' %}?page={% if page.has_next %}{{ page.next_page_number }}{% else %}{{ page.paginator.num_pages }}{% endif %}&tid={{ tid }}">&gt;</a>
        <a href="/news/index_5.html">&gt;&gt;</a>
    </div>
~~~

**Paginator 类中有三个常用的属性：**

- paginator.**count** # 总的条目数  总的记录数
- paginator.**num_pages** # 可以分页的数量  总的页码数
- paginator.**page_range** # 页面的范围



**方法：**

- page = request.GET.get('page',1)
- page = paginator.get_page(page)  # 返回的是page对象  参数就是页码数



**Page 对象有三个常用的属性：**

- **object_list**: 表示当前页面上所有对象的列表
- **numberv**: 表示当前页的序号，从 1 开始计数
- **paginator**： 当前 Page 对象所属的 Paginator 对象

除此之外，Page 对象还拥有几个常用的函数：

- page.**has_next()**： 判断是否还有下一页，有的话返回True。
- page.**has_previous()**：判断是否还有上一页，有的话返回 True。
- page.**has_other_pages()**：判断是否上一页或下一页，有的话返回True。
- page.**next_page_number()**： 返回下一页的页码。如果下一页不存在，抛出InvalidPage 异常。
- page.**previous_page_number()**：返回上一页的页码。如果上一页不存在，抛出InvalidPage 异常。