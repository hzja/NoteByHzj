Java 线程

- **什么是守护线程，什么是非守护线程？**
   - java有两种状态的线程
   - 守护线程与非守护线程的区别
- **守护线程与非守护线程代码演示区别**
   - 创建守护线程
   - 守护线程：主线程销毁停止，守护线程一起销毁
   - 非守护线程：如果主线程销毁，用户线程继续运行且互不影响。
<a name="yuaoO"></a>
## 什么是守护线程，什么是非守护线程？
<a name="F7wVM"></a>
#### Java有两种状态的线程

1. 守护线程（例如垃圾回收线程：gc线程）
2. 非守护线程（用户线程：用户线程即手动创建的线程）
<a name="KENmj"></a>
#### 守护线程与非守护线程的区别

1. **守护线程**
- 有一个特征，例如当主线程运行的时候，垃圾回收线程一起运行。
- 当主线程销毁，会和主线程一起销毁。
2. **非守护线程**
- 如果主线程销毁，用户线程继续运行且互不影响。
<a name="Tw5dC"></a>
## 守护线程与非守护线程代码演示区别
<a name="UMSbE"></a>
#### 创建守护线程
```java
public static void main(String[] args) throws InterruptedException {
	Thread t1 = new Thread(new Runnable() {
		
		public void run() {
			while (true) {
				try {
					Thread.sleep(1000);
					
				} catch (Exception e) {
					// TODO: handle exception
				}
				System.out.println("我是子线程(用户线程)");
			}
		}
	});
	// 标识当前方法为守护线程，一定要在启动线程前设置为守护线程
	t1.setDaemon(true);
	t1.start();
}
```
必须在`t1.start()`之前设置，不能把正在运行的常规线程设置为守护线程，否则报`IllegalThreadStateException`异常
<a name="nfP29"></a>
#### 守护线程：主线程销毁停止，守护线程一起销毁
```java
public static void main(String[] args) {
    Thread t1 = new Thread(new Runnable() {
        
        public void run() {
            while (true) {
                try {
                    Thread.sleep(1000);
                    
                } catch (Exception e) {
                    // TODO: handle exception
                }
                System.out.println("我是子线程(用户线程)");
            }
        }
    });
    // 标识当前方法为守护线程，一定要在启动线程前设置为守护线程
    t1.setDaemon(true);
    //启动线程
    t1.start();
    
    //相当与主线程
    for (int i = 0; i < 10; i++) {
        try {
            Thread.sleep(300);
        } catch (Exception e) {
            e.printStackTrace();
        }
        System.out.println("main:i:" + i);
    }
    System.out.println("主线程执行完毕...");
 }
```
以下为运行结果：
```java
main:i:0
main:i:1
main:i:2
我是子线程(用户线程)
main:i:3
main:i:4
main:i:5
我是子线程(用户线程)
main:i:6
main:i:7
main:i:8
我是子线程(用户线程)
main:i:9
主线程执行完毕...
```
主线程结束之后并没有在继续运行守护线程，守护线程也跟着结束，一起销毁停止。
<a name="sZD2w"></a>
#### 非守护线程：如果主线程销毁，用户线程继续运行且互不影响。
```java
public static void main(String[] args) {
	Thread t1 = new Thread(new Runnable() {
		
		public void run() {
			while (true) {
				try {
					Thread.sleep(1000);
					
				} catch (Exception e) {
					// TODO: handle exception
				}
				System.out.println("我是子线程(用户线程)");
			}
		}
	});
	//启动线程
	t1.start();
	
	//相当与主线程
	for (int i = 0; i < 10; i++) {
		try {
			Thread.sleep(300);
		} catch (Exception e) {
			e.printStackTrace();
		}
		System.out.println("main:i:" + i);
	}
	System.out.println("主线程执行完毕...");
}
```
以下为运行结果：
```java
main:i:0
main:i:1
main:i:2
我是子线程(用户线程)
main:i:3
main:i:4
main:i:5
我是子线程(用户线程)
main:i:6
main:i:7
main:i:8
我是子线程(用户线程)
main:i:9
主线程执行完毕...
我是子线程(用户线程)
我是子线程(用户线程)
我是子线程(用户线程)
我是子线程(用户线程)
我是子线程(用户线程)
我是子线程(用户线程)
。。。。。。。。。。。。。。。。。。。。。
```
当主线程销毁停止，非守护线程（用户线程）并没有结束，而是一直在执行，与主线程互不影响。
