IDEA<br />Debug用来追踪代码的运行流程，通常在程序运行过程中出现异常，启用Debug模式可以分析定位异常发生的位置，以及在运行过程中参数的变化。通常也可以启用Debug模式来跟踪代码的运行流程去学习三方框架的源码。<br />所以学习下如何在Intellij IDEA中使用好Debug，主要包括如下内容：

- **Debug开篇**
- **基本用法&快捷键**
- **变量查看**
- **计算表达式**
- **智能步入**
- **断点条件设置**
- **多线程调试**
- **回退断点**
- **中断Debug**
- **附：JRebel激活**
<a name="GzBmU"></a>
### **一、Debug开篇**
首先看下IDEA中Debug模式下的界面。<br />如下是在IDEA中启动Debug模式，进入断点后的界面，这里是Windows，可能和Mac的图标等会有些不一样。就简单说下图中标注的8个地方：

1. **以Debug模式启动服务，左边的一个按钮则是以Run模式启动。在开发中，一般会直接启动Debug模式，方便随时调试代码。**
2. **断点：在左边行号栏单击左键，或者快捷键Ctrl+F8 打上/取消断点，断点行的颜色可自己去设置。**
3. **Debug窗口：访问请求到达第一个断点后，会自动激活Debug窗口。如果没有自动激活，可以去设置里设置，如图1.2。**
4. **调试按钮：一共有8个按钮，调试的主要功能就对应着这几个按钮，鼠标悬停在按钮上可以查看对应的快捷键。在菜单栏Run里可以找到同样的对应的功能，如图1.4。**
5. **服务按钮：可以在这里关闭/启动服务，设置断点等。**
6. **方法调用栈：这里显示了该线程调试所经过的所有方法，勾选右上角的[Show All Frames]按钮，就不会显示其它类库的方法了，否则这里会有一大堆的方法。**
7. **Variables：在变量区可以查看当前断点之前的当前方法内的变量。**
8. **Watches：查看变量，可以将Variables区中的变量拖到Watches中查看**

![[图1.1]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195557051-4436447d-9503-45b3-85cf-130793add8e1.jpeg#averageHue=%23303833&clientId=u760b2359-91fe-4&from=paste&id=u68b0a836&originHeight=585&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u0f748413-f089-4827-bece-eca5ef26b6b&title=%5B%E5%9B%BE1.1%5D "[图1.1]")<br />在设置里勾选Show debug window on breakpoint，则请求进入到断点后自动激活Debug窗口<br />![[图1.2]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195556949-73411cf2-0660-4a68-9d4e-a020f18a2444.jpeg#averageHue=%233d444c&clientId=u760b2359-91fe-4&from=paste&id=u49387def&originHeight=629&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u35f6f12d-88f9-444a-9374-7162db8021c&title=%5B%E5%9B%BE1.2%5D "[图1.2]")<br />如果IDEA底部没有显示工具栏或状态栏，可以在View里打开，显示出工具栏会方便使用。可以自己去尝试下这四个选项。<br />![[图1.3]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195557019-3ac149c8-d7e2-42a4-810b-3f2973beaec1.jpeg#averageHue=%23343f34&clientId=u760b2359-91fe-4&from=paste&id=u2f25754e&originHeight=721&originWidth=729&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u5132043d-f560-4025-815f-85f41150e5e&title=%5B%E5%9B%BE1.3%5D "[图1.3]")<br />在菜单栏Run里有调试对应的功能，同时可以查看对应的快捷键。<br />![[图1.4]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195557285-5b58c226-80f0-44e4-8268-309a98d83425.jpeg#averageHue=%232e3931&clientId=u760b2359-91fe-4&from=paste&id=u35fd8107&originHeight=613&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=uaa9da259-dae4-43d3-b5f2-031b6462499&title=%5B%E5%9B%BE1.4%5D "[图1.4]")
<a name="Fuc2X"></a>
### **二、基本用法&快捷键**
Debug调试的功能主要对应着图一中4和5两组按钮：<br />**1、首先说第一组按钮，共8个按钮，从左到右依次如下：**<br />![[图2.1]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195557002-a7808432-ee6e-4e66-82cf-361a1869599c.png#averageHue=%2340484f&clientId=u760b2359-91fe-4&from=paste&id=u385e1ff4&originHeight=41&originWidth=281&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u4f5c6619-7555-46ab-8391-c8e939d9702&title=%5B%E5%9B%BE2.1%5D "[图2.1]")

- **Show Execution Point (Alt + F10)：如果光标在其它行或其它页面，点击这个按钮可跳转到当前代码执行的行。**
- **Step Over (F8)：步过，一行一行地往下走，如果这一行上有方法不会进入方法。**
- **Step Into (F7)：步入，如果当前行有方法，可以进入方法内部，一般用于进入自定义方法内，不会进入官方类库的方法，如第25行的put方法。**
- **Force Step Into (Alt + Shift + F7)：强制步入，能进入任何方法，查看底层源码的时候可以用这个进入官方类库的方法。**
- **Step Out (Shift + F8)：步出，从步入的方法内退出到方法调用处，此时方法已执行完毕，只是还没有完成赋值。**
- **Drop Frame (默认无)：回退断点，后面章节详细说明。**
- **Run to Cursor (Alt + F9)：运行到光标处，可以将光标定位到需要查看的那一行，然后使用这个功能，代码会运行至光标行，而不需要打断点。**
- **Evaluate Expression (Alt + F8)：计算表达式，后面章节详细说明。**

**2、第二组按钮，共7个按钮，从上到下依次如下：**<br />![[图2.2]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195557408-dad0d181-9f3c-4dbc-9510-e3cd08fa7526.png#clientId=u760b2359-91fe-4&from=paste&id=u214e3a49&originHeight=247&originWidth=44&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ufbb9ab1e-afae-469a-9621-cd3b6236dd6&title=%5B%E5%9B%BE2.2%5D "[图2.2]")

- **Rerun 'xxxx'：重新运行程序，会关闭服务后重新启动程序。**
- **Update 'tech' application (Ctrl + F5)：更新程序，一般在代码有改动后可执行这个功能。而这个功能对应的操作则是在服务配置里，如图2.3。**
- **Resume Program (F9)：恢复程序，比如，在第20行和25行有两个断点，当前运行至第20行，按F9，则运行到下一个断点(即第25行)，再按F9，则运行完整个流程，因为后面已经没有断点了。**
- **Pause Program：暂停程序，启用Debug。目前没发现具体用法。**
- **Stop 'xxx' (Ctrl + F2)：连续按两下，关闭程序。有时候会发现关闭服务再启动时，报端口被占用，这是因为没完全关闭服务的原因，就需要查杀所有JVM进程了。**
- **View Breakpoints (Ctrl + Shift + F8)：查看所有断点，后面章节会涉及到。**
- **Mute Breakpoints：哑的断点，选择这个后，所有断点变为灰色，断点失效，按F9则可以直接运行完程序。再次点击，断点变为红色，有效。如果只想使某一个断点失效，可以在断点上右键取消Enabled，如图2.4，则该行断点失效。**

更新程序，On 'Update' actions，执行更新操作时所做的事情，一般选择'Update classes and resources'，即更新类和资源文件。<br />一般配合热部署插件会更好用，如JRebel，这样就不用每次更改代码后还要去重新启动服务。如何激活JRebel，在最后章节附上。<br />下面的On frame deactivation，在IDEA窗口失去焦点时触发，即一般从idea切换到浏览器的时候，idea会自动做的事情，一般可以设置Do nothing，频繁切换会比较消耗资源的。<br />![[图2.3]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195557508-8b24f3f1-1c20-4141-9e93-9e0c84c98570.jpeg#averageHue=%233e454b&clientId=u760b2359-91fe-4&from=paste&id=u0f9ce6b4&originHeight=637&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u714c52fc-273b-4f40-af14-fa4f377d177&title=%5B%E5%9B%BE2.3%5D "[图2.3]")<br />![[图2.4]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195557545-9bb6b430-81e4-489a-8a19-87f1daf4b728.png#averageHue=%23608a53&clientId=u760b2359-91fe-4&from=paste&id=u16e92604&originHeight=279&originWidth=601&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ucb92ceb7-d475-4dd6-bc37-1245b1cd6cc&title=%5B%E5%9B%BE2.4%5D "[图2.4]")
<a name="nQSUj"></a>
### **三、变量查看**
在Debug过程中，跟踪查看变量的变化是非常必要的，这里就简单说下[IDEA](http://mp.weixin.qq.com/s?__biz=MzI4Njc5NjM1NQ==&mid=2247488006&idx=1&sn=d5c66d84724b1deebac6604749d04bf5&chksm=ebd62d2adca1a43cb136b5740621e25854537054b9b3cac7451fd21ea55c0fc247e07a49d8cd&scene=21#wechat_redirect)中可以查看变量的几个地方，相信大部分人都了解。<br />**1、如下，在IDEA中，参数所在行后面会显示当前变量的值。**<br />![[图3.1]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195557592-980cf88a-16d4-436d-8e25-d3d33733b50c.jpeg#averageHue=%232e2d1c&clientId=u760b2359-91fe-4&from=paste&id=u18cf1b1d&originHeight=563&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u633b3929-a948-40f2-a431-b3d6697061d&title=%5B%E5%9B%BE3.1%5D "[图3.1]")<br />**2、光标悬停到参数上，显示当前变量信息。** 点击打开详情如图3.3。一般会使用这种方式，快捷方便。<br />![[图3.2]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195557962-1ccc83ad-b098-4067-90e7-1c8aba921a36.png#averageHue=%23171310&clientId=u760b2359-91fe-4&from=paste&id=uf0ab14d4&originHeight=185&originWidth=622&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ua05fc9e8-b159-4d0b-bf32-747ed62b39b&title=%5B%E5%9B%BE3.2%5D "[图3.2]")<br />![[图3.3]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195557971-73dfee5d-1272-4545-924a-57f1fda14e48.png#averageHue=%23458735&clientId=u760b2359-91fe-4&from=paste&id=u8e9850d2&originHeight=304&originWidth=877&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u2fabf19f-5b58-4fc2-a29f-96beba25e68&title=%5B%E5%9B%BE3.3%5D "[图3.3]")<br />**3、在Variables里查看，这里显示当前方法里的所有变量。**<br />![[图3.4]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558341-86c82943-2e32-409b-83b0-90d48a9726d5.png#averageHue=%233c4043&clientId=u760b2359-91fe-4&from=paste&id=u98a50126&originHeight=268&originWidth=517&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=uae43e2ac-dcb5-4a8c-8022-31ab42440e7&title=%5B%E5%9B%BE3.4%5D "[图3.4]")<br />**4、在Watches里，点击New Watch，输入需要查看的变量。** 或者可以从Variables里拖到Watche里查看。<br />![[图3.5]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558057-60ecabca-0a59-4638-8b05-25d3a33545af.png#averageHue=%23404549&clientId=u760b2359-91fe-4&from=paste&id=uc0c20366&originHeight=239&originWidth=628&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=uf5df9c1c-06c8-4de9-9c89-8a0aaaf0424&title=%5B%E5%9B%BE3.5%5D "[图3.5]")<br />如果发现没有Watches，可能在下图所在的地方。<br />![[图3.6]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558119-26860a4c-2d45-4eae-8d80-1cfb1bc45e93.png#averageHue=%233d4043&clientId=u760b2359-91fe-4&from=paste&id=u60a159a1&originHeight=237&originWidth=429&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u89b64e6d-2b50-4fae-81f2-71b07677e3b&title=%5B%E5%9B%BE3.6%5D "[图3.6]")<br />![[图3.7]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558398-c4262743-0609-4314-b653-426748fd4d71.png#averageHue=%233d4145&clientId=u760b2359-91fe-4&from=paste&id=u3b403e71&originHeight=243&originWidth=963&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u6ba1ac4c-a2eb-44f7-a7e4-e66ad58989f&title=%5B%E5%9B%BE3.7%5D "[图3.7]")
<a name="LvEUA"></a>
### **四、计算表达式**
在前面提到的计算表达式如图4.1的按钮，Evaluate Expression (Alt + F8) 。可以使用这个操作在调试过程中计算某个表达式的值，而不用再去打印信息。<br />![[图4.1]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558586-ed5f5141-7e25-4155-8bff-84206d32750d.png#averageHue=%233e4447&clientId=u760b2359-91fe-4&from=paste&id=u5074eb18&originHeight=54&originWidth=333&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=uf70bb253-834c-4590-9443-7bf02158960&title=%5B%E5%9B%BE4.1%5D "[图4.1]")<br />**1、按Alt + F8或按钮，或者，可以选中某个表达式再Alt + F8，弹出计算表达式的窗口**，如下，回车或点击Evaluate计算表达式的值。<br />这个表达式不仅可以是一般变量或参数，也可以是方法，当一行代码中调用了几个方法时，就可以通过这种方式查看查看某个方法的返回值。<br />![[图4.2]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195558551-49eaeb81-5214-48db-a5a6-3e0ef5271236.jpeg#averageHue=%23323c37&clientId=u760b2359-91fe-4&from=paste&id=ub11ba108&originHeight=569&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u019fa0ea-730a-4272-9c92-da1fefa2cae&title=%5B%E5%9B%BE4.2%5D "[图4.2]")<br />**2、设置变量，在计算表达式的框里，可以改变变量的值**，这样有时候就能很方便去调试各种值的情况了不是。<br />![[图4.3]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195558722-86957d5e-a8b4-4d6c-95ea-b4cae1f13157.jpeg#averageHue=%23293628&clientId=u760b2359-91fe-4&from=paste&id=ub3c82e86&originHeight=478&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u600e1890-7317-4f2e-b888-f4708256d0a&title=%5B%E5%9B%BE4.3%5D "[图4.3]")
<a name="HI1HU"></a>
### **五、智能步入**
想想，一行代码里有好几个方法，怎么只选择某一个方法进入。之前提到过使用Step Into (Alt + F7) 或者 Force Step Into (Alt + Shift + F7)进入到方法内部，但这两个操作会根据方法调用顺序依次进入，这比较麻烦。<br />那么智能步入就很方便了，智能步入，这个功能在Run里可以看到，Smart Step Into (Shift + F7)，如图5.1<br />![[图5.1]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558830-286b0a15-4670-46e2-a4b8-5a15437a5e92.png#averageHue=%233e454f&clientId=u760b2359-91fe-4&from=paste&id=u52f7b135&originHeight=250&originWidth=464&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ue5a5da6a-92d3-4a47-9b9b-b3671e2ac08&title=%5B%E5%9B%BE5.1%5D "[图5.1]")<br />按Shift + F7，会自动定位到当前断点行，并列出需要进入的方法，如图5.2，点击方法进入方法内部。<br />如果只有一个方法，则直接进入，类似Force Step Into。<br />![[图5.2]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195558851-82a60878-857d-43fd-afbd-734fc1fa7bde.png#averageHue=%232f1f1d&clientId=u760b2359-91fe-4&from=paste&id=uc39c7172&originHeight=206&originWidth=735&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=uec536e65-bc17-470a-a676-83ddc79f51f&title=%5B%E5%9B%BE5.2%5D "[图5.2]")
<a name="pGErv"></a>
### **六、断点条件设置**
通过设置断点条件，在满足条件时，才停在断点处，否则直接运行。<br />通常，当在遍历一个比较大的集合或数组时，在循环内设置了一个断点，难道要一个一个去看变量的值？那肯定很累，说不定还错过这个值得重新来一次。<br />**1、在断点上右键直接设置当前断点的条件**，如图6.1，设置exist为true时断点才生效。<br />![[图6.1]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195559161-0290c0c0-9a46-4277-b8ee-1ca7497e823c.png#averageHue=%2343842a&clientId=u760b2359-91fe-4&from=paste&id=uec1c062c&originHeight=323&originWidth=585&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u9a967664-3555-4760-91d6-9b879124909&title=%5B%E5%9B%BE6.1%5D "[图6.1]")<br />**2、点击View Breakpoints (Ctrl + Shift + F8)，查看所有断点。**<br />Java Line Breakpoints 显示了所有的断点，在右边勾选Condition，设置断点的条件。<br />勾选Log message to console，则会将当前断点行输出到控制台，如图6.3<br />勾选Evaluate and log，可以在执行这行代码是计算表达式的值，并将结果输出到控制台。<br />![[图6.2]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195559273-16b883a6-9984-45f1-97c5-6c10b28f6de7.jpeg#averageHue=%23384343&clientId=u760b2359-91fe-4&from=paste&id=u2fff5751&originHeight=585&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ud86526cb-718c-44a6-8669-f156d194bc1&title=%5B%E5%9B%BE6.2%5D "[图6.2]")<br />![[图6.3]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195559177-167315fb-85a7-4282-bfe5-b8f4dc8b29fd.png#averageHue=%23a17422&clientId=u760b2359-91fe-4&from=paste&id=uf626694c&originHeight=144&originWidth=800&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u5e0737bd-95ed-440c-93a5-50d9822b7c8&title=%5B%E5%9B%BE6.3%5D "[图6.3]")<br />**3、再说说右边的Filters过滤**，这些一般情况下不常用，简单说下意思。<br />Instance filters：实例过滤，输入实例ID(如图6.5中的实例ID)，但是这里没有成功，不知道什么原因，知道的朋友留个言。<br />Class filters：类过滤，根据类名过滤，同样没有成功....<br />Pass count：用于循环中，如果断点在循环中，可以设置该值，循环多少次后停在断点处，之后的循环都会停在断点处。<br />![[图6.4]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195559465-31b580a7-c256-49c8-a624-6ce16c354cee.png#averageHue=%233c3f41&clientId=u760b2359-91fe-4&from=paste&id=u348861f6&originHeight=257&originWidth=413&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u1447fa11-3d6a-4a7e-b5aa-67edd030226&title=%5B%E5%9B%BE6.4%5D "[图6.4]")<br />![[图6.5]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195559435-85099529-a92d-48cb-b05f-595ecd6acfb8.png#averageHue=%233e444c&clientId=u760b2359-91fe-4&from=paste&id=u60828c48&originHeight=275&originWidth=461&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u9fb07d8f-86f2-47cd-b668-91910472599&title=%5B%E5%9B%BE6.5%5D "[图6.5]")<br />**4、异常断点，通过设置异常断点**，在程序中出现需要拦截的异常时，会自动定位到异常行。<br />如图6.6，点击+号添加Java Exception Breakpoints，添加异常断点。然后输入需要断点的异常类，如图6.7，之后可以在Java Exception Breakpoints里看到添加的异常断点。<br />这里添加了一个NullPointerException异常断点，如图6.8，出现空指针异常后，自动定位在空指针异常行。<br />![[图6.6]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195559717-a420547a-de67-43dc-bf76-54b2044ea9d2.png#averageHue=%233d4b5b&clientId=u760b2359-91fe-4&from=paste&id=uc3aaa79e&originHeight=237&originWidth=535&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ud823202c-2b65-49af-8246-aa705ca784d&title=%5B%E5%9B%BE6.6%5D "[图6.6]")<br />![[图6.7]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195559604-6284cb19-21f1-4155-b05c-340402e6dbc5.jpeg#averageHue=%233c4349&clientId=u760b2359-91fe-4&from=paste&id=u23c0d03c&originHeight=660&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u61b5c8f9-ec4c-4602-bc9d-a343b2e7dc2&title=%5B%E5%9B%BE6.7%5D "[图6.7]")<br />![[图6.8]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195559782-fe0df9e8-856e-44a9-a8cc-7e90a8da4e38.jpeg#averageHue=%231f261c&clientId=u760b2359-91fe-4&from=paste&id=u6bb49079&originHeight=413&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u833fc2bf-5779-4392-960c-000a7fac1b3&title=%5B%E5%9B%BE6.8%5D "[图6.8]")
<a name="jmwl0"></a>
### **七、多线程调试**
一般情况下调试的时候是在一个线程中的，一步一步往下走。但有时候会发现在Debug的时候，想发起另外一个请求都无法进行了？<br />那是因为IDEA在Debug时默认阻塞级别是ALL，会阻塞其它线程，只有在当前调试线程走完时才会走其它线程。可以在View Breakpoints里选择Thread，如图7.1，然后点击Make Default设置为默认选项。<br />![[图7.1]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195559892-e2907199-1e88-4398-8fd8-2731e4287dd7.jpeg#averageHue=%233e4953&clientId=u760b2359-91fe-4&from=paste&id=u8f5baeb9&originHeight=318&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ud9af4e0f-38a4-4eec-aabe-2f8866c2eeb&title=%5B%E5%9B%BE7.1%5D "[图7.1]")<br />切换线程，在图7.2中Frames的下拉列表里，可以切换当前的线程，如下这里有两个Debug的线程，切换另外一个则进入另一个Debug的线程。<br />![[图7.2]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560067-e6232198-4383-4c04-801e-481ec64d5575.jpeg#averageHue=%23262f21&clientId=u760b2359-91fe-4&from=paste&id=ue2528b86&originHeight=584&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u5d6ee67f-7dae-4dcc-99be-1acaf6b462f&title=%5B%E5%9B%BE7.2%5D "[图7.2]")
<a name="lzeyA"></a>
### **八、回退断点**
在调试的时候，想要重新走一下流程而不用再次发起一个请求？<br />**1、首先认识下这个方法调用栈**，如图8.1，首先请求进入DemoController的`insertDemo`方法，然后调用insert方法，其它的`invoke`且先不管，最上面的方法是当前断点所在的方法。<br />![[图8.1]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560243-db5006a3-0147-4a13-94e9-d6bbe2185212.jpeg#averageHue=%231e281c&clientId=u760b2359-91fe-4&from=paste&id=uc657b501&originHeight=538&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u8fd60170-33c7-4aa2-b1bd-74ef1d6453d&title=%5B%E5%9B%BE8.1%5D "[图8.1]")<br />**2、断点回退**<br />所谓的断点回退，其实就是回退到上一个方法调用的开始处，在[IDEA](http://mp.weixin.qq.com/s?__biz=MzI4Njc5NjM1NQ==&mid=2247488006&idx=1&sn=d5c66d84724b1deebac6604749d04bf5&chksm=ebd62d2adca1a43cb136b5740621e25854537054b9b3cac7451fd21ea55c0fc247e07a49d8cd&scene=21#wechat_redirect)里测试无法一行一行地回退或回到到上一个断点处，而是回到上一个方法。<br />回退的方式有两种，一种是Drop Frame按钮(图8.2)，按调用的方法逐步回退，包括三方类库的其它方法(取消Show All Frames按钮会显示三方类库的方法，如图8.3)。<br />第二种方式，在调用栈方法上选择要回退的方法，右键选择Drop Frame(图8.4)，回退到该方法的上一个方法调用处，此时再按F9(Resume Program)，可以看到程序进入到该方法的断点处了。<br />但有一点需要注意，断点回退只能重新走一下流程，之前的某些参数/数据的状态已经改变了的是无法回退到之前的状态的，如对象、集合、更新了数据库数据等等。<br />![图[8.2]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195560215-a33b4a8e-2057-4f7b-95ad-39f9dbb9d02e.png#averageHue=%2340474f&clientId=u760b2359-91fe-4&from=paste&id=u3b9506af&originHeight=74&originWidth=313&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u408fb396-3a1d-48e4-afa1-ed3b374f104&title=%E5%9B%BE%5B8.2%5D "图[8.2]")<br />![图[8.3]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560201-55d0f586-4f8f-48b3-a55f-201fd0521f71.jpeg#averageHue=%234e524a&clientId=u760b2359-91fe-4&from=paste&id=u95df926c&originHeight=322&originWidth=781&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u0d52fcf2-4e01-47b8-b414-97256d77c49&title=%E5%9B%BE%5B8.3%5D "图[8.3]")<br />![图[8.4]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195560532-e3a0b400-3bf1-431e-b268-6edae544d44a.png#averageHue=%233f4752&clientId=u760b2359-91fe-4&from=paste&id=u26caee55&originHeight=249&originWidth=707&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u92939958-5ac9-4a95-b6f3-c97de496ab0&title=%E5%9B%BE%5B8.4%5D "图[8.4]")
<a name="ZvGHg"></a>
### **九、中断Debug**
想要在Debug的时候，中断请求，不要再走剩余的流程了？<br />有些时候，看到传入的参数有误后，不想走后面的流程了，怎么中断这次请求呢(后面的流程要删除数据库数据呢....)，难道要关闭服务重新启动程序？嗯，以前也是这么干的。<br />确切的说，也没发现可以直接中断请求的方式(除了关闭服务)，但可以通过Force Return，即强制返回来避免后续的流程，如图9.1。<br />点击Force Return，弹出Return Value的窗口，这个方法的返回类型为Map，所以，这里直接返回 results，来强制返回，从而不再进行后续的流程。或者可以`new HashMap<>()`。<br />![[图9.1]](https://cdn.nlark.com/yuque/0/2022/png/396745/1658195560618-c38b336c-d2bc-4dd6-a613-123d4011721a.png#averageHue=%233f4752&clientId=u760b2359-91fe-4&from=paste&id=u613585e9&originHeight=248&originWidth=706&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u8a6f95d1-6f04-4b50-8336-ba0507faa41&title=%5B%E5%9B%BE9.1%5D "[图9.1]")<br />![[图9.2]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560695-04cf8c0e-7dd5-4d6c-b825-bc90aa6f6fec.jpeg#averageHue=%23242f23&clientId=u760b2359-91fe-4&from=paste&id=u0fcd74e8&originHeight=613&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ubc6a9ef2-c7a7-435c-9dfe-a54e4f76450&title=%5B%E5%9B%BE9.2%5D "[图9.2]")
<a name="uLU2M"></a>
### **十、附：JRebel激活**
目前一直使用JRebel做热部署工具，效果还算理想，修改Java代码或者xml等配置文件都能热更新。偶尔服务开久了，或更改的文件较多时，热更新没有生效，需要重新启动服务。<br />这里只是简单说下在网上看到的一种免费获得永久使用权的方式(非破解)，不确定这种方式什么时候不能用。

- **首先需要一个Twitter的账号**
- **进入这个网址：**[https://my.jrebel.com/](https://my.jrebel.com/)**，并登录，如图10.1**
- **然后在Install and Acticate里可以得到永久激活码。**
- **在设置里Jrebel里设置激活码，如图10.3，如果没有安装JRebel插件，先在Plugins里安装搜索安装JRebel插件。**

![[图10.1]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560764-a069ee97-0489-44d8-a90d-a43766c3404f.jpeg#averageHue=%23fbfaf8&clientId=u760b2359-91fe-4&from=paste&id=uf42c5c2c&originHeight=458&originWidth=969&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=ube8bc3ae-5467-4ac6-8961-8df037f2563&title=%5B%E5%9B%BE10.1%5D "[图10.1]")<br />![[图10.2]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560944-18a69213-f244-43e1-9fc7-06aa4ace6345.jpeg#averageHue=%23f8f4f3&clientId=u760b2359-91fe-4&from=paste&id=uc8ea7126&originHeight=316&originWidth=963&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u11adc84d-b495-4740-91d2-1094db33eaa&title=%5B%E5%9B%BE10.2%5D "[图10.2]")<br />![[图10.3]](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1658195560947-0e7da210-6270-494c-bb42-3de2f559f136.jpeg#averageHue=%233f4449&clientId=u760b2359-91fe-4&from=paste&id=mzuow&originHeight=629&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=true&status=done&style=none&taskId=u895e5692-df17-4b45-9d7e-0b85a1d9ac8&title=%5B%E5%9B%BE10.3%5D "[图10.3]")
