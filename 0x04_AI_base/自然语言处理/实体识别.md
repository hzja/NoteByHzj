命名实体识别的目的是识别语料库中的人名、地名、组织机构名等命名实体。命名实体识别(Named Entity Recognition)研究的命名实体一般分为3大类（实体类、时间类、数字类）和7小类（人名、地名、组织机构名、时间、日期、货币和百分比）。由于数量、时间、日期、货币等实体识别通常可以采用模式匹配的方式获得较好识别，相比之下人名、地名、机构名较复杂，因此近年来的研究主要以这几种实体为主。

<a name="94f3183a"></a>
### 基于条件随机场的命名实体识别

条件随机场是在给定观察的标记序列下，计算整个标记序列的联合概率，其定义为：

设![](./img/c1322bc05ef6e2680b436e5f69bd157e.svg)和![](./img/59711dbcce0e033fb0b62c7f05295eb0.svg)是联合随机变量，若随机变量![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)构成一个无向图![](./img/9e9992d6bf50b7580f971487c466a8cb.svg)表示的马尔可夫模型，则其条件概率分布![](./img/7082016653a57c45dae6f7d57ceea8ba.svg)称为条件随机场(Conditional Random Field, CRF)，即：

![](./img/5048c6bc4eea91143ce157b12960ed58.svg)

其中![](./img/97ad5d0db763666c52995c1faa5d9338.svg)表示图![](./img/9e9992d6bf50b7580f971487c466a8cb.svg)中与节点![](./img/9e3669d19b675bd57058fd4664205d2a.svg)有边连接的所有节点，![](./img/bcd09b60cdcbd07a0987b59226254e3a.svg)表示节点![](./img/9e3669d19b675bd57058fd4664205d2a.svg)以外所有节点

<a name="cd6a5173"></a>
#### 示例说明

现有个由![](./img/7b8b965ad4bca0e41ab51de7b31363a1.svg)个字符构成的NER的句子，每个字符的标签都在我们已知的标签集合(B、M、E、S和O)中选择(如下表)，当我们为每个字符选定标签后，就形成了一个随机场。

| 标注 | 含义 |
| :---: | :---: |
| B | 当前词为地理命名实体的首部 |
| M | 当前词为地理命名实体的内部 |
| E | 当前词为地理命名实体的尾部 |
| S | 当前词独立构成地理命名实体 |
| O | 当前词为不是地理命名实体或组成部分 |


如果在其中加 一些约束，如所有字符的标签只与相邻的字符的标签有关，那么久转化成马尔可夫随机场问题。从马尔可夫随机场到条件随机场就好理解很多，其假设马尔可夫随机场中有![](./img/02129bb861061d1a052c592e2dc6b383.svg)和![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)两种变量，![](./img/02129bb861061d1a052c592e2dc6b383.svg)一般是给定的，![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)是在给定![](./img/02129bb861061d1a052c592e2dc6b383.svg)条件下的输出。在前面的例子中，![](./img/02129bb861061d1a052c592e2dc6b383.svg)是字符，![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)是标签，![](./img/c477e084449219b9224ec1bea807d412.svg)就是条件随机场。在条件随机场的定义中，我们并没有要求变量![](./img/02129bb861061d1a052c592e2dc6b383.svg)与![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)具有相同的结构。实际在自然语言处理中，多假设其结构相同，即![](./img/a193ebc083b4745370f6f1343383d9cc.svg):

![](./img/21078392058594301fa4cce7b60958ae.svg)

![NER.jpg](./img/1599014623518-6d768a06-84e7-4336-9744-61a0ecd5a2c7.jpeg)

一般将这种结构称为线性链条件随机场。定义如下：

设![](./img/c1322bc05ef6e2680b436e5f69bd157e.svg)和![](./img/6529e709617bc0d82b659bb5aab903be.svg)均为线性链表示的随机变量序列，若在给定的随机变量序列![](./img/02129bb861061d1a052c592e2dc6b383.svg)的条件下，随机变量序列![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)的条件概率分布![](./img/7082016653a57c45dae6f7d57ceea8ba.svg)构成条件随机场，且满足马尔可夫性：

![](./img/e773c097b5ff8950b8e90958d73f6299.svg)

则称![](./img/7082016653a57c45dae6f7d57ceea8ba.svg)为线性链的条件随机场。线性链CRF不仅考虑上一状态![](./img/2de8f43b7d82e53fb10d6ba925cfc26d.svg)还考虑后续的状态结果![](./img/409959163b3f53131379f33f14907584.svg)。因此，HMM是一个有向图（HMM处理时，每个状态依赖上一个状态），而线性链CRF是一个无向图（每个状态依赖于当前状态的周围节点状态）。

对句子“我来到牛家村”进行标注，正确标注后的结果应为“我/O 来/O 到/O 牛/B 家/M 村/E”。(O,O,O,B,M,E)是一种标注序列，还有(O,O,O,B,B,E)...等各种标记方法，NER的任务就是在如此多的可选标注序列中，找出最靠谱的作为句子的标注。在CRF中，定义一个特征函数集合，然后使用这个特征集合为标注序列打分，据此选出最靠谱的标注序列。该序列的分值是通过综合考虑特征集合中的函数得出的。

在CRF中有两种特征函数，分别为转移函数![](./img/7c722f8c34f0a549e7e0c1cd9fc7dfc7.svg)和状态函数![](./img/117cd5a6b6867f85ec795cf838573eef.svg)：

![](./img/7c722f8c34f0a549e7e0c1cd9fc7dfc7.svg)依赖于当前和前一个位置，表示从标注序列中位置![](./img/800ba394e806c049c98cf4b570d04c72.svg)的标记![](./img/05e46800d48d6d936fe4672c5bc94315.svg)转移到位置![](./img/865c0c0b4ab0e063e5caa3387c1a8741.svg)上的标记![](./img/8d62e469fb30ed435a668eb5c035b1f6.svg)的概率。![](./img/117cd5a6b6867f85ec795cf838573eef.svg)依赖当前位置，表示标记序列在位置![](./img/865c0c0b4ab0e063e5caa3387c1a8741.svg)上为标记![](./img/8d62e469fb30ed435a668eb5c035b1f6.svg)的概率。通常特征函数取值为![](./img/c4ca4238a0b923820dcc509a6f75849b.svg)或![](./img/cfcd208495d565ef66e7dff9f98764da.svg)，表示符不符合该条件约束。完整的线性链CRF的参数形式如下：

![](./img/70d57e0a89b76cd3566ecb76a8dc3651.svg)

其中：![](./img/126b3e2a9aaa57507b57cb83f4402d08.svg)

![](./img/7c88b30213fbdc9f978b41d661e84781.svg)是规范化因子，其求和操作是在所有可能的输出序列上做的；![](./img/8ff9c1b69b4201fec1b23780372d5cdf.svg)和![](./img/056e9bb1955287ebe0a18084752494cc.svg)为转移函数和状态函数对应的权值。通常为了计算方便，简化为下式：

![](./img/f8e20b8f19017e17e7e679b696083ad4.svg)

对应的![](./img/7c88b30213fbdc9f978b41d661e84781.svg)为：![](./img/adfef000a6be2063a7f176a6eb7351f5.svg)

其中，![](./img/bde6633939266bae8424ef56e96179a0.svg)为两特征函数![](./img/7c722f8c34f0a549e7e0c1cd9fc7dfc7.svg)和![](./img/117cd5a6b6867f85ec795cf838573eef.svg)的统一符号。

使用CRF来做命名实体识别时，目标是求![](./img/5faf9a2454ea7fedd6b068877e5d6d8b.svg)，该问题和HMM求解最大可能序列路径一样，用维特比(Veterbi)算法即可。
