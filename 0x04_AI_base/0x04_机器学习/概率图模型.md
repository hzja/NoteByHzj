![概率图1.jpg](./img/1592823891452-7ce81658-7c31-499a-822c-95d8d67dd330.jpeg)<br />在概率图模型中，数据(样本)由公式![](./img/9e9992d6bf50b7580f971487c466a8cb.svg)建模表示：

- ![](./img/5206560a306a2e085a437fd258eb57ce.svg)表示节点，即随机变量(放在此处的，可以是一个token或者一个label)，具体地，用![](./img/4a5b7afea0ca702c58788b30003d22a9.svg)为随机变量建模，注意![](./img/57cec4137b614c87cb4e24a3d003a3e0.svg)现在是代表了一批随机变量(想象对应一条sequence，包含了很多的token)，![](./img/c362a34d73aad0d7fba4dd1bf1e21b96.svg)为这些随机变量的分布；
- ![](./img/3a3ea00cfc35332cedf6e5e9a32e94da.svg)表示边，即概率依赖关系。
<a name="5d3dd8de"></a>
## [有向图vs.无向图](https://www.zhihu.com/question/35866596/answer/236886066)

上图可以看到，贝叶斯网络（信念网络）都是有向的，马尔科夫网络无向。所以，贝叶斯网络适合为有单向依赖的数据建模，马尔科夫网络适合实体之间互相依赖的建模。具体地，他们的核心差异表现在如何求![](./img/11a92c67f4d1e7f5ac6e29084bc1a79d.svg)，即怎么表示![](./img/4a5b7afea0ca702c58788b30003d22a9.svg)这个的联合概率。

<a name="1ccab9cb"></a>
### **有向图**

对于有向图模型，这么求联合概率：

![](./img/c567fdbeaac868d4179454ec2f8db3b4.svg)

举个例子，对于下面的这个有向图的随机变量(注意，这个是比较广义的)：

![](https://pic1.zhimg.com/v2-5b3f6b4a2d905297b7f73a89e92ee618_b.jpg#align=left&display=inline&height=171&originHeight=171&originWidth=453&status=done&style=none&width=453)

应该这样表示他们的联合概率:

![](./img/3a12151e4e4c9204580f3c376457f2d2.svg)

<a name="a7b0342c"></a>
### **无向图**

对于无向图，我看资料一般就指马尔科夫网络(注意，这个图我也是比较广义的)。

![](https://pic4.zhimg.com/v2-1d8faeb71d690d02e110c7cd1d39eed3_b.jpg#align=left&display=inline&height=171&originHeight=171&originWidth=260&status=done&style=none&width=260)

如果一个graph太大，可以用因子分解将![](./img/c362a34d73aad0d7fba4dd1bf1e21b96.svg)写为若干个联合概率的乘积。咋分解呢，将一个图分为若干个“小团”，注意每个团必须是“最大团”（就是里面任何两个点连在了一块，具体……算了不解释，有点“最大连通子图”的感觉），则有：

![](./img/d7381dc1a958f22660f44192ac881a40.svg)，其中 ![](./img/f23f48d000bc1f4d33916ca4189235da.svg)

归一化是为了让结果算作概率，所以像上面的无向图：

![](./img/091728162338983fb42290f5c0931076.svg)

其中，![](./img/4ce24f37be79e6bc3ae775f7d79002f1.svg)是一个最大团![](./img/0d61f8370cad1d412f80b84d143e1257.svg)上随机变量们的联合概率，一般取指数函数的：

![](./img/07b2d646508ed1059334be0ee4d6aaa3.svg)

好了，这个叫做[势函数](https://baike.baidu.com/item/%E5%8A%BF%E5%87%BD%E6%95%B0)。注意![](./img/a0c2dda789fe4302dc3bbb9529bac861.svg)是否有看到CRF的影子。

那么概率无向图的联合概率分布可以在因子分解下表示为：

![](./img/a93c40eb146761ba821d405ebaaec574.svg)

<a name="MecvJ"></a>
## 概率图联系

![概率图2.jpg](./img/1592825021086-b26bbfc7-9766-4821-ab01-04f01ab03c15.jpeg)

<a name="Source"></a>
## Source

[https://www.zhihu.com/question/35866596/answer/236886066](https://www.zhihu.com/question/35866596/answer/236886066)
