图像处理<br />图像增强是图像处理和计算机视觉中的重要研究课题。它主要用作图像预处理或后处理，以使处理后的图像更清晰，以便随后进行图像分析和理解。主要总结图像增强中图像去噪的主要方法以及对不同算法的基本理解。
<a name="ttuaI"></a>
## 噪音模型
图像中有许多噪声源，这些噪声来自各个方面，例如图像采集，传输和压缩。噪声的类型也不同，例如盐和胡椒噪声，高斯噪声等。针对不同的噪声有不同的处理算法。<br />对于具有噪声的输入图像v（x），附加噪声可以用以下公式表示：<br />![](https://cdn.nlark.com/yuque/__latex/4ea877e14425d64ebdeafa0183a2aac7.svg#card=math&code=v%28x%29%3Du%28x%29%2B%5Ceta%28x%29%2C%20%20x%5Cin%7B%5CvarOmega%7D%2C&height=18&id=edokx)<br />其中，u（x）是没有噪声的原始图像。x是一组像素，η（x）是加性噪声项，代表噪声的影响。Ω是像素的集合，即整个图像。从该公式可以看出，噪声直接叠加在原始图像上。这种噪声可能是盐和胡椒噪声或高斯噪声。从理论上讲，如果可以准确地获得噪声，则可以通过从输入图像中减去噪声来恢复原始图像。但是现实往往是很瘦的。除非清楚地知道产生噪声的方式，否则很难单独找到噪声。
<a name="aEinu"></a>
## 高斯噪声
高斯噪声通常发生在相机电子设备的模拟信号中，可以将其建模为加性噪声，作用在输入图像I上，从而产生降级图像y：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180542-e3e8137e-3aee-4783-9010-e929bbc96db0.webp#height=19&id=fOXig&originHeight=19&originWidth=211&originalType=binary&size=0&status=done&style=none&width=211)<br />恢复的目的是获得原始图像的估计。希望使此估计尽可能接近原始输入图像。<br />高斯滤波器是一种线性滤波器，可以有效地抑制噪声并使图像平滑。它的工作原理与平均滤波器相似，都以滤波器窗口中像素的平均值作为输出。<br />二维高斯核模板或卷积核：<br />![](https://cdn.nlark.com/yuque/__latex/591d6bee8508b4318dfc8f76827fd424.svg#card=math&code=G%28u%2Cv%29%3D%5Cfrac%7B1%7D%7B2%5Cpi%5Csigma%5E2%7De%5E%7B-%5Cfrac%7Bu%5E2%2Bv%5E2%7D%7B2%5Csigma%5E2%7D%7D%2C&height=41&id=xnwJU)    ![](https://cdn.nlark.com/yuque/__latex/ac84d8a6f751001350a534ef3953b5d9.svg#card=math&code=s.t.%20&height=12&id=oNRfS)    ![](https://cdn.nlark.com/yuque/__latex/94eba52028d8013a99d2a9a2d6c4a14d.svg#card=math&code=u%20%5Cin%20%5B-w%2Cw%5D%2C&height=18&id=YOZlb)     ![](https://cdn.nlark.com/yuque/__latex/36de1307941e4150ecd9f161e11c3c2f.svg#card=math&code=v%5Cin%5B-w%2Cw%5D&height=18&id=BcIPC)<br />标准化：<br />![](https://cdn.nlark.com/yuque/__latex/591d6bee8508b4318dfc8f76827fd424.svg#card=math&code=G%28u%2Cv%29%3D%5Cfrac%7B1%7D%7B2%5Cpi%5Csigma%5E2%7De%5E%7B-%5Cfrac%7Bu%5E2%2Bv%5E2%7D%7B2%5Csigma%5E2%7D%7D%2C&height=41&id=oZAR8)   ![](https://cdn.nlark.com/yuque/__latex/e68b71186f4745083fd7743a8d84206e.svg#card=math&code=s%3D%5Csum_%7Bu%3D-w%7D%5Ew%5Csum_%7Bv%3D-w%7D%5Ewe%5E%7B-%5Cfrac%7Bu%5E2%2Bv%5E2%7D%7B2%5Csigma%5E2%7D%7D&height=45&id=EsVFw)<br />窗口模板的系数不同于平均滤波器，平均滤波器的模板系数与1相同。高斯滤波器的模板系数随着距模板中心的距离增加而减小。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180537-9a6f71b7-e816-469c-a133-f25478d26c0d.webp#height=440&id=DCoZr&originHeight=440&originWidth=452&originalType=binary&size=0&status=done&style=shadow&width=452)<br />因此，与平均滤波器相比，高斯滤波器的图像模糊程度较小。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180539-c5d3c5a0-68d9-4577-b713-05d502fa19a1.webp#height=283&id=kgq6U&originHeight=167&originWidth=400&originalType=binary&size=0&status=done&style=shadow&width=677)<br />将Rudin等人的降噪技术应用于被高斯噪声破坏的图像的示例。
<a name="e37d8d14"></a>
### 盐和胡椒粉噪音
脉冲噪声对应于饱和或关闭的随机像素。它可能发生在带有电子尖峰的设备中，可以将其建模为：<br />![](https://cdn.nlark.com/yuque/__latex/862e7ddf6f6022d8011dd111218a02ab.svg#card=math&code=y%3D%5Cbegin%7Bcases%7D%0AI%20%26%20%26%20%5Ctext%7B%20with%20probability%20P%7D%20%5C%5C%0Ab%20%26%20%26%20%5Ctext%7B%20with%20probability%201-p%7D%20%0A%5Cend%7Bcases%7D&height=39&id=Nyrp7)<br />其中b〜Ber（0.5）是参数0.5的伯努利变量。<br />如果仅可能损坏几个像素，则中值滤波器是脉冲噪声的不错选择。<br />中值滤波器可以归类为低通滤波器，它是一种线性滤波器，其输出是邻域模板中像素的简单平均值，并且主要用于图像模糊和降噪。均值滤波器的概念非常直观。滤镜窗口中像素的平均灰度值用于替换图像中的像素值。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180601-733a4e20-2ddb-4520-ba7b-0d8b06f93967.webp#height=303&id=Z2hHC&originHeight=286&originWidth=640&originalType=binary&size=0&status=done&style=shadow&width=677)<br />结果是减少了图像的锐利变化。结果，虽然平均滤波器可以减少噪点，但也会模糊图像的边缘。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180578-a1976013-efeb-4807-8142-30967f3136db.webp#height=372&id=wSl7v&originHeight=554&originWidth=1007&originalType=binary&size=0&status=done&style=shadow&width=677)<br />均值滤波器的处理结果是滤除图像中不相关的细节，其中不相关的细节是指小于滤镜模板大小的像素区域。
<a name="SfLNN"></a>
### 块匹配和3D过滤
块匹配和3D过滤（BM3D）可以说是目前最好的算法之一。BM3D算法总共有两个主要步骤，分为基本估计和最终估计。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180587-2b9072bd-77d4-477c-b573-98e0dbb31f99.webp#height=250&id=k4MBn&originHeight=209&originWidth=566&originalType=binary&size=0&status=done&style=shadow&width=677)
<a name="85d2fe75"></a>
### 基本估算
第一步是搜索相似的块，然后将相似的块分组到3D堆栈中。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180601-b0822b35-8347-4344-a4b9-b2c1156fc004.webp#height=352&id=yxsLs&originHeight=352&originWidth=357&originalType=binary&size=0&status=done&style=shadow&width=357)<br />在噪声图像中选择一些大小为k×k的参考块，在参考块周围的适当大小（n×n）的区域中搜索，找到差异程度最小的多个块，并进行积分这些块变成3维矩阵。查找相似块的过程可以由以下公式表示：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180607-2ed2d56e-75d9-48b9-84f9-ef608d1edbef.webp#height=42&id=zsTgT&originHeight=42&originWidth=253&originalType=binary&size=0&status=done&style=none&width=253)![](https://cdn.nlark.com/yuque/__latex/120e99d176e64e8d8388eb0ef4df3d31.svg#card=math&code=G%28P%29%3D%5C%7BQ%3Ad%28P%2CQ%29%5Cleqslant%5Ctau%5E%7Bstep1%7D%5C%7D&height=20&id=AtByl)<br />d（P，Q）表示两个块之间的欧几里得距离。通过积分相似块获得的最终矩阵是流程图第1步左下角的蓝色R矩阵。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180693-472e78eb-4988-4703-b799-0c860eac58d2.webp#height=310&id=xgODx&originHeight=152&originWidth=332&originalType=binary&size=0&status=done&style=none&width=677)<br />由噪声分组的块的说明由白高斯噪声（均值为零和标准偏差为15）降级的图像。参考块标有“ R”，其余块与之匹配。<br />第二步，协同过滤：在形成几个三维矩阵之后，首先对每个三维矩阵中的二维块进行二维变换，可以使用小波变换或DCT变换等。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180639-3edfc44f-6ef8-4c54-9d1f-c91ffb23227d.webp#height=358&id=n6Yjq&originHeight=163&originWidth=308&originalType=binary&size=0&status=done&style=shadow&width=677)<br />二维转换完成后，对矩阵的三维进行一维转换，通常是Hadamard转换。<br />Hadamard变换是Walsh变换的特殊顺序，也称为Walsh-Hadamar变换。Hadamard变换矩阵也是一个方矩阵，仅包含+1和-1两个矩阵元素。<br />![](https://cdn.nlark.com/yuque/__latex/7ee9ce786095ed1a7f7b79fca8ce77fc.svg#card=math&code=%28H_n%29_%7Bij%7D%3D%5Cfrac%7B1%7D%7B2%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D%7D%28-1%29%5E%7Bi%C2%B7j%7D&height=41&id=sQQbC)<br />任何两行或任何两列之后的数字总和必须为零，也就是说，在不同的行或不同的列之间，它们都彼此正交。Hadamard变换核矩阵和Walsh变换之间的区别只是行的顺序。<br />变换完成后，对三维矩阵进行硬阈值处理，将小于阈值的系数设置为0，然后通过一维逆变换和二维逆变换获得处理后的图像块。第三维。此过程也可以用以下公式表示：<br />![](https://cdn.nlark.com/yuque/__latex/1da70d232a8602aeb89fad395832daf7.svg#card=math&code=Q%28P%29%3DT_%7B3Dhard%7D%5E%7B-1%7D%28%5Cgamma%28T_%7B3Dhard%7D%28Q%28P%29%29%29%29.&height=21&id=GVZZs)<br />在该公式中，二维变换和一维变换由T_ {3Dhard}表示。γ是阈值运算：<br />![](https://cdn.nlark.com/yuque/__latex/128543c1161b0439884b540f8fcd17c1.svg#card=math&code=%5Cgamma%28x%29%3D%5Cbegin%7Bcases%7D%0A0%20%26%20if%20%7Cx%7C%5Cleqslant%5Clambda_%7B3D%7D%5Csigma%20%5C%5C%0Ax%20%26%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D&height=39&id=UPpoU)<br />第三步，聚合：对这些图块进行逆变换，然后放回原处，使用非零分量的数量计算堆栈权重，最后将堆栈后的图像除以每个点的权重，得到基本的估计图像，权重取决于设置的数字0和噪点的强度，此时图像的噪点已被大大消除。
<a name="pcfsy"></a>
## 最终估算
在基本的估计，大大消除了噪音。对于嘈杂的原始图片的每个目标块，可以将相应的基本估计块的欧几里德距离直接用于度量相似度。按从最小到最大的距离排序，并最多选择前N个。基本估计块和有噪声的原始块分别被堆叠成两个三维阵列。因此，此步骤与第一步之间的区别在于，这次将获得两个三维阵列，一个是由噪声图像形成的三维阵列，另一个是通过基本估计获得的三维阵列。<br />两个三维矩阵都经过二维和一维转换。这里的二维变换通常使用DCT变换以获得更好的结果。使用维纳滤波来缩放由噪声图形成的三维矩阵的系数。该系数是从根据基准和噪声强度估算的三维矩阵的值中获得的。此过程也可以用以下公式表示：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180633-c3c03cbb-2ea8-4b3b-af07-4635782e652e.webp#height=58&id=OXvjZ&originHeight=58&originWidth=284&originalType=binary&size=0&status=done&style=none&width=284)![](https://cdn.nlark.com/yuque/__latex/1ae9cdc8d79e8e4e410ee4d121493b78.svg#card=math&code=Q%28P%29%3DT%5E%7B-1%7D_%7B3Dwein%7D%28Wp%C2%B7T_%7B3Dwein%7D%28Q%28P%29%29%29&height=21&id=nGihZ)<br />在该公式中，二维变换和一维变换由T_ {3Dwein}表示。w_p是维纳滤波的系数：<br />![](https://cdn.nlark.com/yuque/__latex/c4c0e364ba564f423d567fed132c028c.svg#card=math&code=w_p%28%5Cxi%29%3D%5Cfrac%7B%7C%5Ctau_%7B3D%7D%5E%7Bwien%7D%28Q%5E%7Bbasic%7D%28P%29%29%28%5Cxi%29%7C%5E2%7D%7B%7C%5Ctau_%7B3D%7D%5E%7Bwien%7D%28Q%5E%7Bbasic%7D%28P%29%29%28%5Cxi%29%7C%5E2%2B%5Csigma%5E2%7D&height=50&id=nizKo)<br />σ是噪声的标准偏差，代表噪声的强度。<br />聚集：与第一步一样，这些块在此处也合并到其原始位置，但是此时的加权权重取决于维纳滤波器系数和噪声强度。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180735-f183c569-2dae-4116-bc34-943993dd867e.webp#height=726&id=YSJNY&originHeight=776&originWidth=724&originalType=binary&size=0&status=done&style=none&width=677)<br />（a）嘈杂的摄影师图像的一部分（PSNR = 17.23，σ= 35）。（b）LPGPCA的结果：PSNR = 27.2。©BM3D的结果：PSNR = 27.83。（d）提出的方法的结果（改进的BM3D）：PSNR = 28.01。<br />经过最终估算后，BM3D算法已大大消除了原始图像的噪声。
<a name="amRTV"></a>
## 评价
常用的降噪指标是“峰值信噪比”（PSNR）。这与众所周知的均方误差有关。对于大小为m×n 的参考图像I和恢复的图像Y，均方误差定义为：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180601-fb0c8ec6-2dcf-4888-9800-ca8f47423a6a.webp#height=49&id=qTL4v&originHeight=49&originWidth=308&originalType=binary&size=0&status=done&style=none&width=308)![](https://cdn.nlark.com/yuque/__latex/d9682759e6b78313edc05cf3ac63c5a2.svg#card=math&code=%5Ctext%7BMSE%7D%28Y%2CI%29%3D%5Cfrac%7B1%7D%7Bmn%7D%5Csum_%7Bx%2Cy%7D%28I_%7Bx%2Cy%7D-Y_%7Bx%2Cy%7D%29%5E2&height=42&id=EKkPb)<br />PSNR在分贝中定义为：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180717-2a8f4325-3001-4f48-9129-06ff7c2e31e4.webp#height=55&id=K9Q0L&originHeight=55&originWidth=308&originalType=binary&size=0&status=done&style=none&width=308)![](https://cdn.nlark.com/yuque/__latex/9ea8ee898eed90325785a9fe331bd549.svg#card=math&code=%5Ctext%7BPSNR%7D%28Y%2CI%29%3D10%2Alog%28%5Cfrac%7BI_%7Bmax%7D%5E2%7D%7BMSE%28Y%2CI%29%7D%29&height=41&id=fQPh0)<br />其中I_ {max}是图像的最大值。归一化为1，可以得到：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180621-f0566f3c-be5a-43b8-bf79-faa62de81967.webp#height=44&id=Spnuw&originHeight=44&originWidth=322&originalType=binary&size=0&status=done&style=none&width=322)![](https://cdn.nlark.com/yuque/__latex/684ff9f315c9f06715530b2989904f35.svg#card=math&code=%5Ctext%7BPSNR%7D%28Y%2CI%29%3D-10%2Alog%28MSE%28Y%2CI%29%29.&height=18&id=TK8Hm)<br />通常，PSNR值越高，质量越好。一般来说，当PSNR小于30dB时，它代表了人眼无法忍受的范围。因此，大多数PSNR值必须> 30dB。但是，高PSNR并不意味着图像质量一定很好。有时必须使用人眼来帮助判断图像质量是否更正确。<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1601343180719-33944dee-4abb-44cf-abc0-69d84eb03d0f.webp#height=485&id=rlbNx&originHeight=409&originWidth=571&originalType=binary&size=0&status=done&style=shadow&width=677)<br />PSNR量度的图示。
<a name="54bbba80"></a>
## 结论
大多数图像处理算法的有效性取决于仔细的参数选择。例如，去噪方法通常需要降噪强度或一个补丁的大小进行设置。可以针对每个图像调整这些参数，但是忽略局部图像特征会导致次优结果。<br />自适应地设置滤波参数具有明显的好处，在平滑细节细节风险较低的平滑区域中，去噪强度可以更高；而在噪声很少可见的高纹理区域中，降噪强度可以更低。通过混合不同算法的输出也可以轻松实现自适应性，每种算法最多只能在图像的不同部分运行。
