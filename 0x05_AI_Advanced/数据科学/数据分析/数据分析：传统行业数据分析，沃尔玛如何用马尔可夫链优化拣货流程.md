数据分析
<a name="rjHj5"></a>
## 案例 1 — 拣配过程
以物品拣选的各个步骤为例
<a name="jhMxk"></a>
### 拣货步骤

- 检查下一个商品的位置和数量
- 转到该位置并检查是否存在该商品
- 如果商品存在（订购数量），请选择它并移至下一个商品位置
- 如果订购的商品不存在，请寻找 1-2 个的替代商品
- 如果替代品存在并且很好，则拣选一个并移至下一个商品位置
- 如果替代品不可用、不合适或不适合放入容器，选择看上去与订购商品接近的商品，或不选任何商品，然后继续进行下一个商品的挑拣
<a name="otZkS"></a>
### 拣货步骤可视化
![2021-05-07-13-12-43-339253.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364509620-61a6aad0-684a-40c4-8cc3-7880b27065b4.png#clientId=uc998f13f-fb2a-4&from=ui&id=u7034ad1a&originHeight=776&originWidth=1080&originalType=binary&size=155289&status=done&style=shadow&taskId=u04822d05-3f6a-48f5-914b-923f7adc48a)<br />商店中商品的典型拣货流程图<br />订单/物品交付后，客户可以选择接受还是拒绝。拒绝可能由于各种原因而发生，即

1. 损坏的物品
2. 对客户来说为不适合的替代品

如上图所示，一个商品可能会处于 3 种可能的状态

1. 客户接受
2. 客户拒绝
3. 没有商品选择（零选择）
<a name="kA5r8"></a>
### 业务指标
基于此过程，可以回答诸如以下的问题吗？

- 每天被客户手动拣选并被客户接受的总拣选物品的百分比是多少？
- 当客户的替代品缺货时，客户接受的商品百分比是多少？
- 对于特定的项目类别（例如Colas），当不适合容器的替换商品被拒绝的百分比是多少？
- 由于原商品不可用而被剔除的商品的百分比是多少？

如果可以得到此类问题的答案，可以使企业识别导致接受度降低，零选择率较高的物品/物品类别。为实现此目的，提出了一种状态转换模型，该模型基于可用数据来获取状态转换的概率。
<a name="M9mwl"></a>
### 模型
商品挑拣的过程非常适合于马尔可夫链模型。在选择过程中过渡到下一个状态仅取决于当前状态，而不取决于过去的状态，这使其可以表示为马尔可夫链。<br />![2021-05-07-13-12-43-446266.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364521214-139e4f65-294b-479c-9d5e-2e50d01bb5de.png#clientId=uc998f13f-fb2a-4&from=ui&id=ub82be7a3&originHeight=916&originWidth=1080&originalType=binary&size=284497&status=done&style=shadow&taskId=u81419685-cd01-416b-b29b-2cd2edd6892)<br />马尔可夫状态转换图<br />缩写过程中的各个状态为缩写为:

- 订单商品找到（IF）
- 订单商品未找到（INF）
- 选择替代商品 1（排名最高/最相关）（SUB1）
- 选择替代商品 2（排名稍低）（SUB2）
- 替代产品缺货（OOS）
- 替换商品不合适（BAD）
- 替代商品无法放在容器中（TOTE）
- 替代商品不在指定位置（LOC）
- 替代商品手动拣配（MP）
- 客户接受（CA）
- 客户拒绝（CR）
- 零选择（NP）

转移概率是经验概率。即基于历史经验。<br />还要注意蓝色状态（CA，CR，NP）。这些状态的自转移概率为 1.0。显然，这意味着当拣配商品进入这些状态中的任何状态时，没有任何可能性以非零的概率再走出。<br />在马尔可夫链模型中，此类状态称为吸收状态，上述链称为吸收马尔可夫链，因为每个过渡非终端状态最终都有可能落入3个吸收状态之一。<br />关于 absorbing markov chains 的基础理论：https://www.cnblogs.com/guolei/p/3504931.html
<a name="tkrTH"></a>
### 公式
现在已经定义了状态和转移概率，将其表示为转移矩阵 T<br />![2021-05-07-13-12-43-571169.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364532091-d46da438-450b-48ca-8c12-1e3a9d8b9cbf.png#clientId=uc998f13f-fb2a-4&from=ui&id=u5da3a50b&originHeight=499&originWidth=974&originalType=binary&size=61296&status=done&style=shadow&taskId=u7ae9add9-6b72-464b-a48a-034c4763367)<br />转移概率矩阵<br />蓝色的列代表开始状态，绿色的列代表结束状态。<br />每一行的总和为1，表示此矩阵是右随机矩阵。最后 3 行只有 1 个值 1，表明这些是吸收状态的自转移。<br />以上的转移矩阵 T 可以改为转移态 t 和吸收态 a：<br />其中是矩阵，是矩阵，是零矩阵，是单位矩阵。<br />![2021-05-07-13-12-43-676604.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364548092-88dd26e1-7334-4d80-8af8-aab852c3f614.png#clientId=uc998f13f-fb2a-4&from=ui&id=uf58abf67&originHeight=399&originWidth=899&originalType=binary&size=43361&status=done&style=shadow&taskId=uedb701e2-5b8c-4560-a7f3-3796362cd30)<br />![2021-05-07-13-12-43-825671.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364557428-933a58c0-d895-4e29-ab39-68e9544ea036.png#clientId=uc998f13f-fb2a-4&from=ui&id=u2b0bfedd&originHeight=399&originWidth=399&originalType=binary&size=29888&status=done&style=shadow&taskId=u27fa985f-0e91-4a20-8f64-a0d21b99636)<br />转移矩阵的这种分解可以执行某些操作，这将提供最终的稳定矩阵，该矩阵将提供从以上每个过渡状态进入一个吸收状态的可能性。稳定矩阵由以下公式给出<br />其中是基本矩阵，表示最后收敛到吸收状态的概率<br />该公式可以用矩阵方程形式表示如下<br />其中，是与大小相同的恒等矩阵。计算转换矩阵相同<br />![2021-05-07-13-12-43-939170.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364573449-7013bac6-aa19-434a-90f2-93b155b2db85.png#clientId=uc998f13f-fb2a-4&from=ui&id=ueca3db94&originHeight=258&originWidth=933&originalType=binary&size=45274&status=done&style=shadow&taskId=uab9dcbc0-98b2-44c1-badb-0897ba8d863)<br />最终计算出稳定矩阵<br />![2021-05-07-13-12-44-042895.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364588546-77e43bf3-c692-44b9-93f0-8bba047033a5.png#clientId=uc998f13f-fb2a-4&from=ui&id=u2407bc33&originHeight=399&originWidth=449&originalType=binary&size=42653&status=done&style=shadow&taskId=ua83ea792-e20d-4f2f-a204-1c17a6a425f)<br />最终状态稳定矩阵
<a name="y7kL2"></a>
### 结论解释
从稳定矩阵中得出什么？第 i 行和第 j 列中的数据给出了从瞬态过渡到吸收态的最终可能性。

- 当未找到订购的物品（INF）时，客户接受的概率（CA）为 0.7675，而没有物品拣选（NP）的概率为 0.215，这表明拣配过程中发生的所有事情，客户接受度占 77％，而 没有物品拣选的零选择（NP）则接近 22％。
- 没有物品拣选（NP）结果就是业务直接损失，因此此过程立即突显了效率低下以及业务需要重点关注的地方。此外，这会导致不良的客户体验。
- 可以看到，如果替换物品的位置（LOC）不正确，则没有物品拣选（NP）的可能性高达 35％，总体客户接受度将下降到将近 59％。
<a name="dk3zP"></a>
### 如何改善
比如管理人员相出可以在商品挑拣时有新的替代品产生，那么替代中间态（OOS，BAD，TOTE，LOC等）又可能会进入新替代品产生的状态。如下所示，这在拣配过程中引入了一个新状态（以绿色标记）。<br />![2021-05-07-13-12-44-199474.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364598442-fcda5060-89f8-4456-a26c-4aae2e9405a6.png#clientId=uc998f13f-fb2a-4&from=ui&id=uf6be8ea2&originHeight=892&originWidth=933&originalType=binary&size=228553&status=done&style=shadow&taskId=uf8814ee7-db94-4da0-8ebd-d3682b9f500)<br />往返于新状态“ New Sub Picked”（NS）的新状态转换将添加到原始转换矩阵中。<br />![2021-05-07-13-12-44-275272.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364608091-2b97a4b4-b2ca-4371-9000-72d0cc0dfa4d.png#clientId=uc998f13f-fb2a-4&from=ui&id=u2aace23b&originHeight=399&originWidth=874&originalType=binary&size=54339&status=done&style=shadow&taskId=u1198d1af-2468-4ec0-a93a-b69a9613f22)<br />具有新状态的转移矩阵<br />![2021-05-07-13-12-44-412507.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364616994-843bef4a-4801-440d-8945-7ae313a619de.png#clientId=uc998f13f-fb2a-4&from=ui&id=uf64aa842&originHeight=326&originWidth=354&originalType=binary&size=37320&status=done&style=shadow&taskId=uc5f34c8e-7e17-4fab-a48f-c98f54a7b97)<br />添加了新状态的最终稳定矩阵<br />注意图1和图2中的稳定矩阵。似乎接受程度进一步下降。除了接受手提袋不匹配（TOTE）的情况外，其他所有接受概率（CA）均已恶化。
<a name="Up4k2"></a>
### 为什么
这是因为假设数字引入了一个新状态（NS），与具有较高接受概率（0.9）的人工拣选（MP）相比，其本身降低了接受概率（0.88）。而且，以前进入 MP 状态的所有路径现在概率都降低。在所有这些期间，零选择概率并没有改变。分析师可以轻松得出以下结论：

- 任何按需替代都必须是极其相关的替代，并且必须至少高于 SUB1 的接受率。
- 任何新的状态添加都必须减少 OOS，BAD，TOTE，LOC 状态的手动拣选概率，且必须减少进入 NP 的转换概率（与替代产品的相关性和可用性成反比）。

尽管这只是整个拣选过程的一小部分，但是当目标也以数字形式明确定义时，像吸收马尔可夫链这样的数学模型就可以清楚地帮助企业确定需要改进的地方。上述表述显然有助于得出两个结论，即

- 减少人工拣选不足以提高客户的接受度，但是按需替代必须非常相关，接受率必须几乎等于 SUB1。
- 零拣选必须下降，要么是手动拣选，要么是按需拣选，这强调了对更好的库存管理的需求，以及可以近乎实时地产生替代品的解决方案。
<a name="xUTHq"></a>
## 用例 2 -交付过程中冷藏物品的变质
![2021-05-07-13-12-44-559167.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364628411-ecbfd4b4-753f-4fc9-aae8-d1189213016f.png#clientId=uc998f13f-fb2a-4&from=ui&id=u8fe72cbe&originHeight=556&originWidth=933&originalType=binary&size=158791&status=done&style=shadow&taskId=u9b3536d7-b27d-47e9-ad37-9ce410559db)<br />交付工作流程—冷藏物品<br />与任何物品一样，冷藏物品也要经过如上所述的交付工作流程。

- 物品在冷却机中
- 物品在推车中拣选
- 物品存放在登台区域以备取货
- 物品已装入货车的冷藏区域
- 物品已交付给客户

步骤 2 和步骤 3 是此工作流程中的步骤，其中，冷藏物品可能会暴露于环境温度/光线下。将某些易腐物品暴露在光线和室温下会导致产品中的某些生化反应，从而使产品恶化。为了便于讨论，将集中讨论暴露于环境温度下的衰减率概率。概率值是假设的，但创建这些值是为了说明后续模型及其用法。
<a name="nBURN"></a>
### 模型
和以前一样，将衰减率及其对客户的接受/拒绝建模为每个转移概率的状态。下面列出的数字是假设性的，仅用于说明该概念。缩写过程中的各个状态为缩写为：

- 拣货到卡车的时间 <15 分钟（PT15）
- 拣货到卡车的时间 <25 分钟（PT25）
- 恶化率高达 2％（DR2）
- 恶化率高达 5％（DR5）
- 好好）
- 客户接受（CA）-吸收状态
- 客户拒绝（CR）-吸收状态

![2021-05-07-13-12-44-730708.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364639455-a69376f9-e034-48a3-9397-c076ccaa8012.png#clientId=uc998f13f-fb2a-4&from=ui&id=uc7a3d080&originHeight=662&originWidth=933&originalType=binary&size=197205&status=done&style=shadow&taskId=u9da2acc4-1e71-4342-bffe-124d03a311d)<br />一旦物品被装载到卡车/货车中，它们就会在货车的特殊冷藏区域中被冷藏。制冷通常会降低大多数物品的衰减速率，这是当物品从较高的衰减速率过渡到较低的衰减速率时所见的现象。上图的转换矩阵可以表示为：<br />![2021-05-07-13-12-44-833438.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364648681-00b095af-dd80-4c86-9797-bc3e642d88ea.png#clientId=uc998f13f-fb2a-4&from=ui&id=u52aaba44&originHeight=299&originWidth=624&originalType=binary&size=32241&status=done&style=shadow&taskId=udeca1143-5660-42a1-b5f4-73c4d842cf0)<br />可以回答类似的问题吗？

- 如果货车的拣货时间为10分钟，即：冷藏物品暴露于环境温度10分钟，则客户最终接受的概率是多少？
- 如果货车的拣货时间为20分钟，最终被客户拒绝的概率是多少？

通过以上计算稳定矩阵的过程，得到以下结果：<br />![2021-05-07-13-12-44-911227.png](https://cdn.nlark.com/yuque/0/2021/png/396745/1620364666177-b1c6b4c6-1c03-4cfd-86ee-ef1e6c78d8c5.png#clientId=uc998f13f-fb2a-4&from=ui&id=u74ebee98&originHeight=249&originWidth=299&originalType=binary&size=19740&status=done&style=shadow&taskId=u9756af70-adaf-42d0-bc5c-27ab3ec3156)<br />不出所料，可以看到：

- 当物品暴露在环境温度较短的时间内时，接受率更高（82.5％）。
- 随着持续时间延长到 25 分钟，接受概率下降到 78％，拒绝率上升。
<a name="ksFHx"></a>
### 管理意义
这种分析可以帮助商店管理层确定减少衰减的措施，尤其是在无法避免暴露在环境中的情况下。可以考虑按顺序进行拣货，以确保将暴露保持在最低水平。
<a name="Kd0mX"></a>
### 其他马尔可夫链的例子

- 拣货时间影响马尔可夫链（增加或减少拣货时间作为吸收状态）。
- 杂货库存马尔可夫链。
<a name="qs6rf"></a>
### 结论
马尔可夫链模型（Markov Chain Model）是一个很好的数学模型，用于表示此类工作流程，其中转换为状态的概率仅取决于当前状态，如上面的示例所示。流程的这种无记忆特性使其非常适合建模为马尔可夫链以估计最终概率分布。在实践中，采用经验概率模型，转移概率可能会随着时间的变化而变化，增加新的项，或者过程的变化导致完全不同的稳定概率分布，从而得出新的结论。
