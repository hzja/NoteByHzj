神经网络 可视化<br />深度学习领域，最常见的就是各种网络模型，那么在写论文或者文章，介绍网络模型的时候，最好的办法当然就是展示代码画图，整理了 23 个设计和可视化网络结构的工具，23款工具名称分别如下，

1. draw_convnet
2. NNSVG
3. PlotNeuralNet
4. TensorBoard
5. Caffe
6. Matlab
7. Keras.js
8. Keras-sequential-ascii
9. Netron
10. DotNet
11. Graphviz
12. Keras Visualization
13. Conx
14. ENNUI
15. NNet
16. GraphCore
17. Neataptic
18. TensorSpace
19. Netscope CNN Analyzer
20. Monial
21. Texample
22. Quiver
23. Net2Vis

<a name="LXKlE"></a>
# **工具**
<a name="9uICI"></a>
## 1. draw_convnet
Github: [https://github.com/gwding/draw_convnetstar](https://github.com/gwding/draw_convnetstar)<br />这个工具最后一次更新是 2018 年的时候，一个 python 脚本来绘制卷积神经网络的工具
<a name="iXBTh"></a>
## 2. NNSVG
网址：[http://alexlenail.me/NN-SVG/LeNet.html](http://alexlenail.me/NN-SVG/LeNet.html)这个工具有 3 种网络结构风格，分别如下所示：
<a name="SYtUe"></a>
### LeNet 类型
![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212825-57a44336-8f41-423b-b28d-36fce92f9d1a.webp#align=left&display=inline&height=222&originHeight=222&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="49b8fff3"></a>
### AlexNet 类型
![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212890-6e5b91b6-8f42-400e-8878-fdb3f900c54e.webp#align=left&display=inline&height=221&originHeight=221&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="bOMJr"></a>
### FCNN 类型
![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212897-276f7d1f-b2c5-4311-a507-a750c3c0b53c.webp#align=left&display=inline&height=799&originHeight=799&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="HlQP4"></a>
## 3. PlotNeuralNet
GitHub 地址：[https://github.com/HarisIqbal88/PlotNeuralNetstar](https://github.com/HarisIqbal88/PlotNeuralNetstar)<br />这个工具是基于 Latex 代码实现的用于绘制网络结构，可以看看使用例子看看这些网络结构图是如何绘制出来的。效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212923-57c10f05-0e94-4de1-ade5-499e1b7005b0.webp#align=left&display=inline&height=261&originHeight=261&originWidth=720&size=0&status=done&style=shadow&width=720)![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212942-3c98c7a0-b4ad-46b1-9852-8292a1643a14.webp#align=left&display=inline&height=219&originHeight=219&originWidth=600&size=0&status=done&style=shadow&width=600)
<a name="U9WnY"></a>
### **安装**
这里给出在 Ubuntu 和 windows 两个系统的安装方式：**ubuntu 16.04**
```bash
sudo apt-get install texlive-latex-extra
```
**Ubuntu 18.04.2** 是基于这个网站：https://gist.github.com/rain1024/98dd5e2c6c8c28f9ea9d，安装命令如下：
```bash
sudo apt-get install texlive-latex-base
sudo apt-get install texlive-fonts-recommended
sudo apt-get install texlive-fonts-extra
sudo apt-get install texlive-latex-extra
```
**Windows**

1. 首先下载并安装 MikTex，下载网站：[https://miktex.org/download](https://miktex.org/download)
2. 其次，下载并安装 windows 的 bash 运行器，推荐这两个：
- Git：[https://git-scm.com/download/win](https://git-scm.com/download/win)
- Cygwin：[https://www.cygwin.com/](https://www.cygwin.com/)
<a name="WL34f"></a>
### **使用例子**
安装完后就是使用，按照如下所示即可：
```bash
cd pyexamples/
bash ../tikzmake.sh test_simple
```
**Python 的用法如下**：<br />先创建新的文件夹，并生成一个新的 python 代码文件：
```bash
$ mkdir my_project
$ cd my_project
vim my_arch.py
```
然后在新的代码文件 `my_arch.py` 中添加这段代码，用于定义网络结构，主要是不同类型网络层的参数，包括输入输出数量、卷积核数量等
```python
import sys
sys.path.append('../')
from pycore.tikzeng import *

# defined your arch
arch = [
    to_head( '..' ),
    to_cor(),
    to_begin(),
    to_Conv("conv1", 512, 64, offset="(0,0,0)", to="(0,0,0)", height=64, depth=64, width=2 ),
    to_Pool("pool1", offset="(0,0,0)", to="(conv1-east)"),
    to_Conv("conv2", 128, 64, offset="(1,0,0)", to="(pool1-east)", height=32, depth=32, width=2 ),
    to_connection( "pool1", "conv2"),
    to_Pool("pool2", offset="(0,0,0)", to="(conv2-east)", height=28, depth=28, width=1),
    to_SoftMax("soft1", 10 ,"(3,0,0)", "(pool1-east)", caption="SOFT"  ),
    to_connection("pool2", "soft1"),
    to_end()
    ]

def main():
    namefile = str(sys.argv[0]).split('.')[0]
    to_generate(arch, namefile + '.tex' )

if __name__ == '__main__':
    main()
```
最后，运行脚本
```bash
bash ../tikzmake.sh my_arch
```
<a name="QsBB7"></a>
## 4. TensorBoard
[https://www.tensorflow.org/tensorboard/graphs](https://www.tensorflow.org/tensorboard/graphs)<br />使用过 TensorFlow 的都应该知道这个绘图工具，TensorFlow 的可视化工具，查看网络结构、损失的变化、准确率等指标的变化情况等。网络结构的效果如下图所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212903-9acad0ee-9163-4a8a-9553-e7a7574ced66.webp#align=left&display=inline&height=731&originHeight=731&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="W3WQa"></a>
## 5. Caffe
[https://github.com/BVLC/caffe/blob/master/python/caffe/draw.py](https://github.com/BVLC/caffe/blob/master/python/caffe/draw.pyCaffe)<br />Caffe 的绘图工具，效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212909-1066b5be-49b4-4bb9-8d8e-e9349e262355.webp#align=left&display=inline&height=177&originHeight=177&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="61e04749"></a>
## 6. Matlab
[http://www.mathworks.com/help/nnet/ref/view.html](http://www.mathworks.com/help/nnet/ref/view.htmlMatlab)<br />Matlab 的绘图工具，效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212917-a999f83e-d391-48fd-9b99-c48fbf2e97c9.webp#align=left&display=inline&height=154&originHeight=154&originWidth=546&size=0&status=done&style=shadow&width=546)
<a name="phW2x"></a>
## 7. Keras.js
[https://transcranial.github.io/keras-js/#/inception-v3](https://transcranial.github.io/keras-js/#/inception-v3Keras)<br />Keras 的可视化工具，效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213025-967ddb1e-fbb9-495b-882f-6e5062384c89.webp#align=left&display=inline&height=409&originHeight=409&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="nMTyZ"></a>
## 8. keras-sequential-ascii
[https://github.com/stared/keras-sequential-ascii/](https://github.com/stared/keras-sequential-ascii/Keras)<br />Keras 的一个第三方库，用于对序列模型的网络结构和参数进行检查，直接打印出来结果，比如，VGG 16 的网络结构如下所示，每层网络的参数维度，参数的数量以及占整个网络参数的比例都会展示出来：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212958-e7eec2af-28e6-4723-97f5-8d8d1c28ee45.webp#align=left&display=inline&height=1088&originHeight=1088&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="rJ0If"></a>
### **安装**
通过 PyPI：
```bash
pip install keras_sequential_ascii
```
直接通过 github 仓库：
```bash
pip install git+git://github.com/stared/keras-sequential-ascii.git
```
<a name="hJqOU"></a>
### **使用例子**
在代码中添加：
```python
from keras_sequential_ascii import keras2ascii
keras2ascii(model)
```
<a name="g6ONP"></a>
## 9. Netron
[https://github.com/lutzroeder/Netron](https://github.com/lutzroeder/NetronStar)
<a name="LCMxa"></a>
### **简介**
Netron 可以可视化神经网络，深度学习和机器学习模型，目前支持的网络框架包括：

- ONNX: `.onnx, .pb, .pbtxt` 文件
- Keras：`.h5，.keras` 文件
- Core ML：`.mlmodel`
- Caffe：`.caffemodel, .prototxt`
- Caffe2：`predict_net.pb, predict_net.pbtxt`
- Darknet: `.cfg`
- MXNet：`.model, -symbol.json`
- ncnn：`.param`
- TensorFlow Lite：`.tflite`

另外，Netron 也有实验支持这些框架:

- **TorchScript**: `.pt, .pth`
- **PyTorch**：`.pt, .pth`
- **Torch**: `.t7`
- **Arm NN**：`.armnn`
- **Barracuda**：`.nn`
- **BigDL** `.bigdl`, `.model`
- **Chainer** ：`.npz`, `.h5`
- **CNTK** ：`.model`, `.cntk`
- **Deeplearning4j**：`.zip`
- **MediaPipe**：`.pbtxt`
- **[http://ML.NET](http://ML.NET)**：`.zip`
- **MNN**：`.mnn`
- **OpenVINO** ：`.xml`
- **PaddlePaddle** ：`.zip`, `__model__`
- **scikit-learn** ：`.pkl`
- **Tengine** ：`.tmfile`
- **TensorFlow.js** ：`model.json`, `.pb`
- **TensorFlow** ：`.pb`, `.meta`, `.pbtxt`, `.ckpt`, `.index`

其效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212978-d3d3e74e-4a3f-4ae0-9a64-dc2af60c2924.webp#align=left&display=inline&height=484&originHeight=484&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="qq1hZ"></a>
### **安装**
安装方式，根据不同系统，有所不一样：**macOS**两种方式，任选一种：

1. 下载 `.dmg` 文件，地址：https://github.com/lutzroeder/netron/releases/latest
2. 运行命令 `brew cask install netron`

**Linux**也是两种方式，任选其中一种：

1. 下载 `.AppImage` 文件，下载地址：https://github.com/lutzroeder/netron/releases/latest
2. 运行命令 `snap install netron`

**Windows**也是两种方式，任选其中一种：

1. 下载 `.exe` 文件，下载地址：https://github.com/lutzroeder/netron/releases/latest
2. 运行命令 `winget install netron`

**浏览器**：浏览器运行地址：[https://www.lutzroeder.com/ai/netron](https://www.lutzroeder.com/ai/netron)**Python 服务器**：首先，运行安装命令 `pip install netron`，然后使用方法有两种：

- 命令行，运行 `netron [文件路径]`
- `.py` 代码中加入
```python
import netron;
netron.start('文件路径')
```
<a name="fFoHT"></a>
## 10. DotNet
[https://github.com/martisak/dotnets](https://github.com/martisak/dotnets)<br />这个工具是一个简单的 python 脚本，利用 `Graphviz` 生成神经网络的图片。主要参考了文章：https://tgmstat.wordpress.com/2013/06/12/draw-neural-network-diagrams-graphviz/用法如下：在 MaxOS 上：
```python
python dotnets.py | dot -Tpng | open -f -a /Applications/Preview.app
```
或者生成 PDF 文件
```python
python dotnets.py | dot -Tpdf > test.pdf
```
其效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212949-5e5880c1-7625-440a-b895-05ae49539da7.webp#align=left&display=inline&height=359&originHeight=359&originWidth=709&size=0&status=done&style=shadow&width=709)
<a name="b2329d84"></a>
## 11. Graphviz
[http://www.graphviz.org/](http://www.graphviz.org/)<br />教程：[https://tgmstat.wordpress.com/2013/06/12/draw-neural-network-diagrams-graphviz/](https://tgmstat.wordpress.com/2013/06/12/draw-neural-network-diagrams-graphviz/)<br />`Graphviz` 是一个开源的图可视化软件，它可以用抽象的图形和网络图来表示结构化信息。其效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998212965-41a60e3e-49d5-4231-a97e-20d40b1ad8cb.webp#align=left&display=inline&height=349&originHeight=349&originWidth=459&size=0&status=done&style=shadow&width=459)
<a name="KAYKC"></a>
## 12. Keras Visualization
[https://keras.io/api/utils/model_plotting_utils/](https://keras.io/api/utils/model_plotting_utils/)<br />这是 Keras 库中的一个功能模块-- `keras.utils.vis_utils` 提供的绘制 Keras 网络模型（使用的是 `graphviz` ）其效果如下所示：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213002-cab4ef68-7671-4539-a30b-b9d1bc576a3c.webp#align=left&display=inline&height=516&originHeight=516&originWidth=427&size=0&status=done&style=shadow&width=427)
<a name="v2MVe"></a>
## 13. Conx
[https://conx.readthedocs.io/en/latest/index.html](https://conx.readthedocs.io/en/latest/index.htmlPython)<br />Python 的一个第三方库 `conx` 可以通过函数`net.picture()` 来实现对带有激活函数网络的可视化，可以输出图片格式包括 SVG, PNG 或者是 PIL。其效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213007-6c1ce908-4908-4ba0-ba83-dbd0f82e72db.webp#align=left&display=inline&height=638&originHeight=638&originWidth=650&size=0&status=done&style=shadow&width=650)
<a name="7bY6O"></a>
## 14. ENNUI
[https://math.mit.edu/ennui/](https://math.mit.edu/ennui/)<br />通过拖和拽相应的图形框来实现一个网络结构的可视化，下面是一个可视化 LeNet 的例子：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213031-0fda233b-c6f8-4d78-b00a-cc57f2c31844.webp#align=left&display=inline&height=327&originHeight=327&originWidth=1080&size=0&status=done&style=shadow&width=1080)
<a name="KvsNw"></a>
## 15. NNet
教程：[https://beckmw.wordpress.com/2013/03/04/visualizing-neural-networks-from-the-nnet-package/R](https://beckmw.wordpress.com/2013/03/04/visualizing-neural-networks-from-the-nnet-package/R) 工具包，简单的使用例子如下：
```python
data(infert, package="datasets")
plot(neuralnet(case~parity+induced+spontaneous, infert))
```
效果如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213030-f6751c46-c05f-47e0-8578-8fbc844a77b3.webp#align=left&display=inline&height=396&originHeight=396&originWidth=722&size=0&status=done&style=shadow&width=722)
<a name="UZeFA"></a>
## 16. GraphCore
[https://www.graphcore.ai/posts/what-does-machine-learning-look-like](https://www.graphcore.ai/posts/what-does-machine-learning-look-like)<br />**GraphCore** 主要是展示神经网络中操作的可视化结果，但也包括了网络结构的内容，比如每层的网络参数等。下面展示了两个网络结构的可视化效果--AlexNet 和 ResNet50.
<a name="AlexNet"></a>
### AlexNet
![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213068-16d5d28d-f115-4260-a03b-383eaace67fa.webp#align=left&display=inline&height=640&originHeight=640&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="bpWbh"></a>
### ResNet50
![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213053-7437afa2-5fb0-4c4e-b247-5b24b0b0e527.webp#align=left&display=inline&height=650&originHeight=650&originWidth=720&size=0&status=done&style=none&width=720)
<a name="0tsaI"></a>
## 17. Neataptic
[https://wagenaartje.github.io/neataptic/](https://wagenaartje.github.io/neataptic/)<br />**Neataptic** 提供了非常灵活的神经网络可视化形式

- 神经元和突触可以通过一行代码进行删除；
- 没有规定神经网络的结构必须包含哪些内容

这种灵活性允许通过神经进化（neuro-evolution）的方式为数据集调整网络结构的形状，并通过多线程来实现。其效果如下图所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213011-1cadb309-7ef4-41a5-aea3-42b3f7fc990b.webp#align=left&display=inline&height=663&originHeight=663&originWidth=695&size=0&status=done&style=shadow&width=695)
<a name="Kim8T"></a>
## 18. TensorSpace
[https://tensorspace.org/](https://tensorspace.org/)<br />教程：[https://www.freecodecamp.org/news/tensorspace-js-a-way-to-3d-visualize-neural-networks-in-browsers-2c0afd7648a8/](https://www.freecodecamp.org/news/tensorspace-js-a-way-to-3d-visualize-neural-networks-in-browsers-2c0afd7648a8/)<br />**TensorSpace** 是通过 TensorFlow.js，Three.js 和 Tween.js 构建的一个**神经网络三维可视化框架**。它提供了 APIs 来构建深度学习网络层，加载预训练模型以及在浏览器中就可以生成三维的可视化结构。通过应用它的 API 接口，可以更直观地可视化和理解通过 TensorFlow、Keras 和 TensorFlow.js 等构建的任何预训练模型。效果如下图所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213066-ed78bc4e-9e1c-4ea0-98b6-13cca359c81c.webp#align=left&display=inline&height=304&originHeight=304&originWidth=716&size=0&status=done&style=none&width=716)
<a name="2Irtl"></a>
## 19. Netscope CNN Analyzer
[http://dgschwend.github.io/netscope/quickstart.html](http://dgschwend.github.io/netscope/quickstart.html)<br />一款基于 web 端的可视化和分析卷积神经网络结构（或者是任意有向无环图），当前支持使用 Caffe 的 prototxt 形式。效果如下图所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213061-d29dae5a-6a4e-4f6d-8725-08f2519e3834.webp#align=left&display=inline&height=906&originHeight=906&originWidth=999&size=0&status=done&style=none&width=999)
<a name="rWVUS"></a>
## 20. Monial
[https://github.com/mlajtos/moniel](https://github.com/mlajtos/moniel)<br />计算图的交互式表示法，展示例子如下所示，左边是输入，右侧就是对应结构的可视化结果。![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213103-86bddd6f-2183-4290-b0ce-166ff9288601.webp#align=left&display=inline&height=343&originHeight=343&originWidth=819&size=0&status=done&style=none&width=819)
<a name="a5Xja"></a>
## 21. Texample
[http://www.texample.net/tikz/examples/neural-network/](http://www.texample.net/tikz/examples/neural-network/)<br />这个工具也可以通过 LaTex 来实现一个神经网络结构的可视化，比如，一个 LaTex 的例子：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213125-c486abd4-b054-4491-aa06-38f09a05dca4.webp#align=left&display=inline&height=885&originHeight=885&originWidth=720&size=0&status=done&style=none&width=720)<br />其可视化结果如下所示：<br />![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213131-fb0c0646-4be5-4302-9143-fab1148a2395.webp#align=left&display=inline&height=309&originHeight=309&originWidth=500&size=0&status=done&style=shadow&width=500)
<a name="hsqnV"></a>
## 22. Quiver
github: [https://github.com/keplr-io/quiver](https://github.com/keplr-io/quiverStar)<br />Keras 的一款交互式可视化卷积特征的一个工具展示例子如下所示：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213109-cb63dc0c-0483-4074-a5ef-5501b0cc392b.webp#align=left&display=inline&height=399&originHeight=399&originWidth=720&size=0&status=done&style=shadow&width=720)
<a name="5HrbV"></a>
### **安装方式**
两种方式，直接用 `pip`
```bash
pip install quiver_engine
```
或者通过 GitHub 仓库的方式：
```bash
pip install git+git://github.com/keplr-io/quiver.git
```
<a name="4t7qC"></a>
### **使用例子**
首先构建 keras 模型：
```python
model = Model(...)
```
接着通过一行代码来发布可视化的展示板：
```bash
quiver_engine.server.launch(model, classes=['cat','dog'], input_folder='./imgs')
```
最后在刚刚设置的文件夹中就可以看到每个网络层的可视化结果。如果是想在浏览器中查看，代码如下：
```python
from quiver_engine import server
server.launch(model)
```
默认的地址是 `localhost:5000`
<a name="TTgQW"></a>
## 23.Net2Vis
论文地址：[https://arxiv.org/abs/1902.04394](https://arxiv.org/abs/1902.04394)<br />[Github](https://arxiv.org/abs/1902.04394Github)：[https://github.com/viscom-ulm/Net2Vis](https://github.com/viscom-ulm/Net2Vis)<br />这款工具的效果例子图：![](https://cdn.nlark.com/yuque/0/2020/webp/396745/1600998213090-3f31bc80-27f3-42e3-bb71-64509b42b580.webp#align=left&display=inline&height=424&originHeight=141&originWidth=720&size=0&status=done&style=shadow&width=2163)安装方法首先假设已经安装了 python3 和 npm，然后：

1. 克隆这个 github 项目：<br />
```bash
git clone https://github.com/viscom-ulm/Net2Vis
```
  2. 为了后端工作，这里需要安装 Docker 和 Cairo，主要的作用是转换为 PDF，以及在浏览器里可以运行模型。<br />如果是采用 docker，那么也要运行 daemon，这样才能在单独的容器里运行粘贴的代码。对于后端的配置，步骤如下：
```bash
# 1.进入后端的文件夹内
cd backend
# 2. 安装依赖包
pip3 install -r requirements.txt
# 3. 安装 docker容器
docker build --force-rm -t tf_plus_keras .
# 4. 根据你的系统安装对应的 python 的 cairo 包，比如Debian 的 python-cairosvg 
# 5. 开启服务
python server.py
```
而前端是一个 react 的应用，使用方式如下：
```bash
# 1. 进入文件夹
cd net2vis
# 2. 安装 JavaScript 的依赖包
npm install
# 3. 开启应用
npm start
```
参考文章：

1. [https://datascience.stackexchange.com/questions/12851/how-do-you-visualize-neural-network-architectures](https://datascience.stackexchange.com/questions/12851/how-do-you-visualize-neural-network-architectures)
2. [https://datascience.stackexchange.com/questions/2670/visualizing-deep-neural-network-training](https://datascience.stackexchange.com/questions/2670/visualizing-deep-neural-network-training)
<a name="T0yZD"></a>
### **小结**
这 23 款工具的输出结果既有直接打印的，也有黑白图、彩色图、炫酷的球体可视化结果，以及三维可视化结果，基本都可以支持目前主流的深度学习框架，当然也有的是基于特定框架，比如 keras，实现的对应第三方库。可以根据需求和使用的框架来进行选择，相信应该能够满足大部分人对可视化网络结构的需求。
