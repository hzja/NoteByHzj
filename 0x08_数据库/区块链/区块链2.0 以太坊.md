#区块链2.0 以太坊

---
##以太坊是什么？为什么认为其是区块链2.0的代表
通过深入了解比特币系统可知,区块链是源自比特币的底层技术,其让我们可无须借助任何第三方中介直接进行价值表示和价值转移，还给数字世界带来价值表示物--通证.区块链将使互联网从"信息互联网"阶段跨越到"价值互联网"阶段.

但区块链技术要应用还需要持续迭代升级.比特币系统和区块链都是专为创建一个去中心化的点对点电子现金设计,如果把比特币系统看成区块链1.0,则 以太坊就是升级迭代版,是区块链2.0的典范.

过去几年出现了很多对比特币系统的改进,如替代币(altcoin)、替代链(alt chain)、侧链与跨链等.曾被认为是替代链的以太坊,是对比特币系统众多改进中被广泛接受的一个.

过去几年,基于以太坊区块链、以太坊的智能合约与通证标准,大量的通证涌现,使以太坊成为仅次于比特币系统的热门生态.在软件层面,以太坊新加入的是智能合约,但实际应用中,其真正带来巨变的是通证.

现在不少新项目在认可以太坊是区块链2.0的前提下,试图竞争成为所谓的区块链3.0,试图成为应用开发的新一代平台,竞争才刚刚开始.

> 当下对于区块链的发展阶段划分,一个被普遍接受的分类来自区块链研究者梅兰妮·斯万，在《区块链：新经济蓝图》一书中，她将区块链分为：区块链1.0，货币；区块链2.0，合约；区块链3.0，应用。从货币到合约、再到应用是一种阶段分类，以太坊白皮书的题目即宣称，它试图成为智能合约和去中心化应用的平台。

以太坊也在持续发展，随着自身技术与功能的优化，它被开发者选用于更广泛的应用开发，它或许可能往前进一步演化，成为用于应用的区块链3.0中的一员，毕竟以太坊最初的设计目标就是成为智能合约和去中心化应用的平台。

以太坊的创始人叫维塔利克·布特林，常被昵称为“V神”。

###详解以太坊之一：智能合约和去中心化应用的平台

在以太坊白皮书中,维塔利克在分析比特币区块链之后认为,在比特币系统的基础上开发出高级应用有三种可行路径:

+ 建立一个新的区块链
+ 比特币区块链上使用脚本
+ 在比特币区块链上建立元协议(meta-protocol)

维塔利克认为,比特币系统的主要设计UTXO(未使用的交易输出)和其对应的脚本语言有缺陷,总结认为有以下四点不足(见下图):

+ 缺少图灵完备性（lack of turing-completeness）。尽管比特币的脚本语言可以支持多种计算，但是它不能支持所有的计算。
+ 价值盲（value-blindness）。UTXO 脚本不能为账户的取款额度提供精细的控制。
+ 缺少状态（lack of state）。UTXO 只能是已花费或者未花费状态，这意味着 UTXO 只能用于建立简单的、一次性的合约。
+ 区块链盲（blockchain-blindness）。UTXO 看不到区块链的数据，比如区块头部的随机数、时间戳和上一个区块数据的哈希值。

维塔利克得出结论,认为应当开发一个"下一代智能合约和去中心化应用平台",把自己将开发的系统命名为"以太坊".

![一张图看清以太坊](yizhangtukanqingyitaifang.jpg)

在白皮书摘要部分,这样描述以太坊的目标:

> 以太坊的目标是，提供一个区块链，内置有成熟的图灵完备的编程语言，用这种语言可以创建合约来编码，实现任意状态转换功能。

“状态转换”反映了维塔利克对比特币系统和区块链的认识。在白皮书中他认为，比特币是一个状态转换系统，而他为以太坊设计了一个更灵活的状态转换系统。

以太坊的目标描述可以细分成以下三个部分：  
1、维塔利克要创建一个新的区块链。  
2、这个区块链的特色是，有一个能实现所有计算，即所谓的图灵完备的脚本编程语言。  
3、这个脚本语言可以用来创建复杂的“智能合约”，用以控制区块链的状态转换，也即进行链上数字资产的转移。

> 关于智能合约，在以太坊白皮书中，维塔利克用的词汇是“实现预先设定规则的一段代码”（implementing arbitrary rules）。在区块链上，这些代码的用途是控制链上的数字资产的转移。关于智能合约的更多介绍见相关冷知识专栏讨论。

在以太坊白皮书中，维塔利克认为，在以太坊上可以开发三大类应用（见上图）：

+ 金融应用（financial）：为用户提供更强大的的方法，用他们的钱去管理和参与合约。这些应用包括子货币、金融衍生品、对冲合约、储蓄钱包、遗嘱，甚至雇用合约。
+ 半金融应用（semi-financial）：这里有钱的存在，但非金钱的方面所占的比例也很重。一个好例子是为了解决计算问题而设的自动执行的悬赏。
+ 非金融应用（non-financial）：如在线投票和去中心化治理等。

以太坊的最初设计目标是建立一个智能合约和去中心化应用平台，它和比特币区块链的最大不同是，它包括了一个图灵完备的编程语言（Solidity）。利用 Solidity，我们可以在以太坊上更方便地编写“智能合约”，以太坊也提供了一个代码运行环境——以太坊虚拟机（EVM）。有了这些，在以太坊区块链上，逻辑上我们就可以开发去中心化应用（decentralized application）了。去中心化应用常被简写为 DAPP，现在它通常指利用了区块链技术的网站或移动 App 应用（见下图）。

![从比特币区块链到以太坊区块链](congbitebiqukuailiandaoyitaifangqukuailian.jpg)

###详解以太坊之二:用智能合约管理数字资产与ERC20通证标准
现在可以看出,以太坊并没有像最初的设想,从比特币区块链的加密数字货币功能跨出两大步,成为应用的平台.按梅兰妮斯万的区分,区块链1.0是货币,区块链2.0是合约,区块链3.0是应用,以太坊的初始目标是建立智能合约和去中心化应用平台.在实践中,它跨出了一步或者说半步:以太坊区块链上最常用的功能并非去中心化应用,而是编写智能合约,更确切点,编写智能合约以管理用通证表示的数字资产.

这或是区块链这个新兴技术在发展和应用过程中的必然阶段,一个新技术总会首先被用于当前条件下最适用的领域.

为理解通证和数字资产,再来对比下比特币和以太坊.在比特币的二次开发或应用中，最广为人知的是众多的替代比.通过简单修改比特币开源代码的参数,然后即可用这个代码运行一个新的区块链,创建新的替代币.

在以太坊的二次开发或应用中,最广泛的是基于它的智能合约 创建符合ERC20标准的通证.以太坊的智能合约将创建通证的门槛降到很低.(见下图)

![congbitebidaoyitaifang:zhinengheyueyutongzheng](congbitebidaoyitaifangzhinengheyueyutongzheng.jpg)

若需真正了解代币众筹，可回到以太坊的开始时刻.匿名的中本聪几乎靠自己一个人设计和开发了比特币系统,规划其经济激励模型,然后让其于互联网上自由生长.比特币项目中,花费的本金，资金的来源,猜测总投入并不大.

但当维塔利克和团队开发与运营以太坊时，它已经不太可能是一个宿舍里的作品，以太坊团队需要资金来运转。

在发布白皮书后，维塔利克吸引合伙人加入，建立了一个项目所需的商业和法律架构（一个瑞士公司以及后续的一个瑞士的非营利性基金会）。他和团队一起进行项目的设计与开发。在2014年4月，以太坊发布了由联合创始人加文·伍德（Gavin Wood）撰写的技术白皮书。

> 以太坊技术白皮书见：[https://ethereum.github.io/yellowpaper/paper.pdf](https://ethereum.github.io/yellowpaper/paper.pdf)。

为了获得所需的资金，在 2014 年 7 月到 8 月，以太坊进行了为期 42 天的在线众筹：参与者可以用比特币换取以太坊的通证——以太币（当时叫ether）。

这个代币众筹可以看成是，面向比特币持有者进行了一次以太币的预售。在 2008 年前后，KickStarter、Indigogo 等产品众筹网站开始逐渐建立，后来还出现了股权众筹等各种形式。以太坊的众筹可以说是这种产品众筹方式的延续，不同的是：

+ 它所筹集的不是法币（法定货币），而是比特币。
+ 人们获得的不是明确的商品或股权，而是换得了以太币。

这个以太币有什么用，代表什么权益，当时参与者均没有对此进行多少探讨。毕竟，这次代币众筹是在当时非常小的比特币社区中进行的，带有强烈的理想主义，很像是比特币社区的成员们用自己手上的比特币赞助了一个新区块链的开发。

通过这次代币众筹，以太坊获得了 31531 个比特币，按当时的比特币价格换算，它获得了 1843 万美元，这是当时排名第二的众筹项目。

2015 年 6 月 30 日，以太坊的首个版本正式上线，预挖的 7200 万枚以太币被分配给众筹参与者与项目团队（见图4）。在之前的众筹中，以太坊共售出了 6010 万枚以太币。到此，以太坊的代币众筹过程就完成了。

![以太币的供给:从7200万枚到一亿枚](yitaibidegongjicong7200wanmeidaoyiyimei.jpg)

由于之后比特币的价格大幅波动，众筹获得大量比特币的以太坊项目还经历了几个插曲。比如，由于比特币价格暴跌，而以太坊基金会没有在高点把手中的比特币换成法币，它用以支付各项费用的法币资金短缺，不得不大幅度削减预算。

2015 年 9 月，中国万向集团旗下的基金用 50 万美元向以太坊基金会“购买”了41.6万枚以太币。按2018年5月以太币处于较低点的价格计算，这批以太币的价值仍超过2亿美元。这常被认为是一次“赞助”，是对当时资金困难的以太坊基金会的支持。

在发展的一开始，以太坊有了这样一个成功的代币众筹，这一思路很自然地被发扬光大。

在2015年11月19日，以太坊的主要开发者费边·沃格尔斯特勒（Fabian Vogelsteller）向社区提议了ERC20标准。
> ERC 是 Ethereum Request for Comment 的缩写，除了 ERC20 这个可互换通证标准之外，主要采用的标准还有 ERC721 不可互换通证标准（non-fungible tokens），它也被称为契约（deeds）。在 2018 年年底大为流行的加密猫（CryptoKitty）是基于 ERC721 通证标准发行的。

> ERC20 最初的建议见：[https://github.com/ethereum/eips/issues/20](https://github.com/ethereum/eips/issues/20)，最终标准文件见：[https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20.md](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20.md)。ERC721标准地址见：[https://github.com/ethereum/EIPs/blob/master/EIPS/eip-721.md](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-721.md)。

这是一个用以太坊区块链智能合约发行可互换通证（fungible token）的方案。所谓可互换通证，指的是每一个通证都是一模一样的，比如任何两张 100 美元的价值是完全相同的，又比如你持有的一家上市公司的1万股普通股股票和我持有的 1 万股普通股是可互换的。

另一种方案是在 2018 年 6 月正式获得以太坊社区认可的 ERC721 通证标准，它是不可互换通证（non-fungible token）。不可互换通证的参照物是棒球卡、邮票等收藏品等，比如我的一本专门题名给我的签名书和你的同一本书是不同的，二者不可互换。

有了ERC20通证标准，我们可以在以太坊上很简单地编写一个智能合约，创建表示价值的通证。虽然这些通证所表示的价值是什么仍不明确，但大量的通证已经被创建出来。截至2018年5月，在以太坊上有8万多种创建ERC20标准通证的智能合约。

在2017年，这些符合ERC20标准的通证的重要用途是被用于首次代币发行的筹资，人们可以用以太币按照项目方设定的兑换率来换取这些通证，而项目方获得以太币形式的资金。

以太坊区块链及其智能合约、ERC20通证标准提供了简单地创建代表价值的通证的技术方案，最终在 2017年造成了通证的大爆发。这些通证在各个国家或地区的合规是一个引起激烈争论的议题。但不管怎样，从技术上讲，以太坊的实际功能是数字资产系统，因而从区块链1.0到区块链 2.0，是从“数字现金”到“数字资产”（见下图）

![以太坊及其通证让区块链从数字现金系统演变为数字资产系统](yitaifangjiqitongzhengrangqukuailiancongshuzixianjinxitongyanbianweishuzizichanxitong.jpg)

##V神是谁

"V神"的真名是维塔利克 布特林,是以太坊的创始人,区块链界真正的大佬.

1994 年 1 月 31 日，V神出生于俄罗斯，6 岁时，他跟随父母移民到加拿大。他的父亲是一个计算机科学家，因而他从小就接触计算机，在小学时，他被选入杰出儿童班，认识到自己对数学、编程和经济学充满了兴趣。2012 年，他赢得了国际信息学奥林匹克比赛的铜牌。以最传统的眼光看，V神就是天才少年。

在区块链世界中，V神的第一个角色是作者，他写文章探讨比特币和区块链。

17岁时，V神从他父亲那里了解到比特币。在论坛上认识一些人之后，他被邀请为一个比特币博客写文章，当时，他写一篇文章可以得到5个比特币（价值 3.5 美元）。可惜的是，由于当时只有很少的人关注比特币，这个博客网站很快关停了。

2011 年 9 月，V神和网上认识的朋友一起创办了名为比特币杂志（Bitcoin Magazine）的网站，他是联合创始人和主要作者。在 2012 年年底，这个媒体还开始出版印刷版杂志，成为最早报道加密数字货币的杂志。比特币杂志后来被媒体机构 BTC Media 收购，直到 2014 年年中，V神都还在为它写文章。

在区块链世界中，V神很快有了第二个角色，一个做区块链规划与开发的程序员。

2013 年，V神周游全球，他曾有一段时间待在中国，他的中文也很好，常和中国网友在论坛上用中文交流。在这段时间内，他在全球与网上认识的朋友们见面交流比特币系统和区块链编程。

大约在这个过程中，他形成了要做名为“以太坊”（Ethereum）的项目的念头。他认为应该为比特币开发一个脚本编程语言，从而在比特币区块链上可以开发应用。但是，他的想法无法得到比特币社区的认可。因而他开始考虑，也许自己应该开发一个带有脚本编程语言的新平台。

2013 年年底，他在回到加拿大多伦多后，发布了一份白皮书形式的论文“以太坊：下一代智能合约和去中心化应用平台”。他在详细地分析了比特币系统的设计、优点和不足后，提出要建立一条新的区块链，使之成为去中心化应用的平台。

> 以太坊白皮书的标题为：A Next-Generation Smart Contract and Decentralized Application Platform；网址为：https://github.com/ethereum/wiki/wiki/White-Paper。

去中心化的想法很早就扎根在他的心中。在13岁的时候，V神沉迷于“魔兽世界”游戏不可自拔，但后来发生了一件事让他非常愤怒。开发魔兽游戏的暴雪公司取消了术士的“生命虹吸”技能，他写邮件和在论坛里与暴雪的工程师沟通，尝试要求恢复这个技能，但得到的回复都是，我们是出于游戏平衡才这么做的，不能恢复。V神认识到，玩家是很弱势的，像暴雪这样的游戏开发商是中心，它说了算。

后来，在为《商业区块链》一书写的序言中，V神把自己和以太坊所处的技术浪潮统称为“去中心化科技”（decentralized technologies）。他写道：“与其寄希望于我们打交道的对方能够诚实，不如建立一个能够内生包括我们想要的东西的技术系统。这样，即使里面的参与者是腐败的，系统本身也能保持正常运作，得到我们想要的效果。”

V神曾经在多伦多大学上了8个月学，但在拿到Facebook早期投资人彼得·蒂尔鼓励辍学创业的10万元蒂尔奖学金后，他从 2014 年开始全职开发以太坊项目，从此开创了一段传奇。

从2013年的白皮书开始，以太坊项目经过了4年多的发展，并最终在2017年大爆发：基于它的通证数量暴涨，以太坊自己的燃料货币“以太币”的价格在一年的时间里最高涨了170多倍，从2017年年初的8美元涨到年底的接近1400美元。

V神自此拥有了在区块链世界中的第三个角色——一个技术领袖。

V神引领着以太坊系统的开发，也带动着整个区块链技术的开发和应用。在中文网络论坛中，网友对他的称呼从“V生”变成了“V神”。在神秘的比特币发明者中本聪完全消失于网络后，V神成为区块链领域最重要的人物。

V神很早就表现出一个技术领袖的能力与魅力。在 2016 年出版的《区块链革命》一书中，数字经济专家唐·塔普斯科特写道，若要找一下历史上的例子做类比的话，下面这个类比是很明显的：V神之于以太坊，就如同林纳斯之于Linux系统一样。林纳斯与V神的对比如下图所示。

![林纳斯与V神:两个技术领袖](linasiyuvshenlianggejishulingxiu.jpg)

---
##智能合约是什么
尼克 萨博最早于1994年提出智能合约.他定义道:"一个智能合约是,一个计算机化的交易协议,它执行一个合约的条款."

> 交易协议中的“协议”二字指的是计算机协议。尼克·萨博的智能合约论文见：[http://www.fon.hum.uva.nl/rob/Courses/InformationInSpeech/CDROM/Literature/LOTwinterschool2006/szabo.best.vwh.net/smart.contracts.html](http://www.fon.hum.uva.nl/rob/Courses/InformationInSpeech/CDROM/Literature/LOTwinterschool2006/szabo.best.vwh.net/smart.contracts.html)

尼克 萨博是知名的计算机科学家、法学学者和密码学者,其研究重点是智能合约与数字现金.1998年,他还曾创建中心化的数字现金比特黄金.

### 为何需要智能合约

尼克·萨博说：“智能合约的设计目标是，执行一般的合同条件，最大限度地减少恶意和意外的状况，最大限度地减少使用信任中介。”   
他认为，我们需要一个这样的计算机协议：它能够完全保证，如果付款了，商品会被发送，或者商品寄出去了，就会收到钱。     
在现实生活中，我们有很多办法来实现这一点。而计算机科学家的目标是，用事先确定的代码自动执行合约条款，无须人工干预和第三方中介。    
智能合约中的“智能”可以理解为，按条件自动执行，无须人的干预，是自动的或自治的。    

###"合同"是智能合约的好类比吗
按其名字，智能合约的好类比是不是在商业活动中所签订的“合同”？其实不是。

智能合约贴切的形象类比，是在说起计算机术语“有限状态机”或“状态机”时常用的自动可乐售卖机：

+ 我们向可乐售卖机投入硬币，按一下出可乐的按钮。
+ 售卖机将一听可乐从出货口放出来。
+ 售货机恢复到最初的状态。

萨博在1997年的文章中也说，智能合约的原始祖先是不起眼的自动售货机。  

在以太坊白皮书中，维塔利克还特别指出，这里的“合约”不应被理解为需要执行或遵守的东西，而应看成是存在于以太坊执行环境中的“自治代理”（autonomous agents），它拥有自己的以太坊账户，它们收到交易信息后就相当于被捅了一下，然后自动执行一段代码。

还可以这么理解:

+ 区块链存储的是"状态",智能合约是用于状态转换的方式.
+ 智能合约像一个特别的"时钟",把世界从"同步"转向"异步".

###智能财产:用智能合约控制实体资产

在智能合约论文中，萨博还讨论了如何把智能合约用于实体资产，形成所谓的智能财产（smart property）。

所谓智能财产，是智能合约程序按照设定的规则控制的财产。萨博举例说明如下：    

+  例如，为了防止一部车被偷窃，除非确定拥有者完成正确的“挑战响应协议”，否则车是不会启动激活的。
+ 例如，如果车是贷款买的，当拥有者无法偿还贷款时，智能合约将会自动启动扣押令，并将车钥匙的控制权交给银行。一旦拥有者还清贷款，智能合约就移除扣押令。

智能资产的概念后来被扩大了，在对比特币的相关介绍中有这样说法：由比特币区块链上的智能合约控制的资产，不管是实体的还是数字的，都叫智能资产(见下图)

![智能资产:由区块链上的智能合约控制的线上或线下资产](zhinengzichanyouqukuailianshangdezhinengheyuekongzhidexianshanghuoxianxiazichan.jpg)

尼克 萨博的关键论文:

+ 1994，Smart Contracts.
+ 1996，Smart Contracts:Building Blocks for Digital Markets.
+ 1997，The Idea of Smart Contracts.

---
##以太坊智能合约是什么 
以太坊是最早提出做智能合约的平台.由于以太坊区块链被普遍接受,因此多数区块链的智能合约采取与以太坊相似的设计.

###以太坊的智能合约是什么
以太坊的智能合约并非现实中常见的合同,而是存在区块链上,可被触发执行的一段程序代码,这些代码实现了某种预定规则,是存在于以太坊执行环境中的"自治代理".以太坊的账户与合约如下图所示.

![以太坊的账户与合约](yitaifangdezhanghuyuheyue.jpg)

以太坊的智能合约设计很简明:

+ 任何人都可以在以太坊区块链上开发智能合约，这些智能合约的代码是存在于以太坊的账户中的，这类存有代码的账户叫合约账户。对应地，由密钥控制的账户可称为外部账户。   
+ 以太坊的智能合约程序，是在以太坊虚拟机（Ethereum Virtual Machine,EVM）上运行的。
+ 合约账户不能自己启动运行自己的智能合约。要运行一个智能合约，需要由外部账户对合约账户发起交易，从而启动其中的代码的执行。

以太坊和比特币的一个重大不同是，前者提供了图灵完备的编程语言（Solidity）和相应的运行环境（EVM）。所谓图灵完备，指的是这个脚本编程语言可以运行所有可能的计算，而比特币的UTXO模型和脚本只能运行部分计算。

###以太坊的智能合约有什么用

以太坊的智能合约被广泛应用的一个用途是创建通证，通证对应的多是以太坊区块链之外的资产。

下图是一个简明的图示，这是从 Komhar 咨询公司的一个图示重绘而来的。图示是一个典型的 ERC20 通证发行过程：一个项目通过智能合约创建通证，这个通证是实体资产或线上资产的价值表示物。投资者（用户）发起交易，向智能合约转入以太币（ETH），智能合约自动运转，在满足一定规则后，它向投资者账户转入相应数量的通证。

![以太坊的通证合约逻辑示意图](yitaifangdetongzhengheyueluojishiyitu.jpg)

---
##V神说以太坊的Token系统
以太坊的重要应用是在它上面用智能合约发行通证。在白皮书中，维塔利克（人称“V神”）详细地讨论了所谓的“Token 系统”。

他的讨论可以引导思考：在区块链上，通证可以表示何种价值或资产？如何用通证来表示资产？以及用通证表示资产后如何形成应用系统？

下面是维塔利克在以太坊白皮书中的讨论。为了与一般性的“通证”说法区分，这里引述的中文翻译中称 token 为“令牌”。

###令牌系统（token systems）

链上令牌系统有很多应用，从代表美元或黄金等资产的子货币到公司股票，代表智能资产的单独令牌，安全的、不可伪造的优惠券，甚至与传统价值完全没有关联的令牌系统，如积分奖励。

在以太坊中实施令牌系统非常容易。关键的一点是理解，所有的货币或者令牌系统从根本上来说都是带有如下操作的数据库：从A中减去X单位并把X单位加到B上。前提条件是：   

1. A在交易之前有至少X单位；
2. 交易被A批准。

实施一个令牌系统，是把这样一个逻辑实施到一个合约中去。

区块链能方便地承载Token系统，是源于它特殊的存储机制——它存储的是状态。我们熟悉的数据库存储的不是状态，数据库的记录可以反复修改；而区块链中存储的是状态，也就是某一时刻所保存的信息。

在《商业区块链》一书中，区块链专家威廉·穆贾雅提出了一个可以用Token系统表示的事物的分类。他把区块链中可存储的事物的首字母组成了一个单词“ATOMIC”：

+ 可编程的资产（assets）。
+ 可编程的信任（trust）。
+ 可编程的所有权（ownership）。
+ 可编程的货币（money）。
+ 可编程的身份（identity）。
+ 可编程的合同（contracts）。

---
##机器比人更需要验证
讨论数字世界中表示价值的通证时,常会拿它与法定货币作比较,这会带来一个疑问:很多情况下,延续数千年的人类货币已经工作得很好,数字世界中在线支付系统也工作得很好.至于它们是中心化的还是去中心化的,对于用户来说并不是那么重要.那为什么还需要通证?可从很多个角度来探讨这个话题,其中可能是最重要的一个观点是,机器比人更需要通证.

###通证有什么用

如下图所示,可用两个维度把世界分成几个部分,一个维度是区分数字世界和物理世界;另一个维度是区分信息互联网和价值互联网.这里把所有线下资产都视为一类,为第三类.

![从四个象限看通证的用途](congsigexiangxiankantongzhengdeyongtu.jpg)

可借用这张图示思考"通证有什么用"这个问题.   

通证的作用是,数字世界中,区块链表示价值.比特币、以太币等是凭空在区块链上发行出来的.

要把其他象限的价值映射到链上、用通证来表示，主要有两个路径：

+ 路径之一是，把原本在互联网上通过中心化机构的数据库表示的价值和价值转移，切换到去中心化的区块链上来。比如常见的有网络零售的支付、社交网络的积分、游戏里的道具等，反映在图中就是从象限 ② 到象限 ③。    
+ 路径之二是，把实体中的资产映射到链上，通过区块链进行流通。比如常见的有：把线下的民宿、供应链金融、资产证券化（ABS）中的资产用通证进行表示，反映在图中就是从象限 ③ 到象限 ①。     

这两个都是值得探索的方向，但在这两个方向上探索时，我们逐渐地感到困惑：通证除了可以更大范围地进行交易，似乎并没有带来多少独特优势。对于路径一，互联网上的各类点卡、积分、道具一直运作良好；对于路径二，用通证进行表示依然没有能解决线下资产如何数字化的问题，也没有解决它们的流通性问题。

问题可能出在，把线上、线下资产变成链上资产，用通证进行表示，通过自由市场交易来发现其价格，这只是表面的变化。当我们意识到自己还在把它们折算为法币值多少钱时，我们发现，传统的法币在代表这类价值时已经做得足够好。

在如上这些领域中，用法币来表示这些价值以及相关的金融工具都非常成熟。把线下、线上资产用通证进行表示，可以带来一些优势，比如，过去在互联网上一个点赞 0.0001 美元的行为也许就被忽略了，而现在可能被通证记录下来了。但是，这带来的变化还是不那么大。出现这样的困惑是因为，我们始终站在人的视角来看通证的可能性，而通证能发挥作用的地方应当是法币不那么有效的地方。

###当我们不再站在人的视角
当站到机器的视角去看通证时，我们会发现通证的独特价值，它的角色是法币无法替代的。

token 这个词在网络通信中的原始含义是令牌，只有有令牌的节点才能参与通信，令牌代表权利。当数字世界的范围扩大，在看机器相互交互的场景时，我们会看到，它们比人类更需要通证。

来看一种场景，在讨论中我们暂用 token 而不是通证。

假设，为了防止网络中的机器发出垃圾邮件，我们设定如下规则：个人电脑或手机在发出邮件时，需要消耗一个 token；发件邮件服务器也要消耗一个 token。如果这个邮件不被垃圾邮件规则拦截，或不被个人举报为垃圾邮件，那么在一定时间内，所消耗的 token 又会回到我们手中。

在这个过程中实际发生的是 token 的抵押，从而确保我们行为的正当性。系统可以预先给各个邮件账号和邮件服务器分配适量的 token，这样我们正常发送邮件就不会受到影响。对于那些需要大量发送推广邮件的人而言，他们发送的邮件有一定可能被认为是垃圾邮件，他们就需要用法币换取一定的 token，否则他们可能因为 token 数量为零而无法再发送邮件。

要让这样一个使用 token 的反垃圾邮件系统投入运营，我们的设计肯定不应是每个电脑、手机、服务器都需要存入法币，以购买 token，那只是特殊情况。我们的设计可能是，让这些机器可以自行以某种方式获取 token，比如这些计算机可以完成什么计算任务以获得 token。

从这样一个简单的例子中可以看到，机器在交互时比我们更需要 token。

放到物联网的场景中，每个传感器在和其他机器进行交互时，可能获得 token 或消耗 token。我们的做法也不应是给每个传感器开设一个和法币对应的账户。这时，我们应该设计机器专用的钱包和 token。

随着越来越多的物联网设备接入网络，我们需要有各种不同的机器 token。

在多数情况下，机器用自己类型的 token 就足够了。只有在极少数情况下，我们才需要根据一定的汇率，让这些 token 与其他数字货币进行转换，让它与法币进行转换。兑换并不频繁，转换的汇率也并不特别重要。

因此，当转换到机器视角时我们看到：在人的世界里，通证有意义，但不够大；在机器的世界里，通证不可或缺（见下图）。机器比我们人类更需要通证。机器如何使用通证，将可能是区块链和通证应用的主要探索方向之一。

![机器的世界vs人的世界](jiqideshijievsrendeshijie.jpg)

---
##ERC20通证标准是什么?

ERC20通证标准(ERC20 Token Standard是通过以太坊创建通证时的一种规范.按照ERC20的规范可编写一个智能合约,创建“可互换通证"。其并非强制要求,但遵循这个标准,所创建的通证可与众多交易所、钱包等进行交互,它现在已被行业普遍接受.

###ERC是什么
ERC是 Ethereum Request for Comment的缩写,20是编号.征求修正意见书(Request for Comment,RFC)是互联网工程任务组(IETF)发布的一系列工作备忘录,后来演变为用来记录互联网规范、协议、过程等的标准文件.比如,常见的互联网协议的RFC编号分别是:IP,791;TCP,793;SMTP,2821.

现在,以太坊已经沿用比特币的提法,对比特币系统的改进提案现在被称为BIP(Bitcoin Improvement Proposals),然后加上编号.与通证相关的标准沿用ERC的形式,但均被纳入EIP（Ethereum Improvement Proposals)序列之中,以太坊EIP的标准序列包括Core(核心改进)、Networking(网络层改进)、Interface(接口改进)、ERC(应用层意见征集).

	以太坊的改进提案网址为:https://eips.ethereum.org

###ERC20是什么
ERC20通证标准最早由以太坊开发者费边.沃格尔斯特勒在开源社区中提出,后来以太坊创始人维塔利克(人称"V神")撰写了第一版文档,当时名为"标准化合约API"(Standardized_Contract_APIs)

	最早的讨论文档见:https://github.com/ethereum/EIPs/issues/20

遵循ERC20标准,基于以太坊创建的通证是通用的,可被以太坊和区块链世界的多数其他应用所使用.除了官方实现外,现在以太坊网络中已经有了多种符合ERC20标准的软件实现.

###详解ERC20通证标准
遵循ERC通证标准可编写智能合约,它需要实现的通证方法包括:可选的name、symbol、decimals，必须有的balanceOf、transfer、transForm、approve、allowance.它需要实现的事件响应包括Transfer、Approve.(见下图)

![ERC20智能合约程序的方法与事件](ERC20zhinengheyuechengxudefangfayushijian.jpg)

现在ERC20的文档见:[https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20.md](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20.md)

除了 ERC20 之外，以太坊受关注的通证标准还有ERC721.与ERC20不同，ERC721是一种不可互换的通证标准(Non-fungible Token Standard，NFT)。

ERC20的通证是可互换的、同质的，而ERC721的通证是不可互换的、非同质的；ERC20通证是可无限分割细分的，而ERC721通证的最小单位是 1，无法再分割细分。

2018年6月，ERC721最终被以太坊社区正式接受，成为最终标准。之前大热的加密猫（cryptokitties，谜恋猫）所遵循的就是 ERC721 标准。

---
##The DAO众筹事件与以太坊分叉

以太坊的代币众筹曾经历了一次大的灾难性事件，这次事件甚至导致了以太坊区块链的分叉。

2016年4月30日，The DAO项目在以太坊中进行代币众筹，到5月28日，这个项目筹集了1150万个以太币，以当时以太币的价格计算价值超过1.5亿美元，是当时最大金额的众筹。

但是，在2016年6月9日，有开发者发现The DAO的智能合约存在漏洞，他还在开源平台上提交了修复代码。

6月17日，黑客利用漏洞向一个匿名的地址转移走了项目众筹来的360万枚以太币，占到总数的 1/3。

幸运的是，受限于The DAO的28日锁定期，要到7月14日，黑客才可以把这笔以太币转走。

关于如何处理这个漏洞和黑客攻击事件，挽回损失，以太坊社群分裂成了两个群体。当时，所有以太币的数量为 8000 多万枚，如果有1150万枚被黑客盗走，的确会对以太坊生态造成巨大的影响。

在各种方案都不能奏效后，维塔利克（人称“V神”）提出了硬分叉方案（即从某个区块开始以太坊区块链不向前兼容），从而把The DAO众筹来的以太币夺回来，转移到一个恢复地址上，再还给参与众筹的人。

硬分叉方案在社区中获得了85%的投票支持，在2016年7月21日分叉成功，损失被挽回了。

但是，有部分以太坊社区成员不认同这个硬分叉（他们认为没有人可以更改规则），他们仍留在最初的那条以太坊区块链上，并继续开发维护这条链。此后，以太坊区块链分叉成两支：

+ 一支是新的，叫以太坊（其代币叫 ETH）；
+ 一支叫以太坊经典（Ethereum Classic，其代币叫 ETC）

---
##通证该如何设计?如何表示资产?
从比特币到以太坊,从区块链1.0的数字现金进展到区块链2.0的数字资产,人们关注的焦点在发生转移.在讨论比特币系统时,人们关心比特币和加密数字货币,区块链是源自比特币的底层技术,比特币系统实现并验证了区块链的价值表现和价值转移这两个核心功能,并展示了这两者可完全去中心化的.

以太坊的重心则是区块链,以太坊也有类似于比特币的加密数字货币——以太币，但与中本聪没有为比特币设计用途不同，以太币被定位为以太坊区块链的燃料货币。以太坊白皮书说，以太币（ether，现在的代码为ETH）是以太坊的主要内部加密燃料（crypto-fuel），用于支付交易费。在价值转移上，以太坊延续了比特币的区块链设计，依靠分布式账本来进行去中心化、点对点的价值转移。

以太坊还进一步带来了智能合约和通证。通过对比我们可以看到，比特币系统只有一种加密数字货币，而在以太坊区块链上，在以太币之外出现了众多表示价值的通证。

有了智能合约和通证之后，以太坊就有了新的用途——进行数字资产的表示与交易。链上的数字资产也有了一种相对统一的价值表示形式。因而以太坊开始往前一步，超越作为数字现金系统的比特币，开始解决数字资产系统的三个问题（见下图）：

+ 表示的资产是什么？
+ 如何发行？
+ 如何进行复杂交易？

![数字资产系统要解决的三个问题](shuzizichanxitongyaojiejuedesangewenti.jpg)

实际运行时,以太坊被主要用于解决前两个问题--表示的资产是什么以及如何发行.有了数字资产和相关工具之后,人们会很自然地发挥创意,创建关于数字资产的各类复杂应用.

###用通证将资产表示为链上的"数字资产"

来看看通证是如何在链上表示各种资产的。

一般来说，通证是资产在区块链上的价值表示物，涉及的资产包括三类：比特币和以太币等链上的原生资产、映射到链上的线上资产、映射到链上的线下资产。当它们被在链上表示后，我们将之统称为“数字资产”。特别地，用以太坊区块链和它的智能合约可以创建与发行代表价值的通证，然后用它去关联资产，形成现在较为通行的数字资产表示物（见下图）。

在以太坊区块链上主要可以创建两种表示价值的通证：可互换的 ERC20 标准通证和不可互换的 ERC721 标准通证。可互换的通证可类比为现金，不可互换的通证可类比为房契。对表示为通证的数字资产，以太坊智能合约可以进行各种交易，如通证间的兑换、通证抵押、通证分配与消耗等，由此可以形成复杂的数字资产交易与应用。

![数字资产的表示与应用](shuzizichandebiaoshiyuyingyong.jpg)

正如以太坊白皮书所展示的,其系统设计和智能合约是为了更好地进行数字资产的交易.

这里涉及三种资产：链上资产、线上资产、线下资产。其中线上资产与线下资产均不在链上，可认为是链下资产。通常，我们需要辅以预言机（oracle）等工具来连接线上、线下的资产，然后通过智能合约在链上交易。

链上与链下的交互包括两大部分：一是将链下资产与通证关联，进行通证的发行与分配；二是在链上进行通证交易后，对链下资产进行相应的变动，并将变动在链上确认。

将资产表示成通证，即转变成数字资产，带来的好处有：一是市场交易帮助发现价格，二是在流动周转中增加资产价值。其中，关于流动增加总体价值的例子，我们在现实生活中也可以体验到：二手物品的流动让买方和卖方都收益，车辆与房屋的共享提升了资源的利用效率。

###数字资产系统的去中心化交易场景

比特币系统只能进行比特币这种数字现金的去中心化交易.而以太坊作为数字资产系统,基于它的 智能合约创建的各种通证都可以进行中心化或去中心化交易.

来对比三种场景,看如何通过以太坊智能合约进行链上与链下资产的去中心化交易(见下图).

![智能合约取代中心化仲裁者](zhinengheyuequdaizhongxinhuazhongcaizhe.jpg)

####场景A:在数字世界中通过中心化中介进行交易
在数字世界中,当两个人要进行数字资产的交易时,他们之间需要一个可信第三方,这个中介完成:

+ 监督合约执行
+ 作为双方之间的担保
+ 协助进行价值的记录

以熟悉的电商购物(且特别的是购买一个电子文档)为例.假设在淘宝上进行交易,中心化的仲裁者又可细分为淘宝和支付宝两种角色:

+ 买家在淘宝上下单,这是通过淘宝来签订一个购买协议
+ 买家通过支付宝付款,款项由支付宝代管,卖家发出文件,等买家确认后,支付宝将款项支付给卖家
+ 支付宝进行结算,支付宝对双方的账户进行记录的修改,完成金钱价值的转移。

那么如果在以太坊区块链上通过智能合约进行一次去中心化交易,过程是什么样的？

####场景B：通过智能合约进行链上数字资产交易
假设我们编写一个合约，售卖一种基于 ERC721 的不可互换通证，如性质类似于收藏卡的“加密猫”。每个加密猫通证各不相同，预先在智能合约中设定价格均为 10 个以太币，购买方式是先到先得。

这时，去中心化的数字资产交易过程如下：
+ 买方向智能合约地址转入 10 个以太币，即为发起购买邀约，智能合约担任第三方保管的角色。
+ 卖方把该收藏卡（基于 ERC721 的通证）转入买方地址。
+ 智能合约自动将以太币款项转入卖家账户。

由于这里仅涉及以太坊区块链上的数字资产（加密猫通证和以太币）的转移，因此在链上可以完成全部过程。

对比 A、B 两种场景我们看到，原本中心化的中介（如淘宝与支付宝）被按预先设定规则自动执行的智能合约所取代。中心化中介被区块链（即分布式账本和去中心网络）所取代。

####场景C：通过智能合约进行涉及线下资产的交易

如果我们交易的标的不是一个链上的数字资产，比如交易是一个电子文档，甚至一个线下的房产资产，这时通常与智能合约联合起来使用的预言机就要出现了。

当交易的不是链上的数字资产时，智能合约和预言机是一对必备的组合。智能合约在链上，预言机在链下，它可以与链上的智能合约进行通信（见图4）。

比如，当卖家把数字文件传递给买家，买家确认之后，连接链上和链下的预言机就发出消息通知智能合约。在接到消息后，智能合约执行后续的步骤，把以太币转入卖家账户。

![智能合约在链上,预言机在链下](zhinengheyuezailianshangyuyanjizailianxia.jpg)

在涉及线下资产时，逻辑是相似的，只是过程更加复杂。比如，当购买一个实物商品时，买家要到线上的互联网界面中确认收货，而预言机会把消息传送到链上给智能合约，智能合约继续执行后续步骤。

通过这三种简单场景的对比，我们可以看到：

+ 第一，有了智能合约，用通证表示的数字资产就是可编程的；
+ 第二，它是可以由计算机自动处理的，也就是自动化的；
+ 第三，如果数字资产交易各方形成一定的规则与逻辑，那么这些交易方之间可以进行完全自治的交易，可不需要人类的参与。

这些特性组合起来，可以大幅度降低资产流转交易的成本，提高效率，并可以实现智能化。 

###通证的四个特征

中关村区块链产业联盟理事长元道在与孟岩的对谈文章“通证是下一代互联网数字经济的关键”中指出，通证有三个要素，缺一不可。他讨论的三个要素如下：

+ 第一是数字权益证明。通证必须是以数字形式存在的权益凭证，它必须代表的是一种权利，一种固有和内在的价值（intrinsic value）。
+ 第二是加密。通证的真实性、防篡改性、保护隐私等特性，由密码学予以保障。每一个通证都是由密码学保护的一份权利。这种保护比任何法律、权威和枪炮提供的保护都更坚固、更可靠。
+ 第三是可流通。通证必须能够在一个网络中流动，从而随时随地都可以验证。其中一部分通证是可以交易、兑换的。

通证是下一代互联网数字经济的关键——元道区块链对话之一，孟岩/文，2017年12月4日，见[https://blog.csdn.net/myan/article/details/78712506](https://blog.csdn.net/myan/article/details/78712506)。元道原名陈升，是世纪互联数据中心的创始人、董事长。

他还说：“事实上，通证可以代表一切权益证明，从身份证到学历文凭，从货币到票据，从钥匙、门票到积分、卡券，从股票到债券，人类社会的全部权益证明都可以用通证来代表。”

根据之前的讨论，值得补充的一点是：通证是可编程的（见下图）。在区块链上，智能合约可以自动地或自治地处理通证，这是通证不同于过去的货币、证券、积分、收藏品等价值表示物的基本特征。比如，由于通证是可编程的，如果通证由一个社区内的成员持有，那么我们可以利用区块链和通证进行社区的链上治理。

![通证的四个特征](tongzhengdesigetezheng.jpg)

###通证经济系统设计和通证的发行与分配

比特币系统是一个最理想化的情形：它的通证发行是完全去中心化的，由计算机算力按规则竞争完成。但当用通证表示数字资产时，我们不得不从最理想化的发行去中心化往回退了一点，这步回退是让区块链投入使用的必要妥协。

回看以太坊最初的代币众筹过程，严格地说，以太币的发行是中心化的，是由以太坊基金会将以太币售卖给比特币的持有者。但这个过程是自动化的，由预先确定规则、编写后不能修改的智能合约自动执行。

用区块链上的通证来表示链上资产、线上资产、线下资产时，完全的去中心化，甚至完全无人介入的自动化通常是不可行的。资产的设计、发行的设计以及后续项目的运行，都需要有机构来发起。这个机构在一定程度上是区块链项目的中心。

这个发起机构的角色是进行协调，将线上资产、线下资产与通证进行对应。

这个发起机构的角色是发起和发行通证。当然与过去相比，这个机构是相对去中心化的，它并不掌握社区百分之百的“股权”，也不具有绝对的话语权，而必须是做社区的协调者。

这个发起机构的角色也是持续运行项目和社群，直到社区能够自行运转。在项目的发展过程中，随着社区的扩大与强大，中心才可能开始弱化，甚至最终达成去中心化社区状态。

要仔细地辨析发起机构的角色，因为要利用通证来表示资产，构建名为“通证经济体”的产业生态圈，它是关键的驱动者。之前各种理想化的讨论是故意弱化这些发起机构的角色，与事实有很大差异。

同时，在实践中，区块链项目的发起方多为注册在新加坡等地的非营利基金会，在一些国家与地区，这是一条合规的路径。但我们认为，区块链要实现商业落地，较为现实的路径仍是与现有各国的公司注册制度形成某种连接，并强调公司在项目实际运作地的注册和合规运转。因而我们建议将区块链项目的发起机构称为“自商业公司”（Decentralized Autonomous Company，DAC），由它来利用区块链技术与经济手段促成运用通证的产业生态圈。

通过以上讨论，我们可以看到通证经济体通常采取的设计如下：通证经济体是一个产业生态圈或社区；用通证来表示一个生态或社区的广义资产；借助通证来进行分配、交易。它包括各方共同推进三个核心事务（见下图）：

+ 链，区块链技术的落实。
+ 通证，通证的建立、分配与管理。
+ 社群，用户社区与投资社区等以价值共识形成的社群。

![名为“通证经济体"的产业生态圈和它的发起者自商业公司(DAC)](mingweitongzhengjingjitidechanyeshengtaiquanhetadefaqizhezishangyegongsi(DAC).jpg)

发起通证的区块链项目实体（非营利性基金会或自商业公司）是社区和资产的创建者、协调者。

一个通证经济体的发起机构的关键任务之一是设计这个产业生态圈的“通证经济系统”。

通证经济系统设计包括两面，一面是和通证的价值相关的设计，另一面是和通证的数量相关的设计(见下图)

![通证经济系统设计:价值设计与数量设计](tongzhengjingjixitongshejijiazhishejiyushuliangsheji.jpg)

一个通证所表示的价值是什么？如何与现有资产对应？可因什么贡献而获得？如何用它投资社区？如何确定它的价格？这些是通证的价值设计关心的问题。

通证的数量设计则包括初始分配、流转和总量控制等。下面我们重点讨论一下通证的数量设计。

通常，通证在四个群体中进行发行和分配：①投资者；②团队与顾问；③生态成员；④留存。留存的通证并不进入流通，除非它的状态被改变了。团队与顾问、生态成员这两方的通证会随着时间的流逝逐步进入流通：团队与顾问的通证按预设规则逐步解除锁定；生态成员通过贡献获得通证奖励，并按规则逐步解锁与流通（见下图）。

![通证的数量随时间的变化](tongzhengdeshuliangsuishijiandebianhua.jpg)

假设用通证经济系统来改造一个线下社区，那么可能有一个初始分配：投资方、团队各获得一部分通证；现有社区的成员按照规则获得一部分通证；同时将一部分通证留存，以备社区发展之需。

其中，社区成员按一定规则获得通证，就是把线上资产映射到链上，用通证表示出来。

之后，通证将根据社区成员的贡献进行分配。项目团队要设计一个通证在社区内的使用场景：

+ 生态成员如何获得通证？
+ 生态成员如何消耗通证？从项目角度说，也即如何回收通证？
+ 如何安排项目回收的通证？是再次发放与流通，是销毁，还是变更为留存状态？

另外，由于通证是一个经济系统，还会涉及其他与数量相关的经济逻辑，主要包括两点：

+ 总量。通证的总量如何变化？是增多，是不变，还是因逐步销毁而减少？+ 
+ 解锁。被锁定的通证以什么样的速率和规则逐步释放？

确定一个通证的数量逻辑之后，我们就可以编写智能合约用代码实现它，并在区块链上自动甚至自治地运行了。

通过经济系统的设计清单如下图所示

![通证经济系统设计清单](tongzhengjingjixitongshejiqingdan.jpg)

最后特别讨论一个尚没有明确答案的话题：如果通证是对应的某种线上或线下资产，那么所有人都期待它是持续上涨的。而如果通证是代表某种功能的使用权，则它的价格应保持相对稳定，因为如果预计它将上涨，那么谁会提前使用它呢？

在讨论通证价值设计时，人们通常将通证分成两大类：一种代表权益，价格是波动的，并且从长期看是上涨的；一种代表功能使用权，用于消费，价格应该保持相对稳定（见下图）

![从价值设计的角度看通证:表示权益和表示功能](congjiazhishejidejiaodukantongzhengbiaoshiquanyihebiaoshigongneng.jpg)

从目前看，这是一种天然存在的矛盾，虽然二者可以在实践中进行一些调和。目前在进行通证价值设计时，有一种新的思路是，在一个通证经济系统中采用双通证：一个用于表示权益，一个用于表示实用功能。当然，这样做的复杂性大大增加，目前还没有被广为接受的设计思路。在附录B中，我们会讨论 Steem 区块链的通证设计，这个早期区块链项目的多通证设计是已经在实际中运行的案例，经过多轮起起伏伏，虽然有很多问题，但有真实的运行数据可供分析。

	孟岩在通证经济系统设计的相关演讲中认为，币值逻辑有四种：比特币模式、稳定模式、以太坊模式和双层代币模式。我们在讨论时统一采用通证说法，称为“双通证设计”。

###以太坊:数字资产的基础设施

让我们把目光转回以太坊。以太坊区块链是当下用区块链表示数字资产的基础设施。一方面，它为价值表示提供了通证；另一方面，它也为通证数量逻辑的实现提供了编程语言、工具（智能合约）、标准（ERC20等）和运行环境（EVM）。

以太坊区块链和它的智能合约、通证为数字资产的发行与交易提供了一整套去中心化的基础设施。之前，在以太坊的 ERC20 标准被广泛接纳之前，要发行一个原生数字资产需要自行开发一条链，而现在我们可以基于以太坊这条公链来创建一个数字资产的价值表示物。随着在以太坊上发行的通证越来越多，它吸引了更多的人在其上发行通证。

总的来说，以太坊让我们能方便地创建代表数字资产的通证，这使得通证变成一个基础功能，涌现出大量的在区块链上的、通证表示的数字资产。随着使用门槛和成本的降低，很多原本无法进行的应用会涌现出来。

---
##通证的分类
通证是全新的事物，目前人们对于通证的分类仍未达成共识。这里将所见的各种分类列举如下，供你参考。

瑞士金融市场监管局（FINMA）将通证分成以下三种：

+ 支付类通证（payment）。
+ 实用类通证（utility）。
+ 资产类通证（asset）。

其中，资产类通证可视为“证券类”（security），有时，实用类也被翻译成“功能类”。

按美国 SEC 的分类方式，通证被分成属于证券与不属于证券两类。SEC 通常用“Howey Test”来判定某一金融工具是否为“投资合同”进而构成“证券”，“Howey Test”包含了四要素：

+ 资本投入；
+ 投资于一个共同事业；
+ 期待获取利润；
+ 不直接参与经营，仅仅凭借发起人或第三方的努力。

在一次分享中，知名区块链专家、万向区块链董事长肖风将通证分为功能类、证券类和基金类。也有人从产业的角度将通证分为基础公有链、行业生态类、公司证券类。

通证宝创始人王玮将通证按有发行人和无发行人分成两大类。

+ 有发行人的三种是：价值型、收益型、权利型；
+ 无发行人的一种是：计算型。计算型是一个有意思的说法，这一名称表明诸如比特币、以太币等都是基于数学计算产生的。

现在通常认为，比特币、以太币等是接近于瑞士金融市场监管局中的支付类型通证分类。除此之外的通证可以按美国 SEC 分类（证券与非证券）延展进行分类。

在 2018 年 7 月的一个分类中，奥黛丽·奈斯比（Audrey Nesbitt）将通证分为两大类、四小类，我认为，这可能是易于在实际项目的通证模型设计中使用的一种分类（见图1）。其中，两大类之间要进行相对严格的区分，但小类间不必进行明确的区分，她的分类如下：

+ 第一大类：实用型通证（utility to ken）
	+ 产品或服务通证（use of product），代表公司的产品或服务的使用权。
	+ 奖励通证（reward token），用户通过自己的行为获得奖励。
+ 第二大类：证券型通证（security token）。
	+ 权益通证（equity token），类似公司的股权、债券等。
	+ 资产通证（asset token），对应实体世界中的资产，如不动产、黄金等。

![通证的一种分类](tongzhengdeyizhongfenlei.jpg)

当前市场中交易的通证，多数属于权益通证，但为了不受到当前各国法规中对证券的严格监管的影响，又往往通过各种设计将自己设计为实用型通证。

在相关通证设计中，最为独特的案例是 EOS 币，它是由 Block.one 公司发行的，但它被定义为“商品售卖”，而非公司“权益”。并且特别地，公司又通过免责条款免除了 EOS 币任何和实用性相关的特性。比如，EOS 的相关条款说：EOS 币没有明示或暗示的权利、用途、目的、属性、功能或特征。

---
##以太坊智能合约的技术与组件

要在以太坊上编写一个智能合约，所涉及的技术和组件有：

+ Solidity，以太坊的图灵完备编程语言，用于编写智能合约。
+ 虚拟机（Ethereum Virtual Machine，EVM），即智能合约运营的环境。
+ 预言机（Oracle），用于链上和链下数据信息的交换。
+ Web3.js，与以太坊区块链节点进行交互的JavaScript API。

常见的以太坊通证标准有两种：

+ ERC20标准，可互换通证。
+ ERC721标准，不可互换通证。

2014 年 12 月 31 日，维塔利克曾画了一张名为“Silos”的图，展示了他理解的以太坊架构（见图1），从下而上分别是：共识、经济、链上与链下服务、互操作、浏览器、分布式应用（DAPPs）。

一般来说，以太坊的体系架构可分为六层，与比特币系统对比，它的重要特点是把合约层从共识机制中分离出来(见下图)

![以太坊的体系结构](yitaifangdetixijiegou.jpg)

---
##ERC721标准与加密猫

2017 年 11 月 28 日，“加密猫”游戏出现在互联网上。这是基于以太坊的 ERC721 标准（不可互换通证）发行的加密数字宠物，每一只猫咪各不相同。

加密猫的正式中文名叫“谜恋猫”，游戏的官网称这些加密猫是“可收藏、可繁殖、讨人喜欢的”。用户可以用以太币换购这种猫咪。这个简单的游戏吸引了大量的用户，甚至使得以太坊区块链网络出现了大拥堵。

在此之前，人们对以太坊的认识是，它的主要应用是用它的智能合约发行符合 ERC20 标准的可互换通证，同一种通证的一枚和另一枚是完全一样的。

对比而言，基于 ERC721 的这种加密猫的每一只都是独一无二的。加密猫极大地扩展了以太坊的通证用途。有不少分析文章讨论了加密猫的意义，在一篇文章中，作者萨曼莎（Samantha Radocchia）用电子邮件做类比说：

	我认为在互联网的早期，没人想到它会变成今天的样子。我们那时仍在试图弄清楚如何使用互联网。然后，E-mail 出现了。突然间，这个非常强大而重要的工具改变了人们对互联网的看法。
	
	我记得爸爸在我的小时候给我看家里发的电子邮件时，我们都很惊讶。你可以立即给世界各地的人发送一张数字便条。
	
	我们知道（区块链）这项技术有着不可思议的潜力，但我们还无法把握所有的可能性。但像加密猫这样的应用帮助增长了用户基础，增加了我们对于什么是可能的理解。”


加密猫的关键信息如下：

+ 加密猫是一种非替代性代币，它是不可分割且独一无二的。
+ 智能合约拥有 40 亿种表型性变体（你可以看到）和基因型（你无法看到）。
+ 加密猫的架构在以太坊网络之上，加密猫的购买和育种都需要用到以太币。
+ 两只加密猫可以繁殖一只全新的后代。

资料来源：[https://www.cryptokitties.co/Technical-details](https://www.cryptokitties.co/Technical-details).

---
##以太坊的账户(外部账户和合约账户)

以太坊是有账户的，每个用户都可以开设账户，账户余额是我们拥有的以太币或其他基于 ERC20 标准的通证。账户的设计使得以太坊与比特币不同，根据之前的讨论我们知道，比特币只有钱包地址和未使用的交易输出。

###以太坊的两种账户：外部账户和合约账户
以太坊有两种账户，如下图所示：

+ 外部账户（externally owned accounts），由密钥控制。
+ 合约账户（contract accounts），由智能合约的代码控制。

![以太坊的两种账户](yitaifangdeliangzhongzhanghu.jpg)

以太坊的账户包括四个字段：一个随机数、账户的余额、合约代码（如果有的话）、存储（通常为空）。

只有合约账户才有代码，其中存储的是 codeHash（这个账户的以太坊虚拟机代码的哈希值）。这个字段在生成后是不可修改的，这意味着智能合约代码是不可修改的。

外部账户可以触发交易，而合约账户不能主动发起交易，只能在被触发后按预先编写的智能合约代码执行。

合约账户可以设置多重签名（multisign），比如一个简单示例是：现有一个合约账户，它要求一个转账由发起转账的人（Alice）和另一个人（Charles）签名均可。因此，当 Alice 通过这个合约向 Bob 转账 20 个 ETH 时，合约会通知 Charles 签名，在他签名后，Bob 才可以收到这 20 个 ETH(见下图)

![以太坊合约账户的多重签名](yitaifangheyuezhanghudeduochongqianming.jpg)

###以太坊的交易和它的区块中存的是什么

和比特币一样，以太坊的区块中存储的也是交易（transaction），它包括的字段主要有：接受者（接受的账户）、发送者的签名、发送者发给接受者的以太币金额等。

与比特币的区块中存储的是交易不同，以太坊的区块中以梅克尔帕特里夏树（Merkle Patricia Tree,MPT）形式存储的是相应的以太坊账户的状态。

以太坊的交易是所谓的状态转换函数，一个交易触发它的执行，它将相应的账户从一个状态转变成新状态，然后新状态被存储在区块链的数据区块中。

参考资料：[https://github.com/ethereum/wiki/wiki/White-Paper](https://github.com/ethereum/wiki/wiki/White-Paper)

---
##区块链的四大特征
在对比特币和以太坊这两个主要系统，讨论了区块链的价值表示和价值转移这两个基础功能，探讨了数字资产、通证与通证经济系统之后，再来看看区块链的特征与用途，尝试回答“区块链有什么用”这个问题答案就在区块链的四个基础特性中。

在观察了以太坊带来的变化后，区块链特征以及与这些特征相关的应用已经较为清晰地展现在我们面前。这四个基础特征分别是：不可篡改，不可复制的唯一性，智能合约，去中心自组织或社区化（见下图）。

区块链不只是技术，它还将从经济、管理、社会层面带来变化，它可能改变人类交易的方式，它将改变货币、账本、合同、协同等方面，将在以后讨论.

![一张图看懂区块链:从基础到应用](yizhangtukandongqukuailiancongjichudaoyingyong.jpg)

###区块链四大特征之一:不可篡改

区块链最容易被理解的特性是不可篡改的特性。

不可篡改是基于“区块+链”（block+chain）的独特账本而形成的：存有交易的区块按照时间顺序持续加到链的尾部。要修改一个区块中的数据，就需要重新生成它之后的所有区块。

共识机制的重要作用之一是使得修改大量区块的成本极高，从而几乎是不可能的。以采用工作量证明的区块链网络（比如比特币、以太坊）为例，只有拥有 51% 的算力才可能重新生成所有区块以篡改数据。但是，破坏数据并不符合拥有大算力的玩家的自身利益，这种实用设计增强了区块链上的数据可靠性。

通常，在区块链账本中的交易数据可以视为不能被“修改”，它只能通过被认可的新交易来“修正”。修正的过程会留下痕迹，这也是为什么说区块链是不可篡改的，篡改是指用作伪的手段改动或曲解。

在现在常用的文件和关系型数据中，除非采用特别的设计，否则系统本身是不记录修改痕迹的。区块链账本采用的是与文件、数据库不同的设计，它借鉴的是现实中的账本设计——留存记录痕迹。因此，我们不能不留痕迹地“修改”账本，而只能“修正”账本(见下图)

![区块链账本"不能修改,只能修正"](qukuailianzhangbenbunengxiugaizhinengxiuzheng.jpg)

区块链的数据存储被称为“账本”（leger，总账），这是非常符合其实质的名称。区块链账本的逻辑和传统的账本相似。比如，我可能因错漏转了一笔钱给你，这笔交易被区块链账本接受，记录在其中。修正错漏的方式不是直接修改账本，将它恢复到这个错误交易前的状态；而是进行一笔新的修正交易，你把这笔钱转回给我。当新交易被区块链账本接受，错漏就被修正，所有的修正过程都记录在账本之中，有迹可循。

将区块链投入使用的第一类设想正是利用它的不可篡改特性。农产品或商品溯源的应用是将它们的流通过程记录在区块链上，以确保数据记录不被篡改，从而提供追溯的证据。在供应链领域应用区块链的一种设想是，确保接触账本的人不能修改过往记录，从而保障记录的可靠性。

2018 年 3 月，在网络零售集团京东发布的《区块链技术实践白皮书》中，京东认为，区块链技术（分布式账本）的三种应用场景是：跨主体协作，需要低成本信任，存在长周期交易链条。这三个应用场景所利用的都是区块链的不可篡改特性。多主体在一个不可篡改的账本上协作，降低了信任成本。区块链账本中存储的是状态，未被涉及的数据的状态不会发生变化，且越早前的数据越难被篡改，这使得它适用于长周期交易。

###区块链的四大特征之二：表示价值所需要的唯一性
不管是可互换通证（ERC20），还是不可互换通证（ERC721），又或者是其他提议中的通证标准，以太坊的通证都展示了区块链的一个重要特征：表示价值所需要的唯一性。

在数字世界中，最基本单元是比特，比特的根本特性是可复制。但是价值不能被复制，价值必须是唯一的。之前我们已经讨论过，这正是矛盾所在：在数字世界中，我们很难让一个文件是唯一的，至少很难普遍地做到这一点。这是现在我们需要中心化的账本来记录价值的原因。

在数字世界中，我们没法像拥有现金一样，手上拿着钞票。在数字世界中，我们需要银行等信用中介，我们的钱是由银行账本帮忙记录的。

比特币系统带来的区块链技术可以说第一次把“唯一性”普遍地带入了数字世界，而以太坊的通证将数字世界中的价值表示功能普及开来。

2018 年年初，中国的两位科技互联网企业领袖不约而同地强调了区块链带来的“唯一性”。腾讯主要创始人、CEO 马化腾说：“区块链确实是一项具有创新性的技术，用数字化表达唯一性，区块链可以模拟现实中的实物唯一性。”

百度创始人、CEO 李彦宏说：“区块链到来之后，可以真正使虚拟物品变得唯一，这样的互联网跟以前的互联网会是非常不一样的。”

对于通证经济的探讨和展望正是基于，在数字世界中，在网络基础层次上区块链提供了去中心化的价值表示和价值转移的方式。在以以太坊为代表的区块链 2.0 时代，出现了更通用的价值代表物——通证，从区块链1.0的数字现金时期进入到数字资产时期。

###区块链的四大特征之三：智能合约

从比特币到以太坊，区块链最大的变化是“智能合约”（见图3）。比特币系统是专为一种数字货币而设计的，它的 UTXO 和脚本也可以处理一些复杂的交易，但有很大的局限性。而维塔利克创建了以太坊区块链，他的核心目标都是围绕智能合约展开的：一个图灵完备的脚本语言、一个运行智能合约的虚拟机（EVM），以及后续发展出来的一系列标准化的用于不同类型通证的智能合约等。

![区块链2.0的关键改进是"智能合约"](qukuailian2.0deguanjiangaijinshizhinengheyue.jpg)

智能合约的出现使得基于区块链的两个人不只是可以进行简单的价值转移，而可以设定复杂的规则，由智能合约自动、自治地执行，这极大地扩展了区块链的应用可能性。

当前把焦点放在通证的创新性应用上的项目，在软件层面都是通过编写智能合约来实现的。利用智能合约，我们可以进行复杂的数字资产交易。

在讨论以太坊的发展过程时，在冷知识专栏“智能合约”“以太坊的智能合约”中，我们对智能合约进行了很多讨论，在此不再赘述。这里再借维塔利克的讨论，重复一下我们认同的智能合约的软件性质——它相当于一种特殊的服务端后台程序（daemon）。在以太坊白皮书中，维塔利克写道：

（合约）应被看成是存在于以太坊执行环境中的“自治代理”（autonomous agents），它拥有自己的以太坊账户，收到交易信息，它们就相当于被捅了一下，然后它就自动执行一段代码。

智能合约的执行流程如下面第一张图所示,区块链的第5、6个定义如下面第二张图所示.

![智能合约的执行流程](zhinengheyuedezhixingliucheng.jpg)

![区块链的定义之五、之六](qukuailiandedingyizhiwuzhiliu.jpg)

###区块链的四大特征之四:去中心组织

区块链的第四大特征是去中心自组织。到目前为止，主要区块链项目的自身组织和运作都与这个特征紧密相关。很多人对区块链项目的理想期待是，它们成为自治运转的一个社区或生态。

匿名的中本聪在完成比特币的开发和初期的迭代开发之后，就完全从互联网上消失了。但他创造的比特币系统持续地运转着：无论是比特币这个加密数字货币，比特币协议即它的发行与交易机制，比特币的分布式账本、去中心网络，还是比特币矿工和比特币开发，都去中心化、自组织地运转着。

我们可以合理地猜测，在比特币之后出现了众多修改参数分叉形成的竞争币、硬分叉形成的比特币现金（BCH），可能都符合中本聪的设想。他选择了“失控”，失控可视为自治的同义词。

到目前为止，以太坊项目仍在维塔利克的“领导”之下，但正如本章一开始讨论的，他是以领导一个开源组织的方式引领着这个项目，就像林纳斯领导开源的 Linux 操作系统和 Linux 基金会一样。

维塔利克可能是对去中心自组织思考得最多的人之一，他一直强调和采用基于区块链的治理方式。2016 年以太坊的硬分叉是他提议的，但需要通过链上的社区投票，获得通过方可施行。在以太坊社区中，包括 ERC20 等在内的众多标准是社区开发者自发形成的。

在《去中心化应用》一书中，作者西拉杰·拉瓦尔（Siraj Raval）还从另一个角度进行了区分，他的这个区分有助于我们更好地理解未来的应用与组织。他从两个维度看现有的互联网技术产品：一个维度是，在组织上是中心化的，还是去中心化的；另一个维度是，在逻辑上是中心化的，还是去中心化的。

他认为：“比特币在组织上去中心化，在逻辑上集中。”而电子邮件系统在组织上和逻辑上都是去中心化的（见下图）

![比特币在组织上去中心化,在逻辑上集中](bitebizaizuzhishangquzhongxinhuazailuojishangjizhong.jpg)

在设想未来的组织时，我们心中的理想原型常是比特币的组织：完全去中心化的自治组织。但在实践过程中，为了效率和能够推进，我们又会略微往中心化组织靠拢，最终找到一个合适的平衡点。

现在，在通过以太坊的智能合约创建和发放通证，并以社区或生态方式运行的区块链项目中，不少项目的理想状态是类似于比特币的组织，但实际情况是介于完全的去中心化组织和传统的公司之间。

在讨论区块链的第四个特征去中心自组织时，其实我们已经在从代码的世界往外走，涉及人的组织与协同了。现在，各种讨论和实际探索也揭示了区块链在技术之外的意义：它可能作为基础设施支持人类的生产组织和协同的变革。这正是区块链与互联网是完全同构的又一例证，互联网也不仅仅是一项技术，它改变了人们的组织和协同。

总的来说，以太坊把区块链带入了新的阶段。在讨论以太坊时，如果要总结两个关键词的话，那么这两个关键词分别是智能合约和通证；而如果只能说一个的话，我会选择“通证”。我会更愿意从互联网的历史中找寻它的意义，重复之前的类比：作为价值表示物的通证，它的角色类似于 HTML。在有了 HTML 之后，建什么样的网站完全取决于我们的想象力。

现在，很多人迫不及待地试图进入区块链 3.0 阶段，即不再仅把区块链用于数字资产的交易，而是希望将区块链应用于各个产业和领域中，从互联网赋能走向区块链赋能，从“互联网+”走向“区块链+”。继续拿信息互联网的发展历程作为对照来展望未来，信息互联网最早是传递文本信息，但它真正的爆发是后来出现的电商、社交、游戏以及和线下结合的 O2O——也就是应用。未来，真正展现区块链价值的也将是各种现在未知的应用。

[资料来源](http://c.biancheng.net/view/1936.html)