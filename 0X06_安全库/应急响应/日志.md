
/var/log/httpd/access_log  网站


 /var/log/wtmp  last的登陆


<a name="NEPXa"></a>
## 日志
日志的路径<br />[http://c.biancheng.net/view/1097.html](http://c.biancheng.net/view/1097.html)<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1639486610541-142d9ea8-0b2c-4a72-8077-10f4e148a205.png#clientId=ufd18ab5a-39e6-4&from=paste&height=297&id=ue8d94042&originHeight=655&originWidth=1201&originalType=binary&ratio=1&rotation=0&showTitle=false&size=119048&status=done&style=none&taskId=uf186cc4f-52d4-4929-bcec-4d556ef6b93&title=&width=545.4000244140625)

<a name="IOweW"></a>
## web服务日志路径
[https://blog.csdn.net/qq_36119192/article/details/102956230](https://blog.csdn.net/qq_36119192/article/details/102956230)

tomcat中的localhost_access_log专门记录web请求的日志


[https://www.yuque.com/docs/share/5db4005a-2091-455e-9de8-2ace0ee2c134?#](https://www.yuque.com/docs/share/5db4005a-2091-455e-9de8-2ace0ee2c134?#)

清理iis web日志痕迹<br /> C:\inetpub\logs\LogFiles\W3SVC7  

命令行下删除<br /> D:iislog>del /s /q *17011*.log  <br />![企业微信截图_16554434837172.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1655444158974-1aafbca7-4fe5-46a6-8580-91c0babc0d27.png#clientId=ud1a4314f-bdfc-4&from=paste&height=754&id=ua423f8f5&originHeight=943&originWidth=1454&originalType=binary&ratio=1&rotation=0&showTitle=false&size=162193&status=done&style=none&taskId=u1717d3cf-bf4c-4d24-9b28-b0b16bd9993&title=&width=1163.2)<br />![企业微信截图_16554438396083.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1655444181662-3d24157e-8afa-4b43-88f1-a4a5048b26e1.png#clientId=ud1a4314f-bdfc-4&from=paste&height=560&id=u513aa535&originHeight=700&originWidth=1088&originalType=binary&ratio=1&rotation=0&showTitle=false&size=49145&status=done&style=none&taskId=u46c0739a-f139-4493-9f40-0441d60c8e6&title=&width=870.4)<br />![企业微信截图_1655444058375.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1655444191050-b834336a-dfaa-4cf3-b9d5-976b4fc7d940.png#clientId=ud1a4314f-bdfc-4&from=paste&height=409&id=uaf8aa238&originHeight=511&originWidth=832&originalType=binary&ratio=1&rotation=0&showTitle=false&size=31413&status=done&style=none&taskId=u48e49304-5d60-429e-9dd4-ed49d2576fe&title=&width=665.6)

<a name="mW076"></a>
## windows日志
```
系统日志：%SystemRoot%\System32\Winevt\Logs\System.evtx
记录操作系统组件产生的事件，主要包括驱动程序、系统组件和应用软件的崩溃以及数据丢失错误等。

应用程序日志：%SystemRoot%\System32\Winevt\Logs\Application.evtx
包含由应用程序或系统程序记录的事件，主要记录程序运行程序方面的事件。

安全日志：%SystemRoot%\System32\Winevt\Logs\Security.evtx
记录系统的安全审计事件，包含各种类型的登录日志、对象访问日志、进程追踪日志、特权使用、帐号管理、策略变更、系统事件。安全日志也是调查取证中最常用到的日志。默认设置下，安全性日志是关闭的，管理员可以使用组策略来启动安全性日志，或者在注册表中设置审核策略，以便当安全性日志满后使系统停止响应。

```
<a name="OZgwA"></a>
## 常用的windows 事件id 代码含义

```
审计目录服务访问
　　4934 - Active Directory 对象的属性被复制
　　4935 -复制失败开始
　　4936 -复制失败结束
　　5136 -目录服务对象已修改
　　5137 -目录服务对象已创建
　　5138 -目录服务对象已删除
　　5139 -目录服务对象已经移动
　　5141 -目录服务对象已删除
　　4932 -命名上下文的AD的副本同步已经开始
　　4933 -命名上下文的AD的副本同步已经结束
　　审计登录事件
　　4634 - 帐户被注销
　　4647 - 用户发起注销
　　4624 - 帐户已成功登录
　　4625 - 帐户登录失败
　　4648 - 试图使用明确的凭证登录
　　4675 - SID被过滤
　　4649 - 发现重放攻击
　　4778 -会话被重新连接到Window Station
　　4779 -会话断开连接到Window Station
　　4800 – 工作站被锁定
　　4801 - 工作站被解锁
　　4802 - 屏幕保护程序启用
　　4803 -屏幕保护程序被禁用
　　5378 所要求的凭证代表是政策所不允许的
　　5632 要求对无线网络进行验证
　　5633 要求对有线网络进行验证
　　审计对象访问
　　5140 - 网络共享对象被访问
　　4664 - 试图创建一个硬链接
　　4985 - 交易状态已经改变
　　5051 - 文件已被虚拟化
　　5031 - Windows防火墙服务阻止一个应用程序接收网络中的入站连接
　　4698 -计划任务已创建
　　4699 -计划任务已删除
　　4700 -计划任务已启用
　　4701 -计划任务已停用
　　4702 -计划任务已更新
　　4657 -注册表值被修改
　　5039 -注册表项被虚拟化
　　4660 -对象已删除
　　4663 -试图访问一个对象
　　审计政策变化
　　4715 - 对象上的审计政策(SACL)已经更改
　　4719 - 系统审计政策已经更改
　　4902 - Per-user审核政策表已经创建
　　4906 - CrashOnAuditFail值已经变化
　　4907 - 对象的审计设置已经更改
　　4706 - 创建到域的新信任
　　4707 - 到域的信任已经删除
　　4713 - Kerberos政策已更改
　　4716 - 信任域信息已经修改
　　4717 - 系统安全访问授予帐户
　　4718 - 系统安全访问从帐户移除
　　4864 - 名字空间碰撞被删除
　　4865 - 信任森林信息条目已添加
　　4866 - 信任森林信息条目已删除
　　4867 - 信任森林信息条目已取消
　　4704 - 用户权限已分配
　　4705 - 用户权限已移除
　　4714 - 加密数据复原政策已取消
　　4944 - 当开启Windows Firewall时下列政策启用
　　4945 - 当开启Windows Firewall时列入一个规则
　　4946 - 对Windows防火墙例外列表进行了修改，添加规则
　　4947 - 对Windows防火墙例外列表进行了修改，规则已修改
　　4948 - 对Windows防火墙例外列表进行了修改，规则已删除
　　4949 - Windows防火墙设置已恢复到默认值
　　4950 - Windows防火墙设置已更改
　　4951 - 因为主要版本号码不被Windows防火墙承认，规则已被忽视
　　4952 - 因为主要版本号码不被Windows防火墙承认，部分规则已被忽视，将执行规则的其余部分
　　4953 - 因为Windows防火墙不能解析规则，规则被忽略
　　4954 - Windows防火墙组政策设置已经更改，将使用新设置
　　4956 - Windows防火墙已经更改主动资料
　　4957 - Windows防火墙不适用于以下规则
　　4958 - 因为该规则涉及的条目没有被配置，Windows防火墙将不适用以下规则：
　　6144 - 组策略对象中的安全政策已经成功运用
　　6145 - 当处理组策略对象中的安全政策时发生一个或者多个错误
　　4670 - 对象的权限已更改
　　审计特权使用
　　4672 - 给新登录分配特权
　　4673 - 要求特权服务
　　4674 - 试图对特权对象尝试操作
　　审计系统事件
　　5024 - Windows防火墙服务已成功启动
　　5025 - Windows防火墙服务已经被停止
　　5027 - Windows防火墙服务无法从本地存储检索安全政策，该服务将继续执行目前的政策
　　5028 - Windows防火墙服务无法解析的新的安全政策，这项服务将继续执行目前的政策
　　5029 - Windows防火墙服务无法初始化的驱动程序，这项服务将继续执行目前的政策
　　5030 - Windows防火墙服务无法启动
　　5032 - Windows防火墙无法通知用户它阻止了接收入站连接的应用程序
　　5033 - Windows防火墙驱动程序已成功启动
　　5034 - Windows防火墙驱动程序已经停止
　　5035 - Windows防火墙驱动程序未能启动
　　5037 - Windows防火墙驱动程序检测到关键运行错误，终止。
　　4608 -Windows正在启动
　　4609 - Windows正在关机
　　4616 - 系统时间被改变
　　4621 - 管理员从CrashOnAuditFail回收系统，非管理员的用户现在可以登录，有些审计活动可能没有被记录
　　4697 - 系统中安装服务器
　　4618 - 监测安全事件样式已经发生



远程桌面相关：
Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational
1149(远程桌面服务: 用户身份验证已成功:)，有IP
Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational
21(远程桌面服务: 会话登录成功:)，有IP
22(远程桌面服务: 已收到 Shell 启动通知:)，有IP
23(远程桌面服务: 会话注销成功:)，无IP
24(远程桌面服务: 会话已断开连接:)，有IP
25(远程桌面服务: 会话重新连接成功:)，有IP
Microsoft-Windows-RemoteDesktopServices-RdpCoreTS%4Operational
131，有IP
Microsoft-Windows-TerminalServices-RDPClient%4Operational
1024，有IP
Microsoft-Windows-TerminalServices-Printers%4Admin
1111(Send To，发送至，Отправить в)

powershelll 2.0 相关事件id
Windows PowerShell.evtx
每次在PowerShell执行单个命令时，不管是本地会话还是远程会话都会产生以下日志：

事件ID 400：引擎状态从无更改为可用，记录任何本地或远程PowerShell活动的开始；
事件ID 600：记录类似“WSMan”等提供程序在系统上进行PowerShell处理活动的开始，比如”Provider WSMan Is Started“；
事件ID 403：引擎状态从可用状态更改为停止，记录PowerShell活动结束。
其他powershell事件id代表含义
事件ID 6：在客户端系统上的远程处理活动开始时记录。包括系统连接的目标地址；
事件ID 169：在访问系统的远程处理活动开始时记录。包括用于访问WinRM的用户名和身份验证机制；
事件ID 142：如果远程服务器禁用了WinRM，则客户端在尝试启动远程Shell连接时将产生该记录；
事件ID 32850：记录为远程处理进行身份验证的用户帐户；
事件ID 32867/32868：记录在PowerShell远程处理期间进行的每个PowerShell输入和输出对象，包括协议和版本协商以及命令I / O对象在表示为“有效负载数据”的字段中存储为XML编码的十六进制字符串，并且到期长度通常在多个日志消息中分段。
事件ID 142：如果远程服务器禁用了WinRM，则客户端在尝试启动远程Shell连接时将产生该记录；

```
<a name="rMrrw"></a>
## LogParser
LogParser.exe -i:EVT -o:DATAGRID "SELECT TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,'|') as username,EXTRACT_TOKEN(Strings, 8, '|') as LogonType,EXTRACT_TOKEN(Strings, 17, '|') AS ProcessName,EXTRACT_TOKEN(Strings, 18, '|') AS SourceIP FROM Security.evtx where EventID=4624"<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1666451044721-fe33512c-a7bd-4123-a745-d3d7a10bc218.png#clientId=ue9e9af9d-4393-4&from=paste&height=352&id=u80eccf5b&originHeight=440&originWidth=1653&originalType=binary&ratio=1&rotation=0&showTitle=false&size=197054&status=done&style=none&taskId=ue64aa29f-73c1-46f0-8de0-e73c9563dec&title=&width=1322.4)
