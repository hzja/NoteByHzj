很多时候打红蓝、攻防演练，主办方都会直接甩出来一堆公司名字的目标。然而往往备案的其他域名下的网站，会存在严重漏洞，分分钟就打进去了。所以很关键，而且十几个公司名字面前，直接脚本跑，省时间。

思路主要是基于天眼查的备案号查询。[https://beian.tianyancha.com/search/](https://beian.tianyancha.com/search/)<br />直接对源码的
```python
import requests
import re

def beianchaxun(url):
    urls = url
    URL = ("https://beian.tianyancha.com/search/{}".format(urls))
    headers = {
            'Connection': 'close',
            'Cache-Control': 'max-age=0',
            'Upgrade-Insecure-Requests': '1',
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36',
            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
            'Accept-Language': 'zh-CN,zh;q=0.8',
            }
    try:
        req = requests.get(url=URL,headers=headers)
        html = req.content
        #print(req.content.decode())
        titlere = r'<span class="ranking-ym" rel="nofollow">(.+?)</span>'
        title = re.findall(titlere,html.decode('utf-8'))
        if len(title) == 0:
            print(urls,"该公司天眼查找不到备案域名",'\n')
        else:
            print('\n',urls,"备案域名: ")
            for i in title:
                print(i)
    except:
        print('有异常，无法爬取')

def duqu():
    num = 0
    f = None
    filename=input('请输入所有公司名字所在的路径：')
    try:
        with open(filename, 'r',encoding='utf-8') as f:
            line = f.readlines()
            print("共获取了%d个目标"%(len(line)),'\n')
        for i in line:
            num = num+1
            a = i.strip() 
            beianchaxun(a)
    except FileNotFoundError:
        print('无法打开指定的文件!')
    except LookupError:
        print('指定了未知的编码!')
    except UnicodeDecodeError:
        print('读取文件时解码错误!')
    finally:
        if f:
            f.close()
    
if __name__ == '__main__':
    banner='''
    

               __                 
              / _|                
   __ _ _   _| |_ ___ _ __   __ _ 
  / _` | | | |  _/ _ \ '_ \ / _` |
 | (_| | |_| | ||  __/ | | | (_| |    by aufeng 
  \__,_|\__,_|_| \___|_| |_|\__, |    基于天眼查的批量公司名备案查询域名脚本
                             __/ |    Tips ：cmd运行后，输入请输入域名所在的文本路径,txt即可
                            |___/ 


    '''
    print(banner)
    duqu()
    print('\n',"运行完毕")
    #a = '方欣科技有限公司'
    #beianchaxun(a)
```
效果如下：<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1621174702741-de4c3a5d-6734-4f10-9931-3221ac383231.png#align=left&display=inline&height=512&originHeight=683&originWidth=803&size=105941&status=done&style=none&width=602)<br />不足之处，天眼查现在有反爬了，请求次数多了，就会爬不了，但是其实每次资产下来的时候，也就那十来个公司打一周，或许还没必要考虑到那么多.....
