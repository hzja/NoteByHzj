<a name="ralm4"></a>
## 0x01 什么是010 editor
010 Editor 是一款专业的文本编辑器和十六进制编辑器，旨在快速轻松地编辑计算机上任何文件的内容。该软件可以编辑文本文件，包括 Unicode 文件、批处理文件、C/C++、XML 等，但 010 Editor 擅长的地方在于编辑二进制文件。二进制文件是计算机可读但人类不可读的文件（如果在文本编辑器中打开，二进制文件将显示为乱码）。十六进制编辑器是一个程序，允许您查看和编辑二进制文件的各个字节，包括 010 编辑器在内的高级十六进制编辑器还允许编辑硬盘驱动器、软盘驱动器、内存密钥、闪存驱动器、CD-ROM、 流程等。<br />官网地址：[https://www.sweetscape.com/010editor/](https://www.sweetscape.com/010editor/)
<a name="jYBxc"></a>
## 0x02 OD暴力破解
在软件逆向破解的过程中，OD暴力破解是比较有效的方式，通过修改jcc指令或者nop掉一些跳转让程序按照正确的流程走下去。<br />主要流程大概是：1、寻找关键函数；2、分析整体流程；3、修改程序验证逻辑。<br />本次测试的010 editor版本为v13.0<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160316-af21d88b-aa1b-437a-958b-275d1b2dcab4.png#averageHue=%23ef850d&clientId=u7f226194-c18b-4&from=paste&id=uc3316d21&originHeight=895&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u704f0a07-cbf1-4526-8741-75632e64907&title=)<br />首先查壳<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160199-8179419d-bbe5-49bb-a704-0d724eea16a6.png#averageHue=%23dbddda&clientId=u7f226194-c18b-4&from=paste&id=uba4b68f7&originHeight=476&originWidth=860&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=uc2ae3c23-6082-4121-beb2-d534fbe0468&title=)<br />既然无壳那就直接上OD<br />首先要找到注册的函数，首次下载010 editor可以试用30天，点击注册按钮<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160202-67a8e9fb-253e-4978-93d6-8f9426e7a87d.png#averageHue=%23ee850d&clientId=u7f226194-c18b-4&from=paste&id=u01339538&originHeight=870&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u5a1240ae-e60a-419e-ad12-2013191c82e&title=)<br />程序会让输入用户名和注册码，随便输入试试<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160327-2e140a79-f494-4fdd-a314-7d433a3a15af.png#averageHue=%23834515&clientId=u7f226194-c18b-4&from=paste&id=ua4ddf34e&originHeight=605&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u8023a324-b7f3-42e2-9584-9ac7a5e851f&title=)<br />程序会提示无效的用户名和密码，可以根据程序提示的内容来找到对应的函数<br />通过OD的中文搜索引擎-智能搜索功能查找对应字符串<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160257-0e23b7c0-7bad-4551-9b0a-d09cf93092f4.png#averageHue=%231c1b1b&clientId=u7f226194-c18b-4&from=paste&id=u197fb07a&originHeight=644&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u24fd9aee-f076-4bb7-a26b-d981edc488f&title=)<br />找到对应的字符串，跟进函数<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160941-f667b10a-444c-459b-af3e-d25141a3105c.png#averageHue=%23272726&clientId=u7f226194-c18b-4&from=paste&id=ud0de610f&originHeight=645&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u00b76d56-43b6-4525-9731-42988babd93&title=)<br />跟进后可以看到，程序执行到输出无效的用户名和密码处，是通过一个跳转到该位置的，继续往上跟看看是那个地方跳转<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160898-67cf5a2a-9cc8-48c1-9b20-c609f8e849ff.png#averageHue=%23252423&clientId=u7f226194-c18b-4&from=paste&id=u1ded756a&originHeight=645&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u89f965b2-d6d4-4e5e-bf66-6fd43acd2da&title=)<br />发现是从0x0144B62A位置处跳转过来的，这样的话是否可以直接修改jcc执行来让程序不跳转呢<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207160938-e902e831-258b-4aee-aa77-77e065ad61f5.png#averageHue=%23596b1c&clientId=u7f226194-c18b-4&from=paste&id=u7a0f14fe&originHeight=444&originWidth=1058&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=udc048cd1-aa55-4ff9-903d-3d39be194f4&title=)<br />改成je试下，改成je后发现不对，程序会执行到0x0144B6C6的位置，提示 Password accepted but the trial period is already over，那么就继续往上跟踪<br />在跳转前边有三个cmp指令，其中0x0144B60D是从0x0144B4E2 处跳转来的<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161194-76c800f4-ada0-4380-96ce-00dd46753fa7.png#averageHue=%23232321&clientId=u7f226194-c18b-4&from=paste&id=ub0db6dd8&originHeight=643&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u862a1282-35f1-44ba-b7b9-a2f14ea8709&title=)<br />在0x0144B4E2处下断点调试一下<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161435-95e0d046-c715-4497-9af4-2431363ef579.png#averageHue=%23232221&clientId=u7f226194-c18b-4&from=paste&id=u8ffa731e&originHeight=643&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ud7ce1549-fa64-4029-bc4d-251b62e0ffd&title=)<br />在这里发现0x0144B51D的位置会输出Password accepted，所以这里把jnz改成je或者nop掉就可以了<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161432-f5bb88da-a815-4604-8edf-b7dee441432c.png#averageHue=%23a09675&clientId=u7f226194-c18b-4&from=paste&id=u3d368e80&originHeight=642&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ua310a7c0-2b56-4140-98af-ca0e996ab6c&title=)<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161375-e99a61ea-5424-48e1-97cd-830d5a7271ec.png#averageHue=%2327661a&clientId=u7f226194-c18b-4&from=paste&id=ub4ddf2f7&originHeight=672&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ue35d3b41-2eaf-47f2-ae1b-1b8c8a1f25f&title=)<br />保存出来看一下<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161398-a57d56df-2399-4cb7-848d-d01264c772c4.png#averageHue=%233b362d&clientId=u7f226194-c18b-4&from=paste&id=u061f7025&originHeight=588&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u7d4a128f-b678-4d84-a15a-fa20a432107&title=)<br />可以看到输入任意的内容已经激活成功，但是这样的话每次打开都需要点击一下check license，那么继续看看能不能让程序直接打开。<br />首先来梳理一下正常的逻辑程序是怎么运行的：首先在0x0030B3FC的位置处EAX和0xE7进行比较，此时EAX的值为0xE7，所以je跳转成立，程序运行到0x0030B4DC 处，cmp ebx,0xDB，这时候EBX的值为0x177，jnz不等于则跳转，所以此时跳转成立，跳转到0x0030B60D的位置处，这个时候程序已经跳过了验证成功的地方，继续执行，有三个cmp语句后跟jcc跳转指令，cmp ebx,0xED和cmp ebx,0x20C，这时EBX的值还是0x177，所以两个je都没有跳转，运行到第三个cmp指令cmp eax,0x93的位置，EAX此时的值为0xE7，这里是jnz指令所以跳转成功，跳转到0x0030B6E8的位置，输出无效的用户名密码，验证函数到此结束。<br />通过上面的分析当EBX等于0xDB的时候程序才会走到验证成功的位置，也就是说想要程序不每次运行都弹验证框，需要直接将0xDB赋给EBX<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161596-93901462-50e1-43f1-9440-1e65a1a3f072.png#averageHue=%2321201e&clientId=u7f226194-c18b-4&from=paste&id=u297d83f6&originHeight=823&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u526b0f22-2e83-4b16-b03c-0a3c59f29ee&title=)<br />返回到0x0030B3FC的位置继续往上跟踪可以看到EBX的值就是EAX的值，所以需要将0xDB赋给EAX，那么需要继续跟踪看看EAX的值是谁赋给的，在0x0030B3E9的位置处下断点，F8执行，发现在执行call 0x0013808A的时候EAX的值发生了变化，所以直接跟进call里面<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161781-da00c22b-4ec5-4f99-9f69-fa1fa19dc7b6.png#averageHue=%23282828&clientId=u7f226194-c18b-4&from=paste&id=u00810f1b&originHeight=644&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=u822d094c-1f01-490e-9ddd-179d2af6887&title=)<br />在开头直接给EAX赋值，mov eax,0x2d retn 0x8<br />最后把程序dump出来，发现程序直接打开就能使用了也不用每次都点击验证了。<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1669207161829-843b12a7-26e2-4a4a-a0c5-ba8a98dfe393.png#averageHue=%23964911&clientId=u7f226194-c18b-4&from=paste&id=ud03620a9&originHeight=644&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=none&taskId=ube380a32-787c-48ec-9dd4-dea27ba65b6&title=)
<a name="go87p"></a>
## 0x03 总结
其实010 editor对于新手逆向来说还是挺友好的，没有加壳，然后整个函数的逻辑也算比较清晰，更改起来也很简单，以后有时间的还是要研究一下注册验证的算法，然后写个注册机出来。
