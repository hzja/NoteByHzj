[https://www.t00ls.net/thread-61098-1-1.html](https://www.t00ls.net/thread-61098-1-1.html)
<a name="w5TFQ"></a>
### 基础命令查询
ipconfig /all       查看本机的ip段<br />net user           查看本地用户列表<br />net user /domain    查看域用户<br />net view /domain      查看内网存在多少域  net view /domain:hack 查看hack域的所以用户列表<br />net group /domain       查看域有哪些组<br />net group "domain admins" /domain    查看域管理员组，该组内的成员对域控拥有完全控制权<br /> <br />net localgroup administrators /domain         查看域管理员<br />net user username password /add /domain      添加域用户<br />net localgroup administrators workgroup\test123 /add         添加域用户 (权限不够是加不了的)<br /> <br />#迁移到管理员进程<br />migrate 2912<br /> <br />#Shell下创建用户并添加到域管理员组中<br />net user test2 root@123 /add /domain<br />net group "domain admins" test2 /add /domain<br /> <br />#meterpreter下创建用户并添加到域管理员组中,-h参数跟的是域控ip<br />add_user test3  root@123 -h 192.168.10.131<br />add_group_user "domain admins" test3 -h 192.168.10.131<br /> <br />net group "domain admins" /domain<br />net group "domain controllers" /domain                    查看所有域控<br />net time /domain           判断主域，一般的主域都是会做时间服务器这种骚操作的<br />net view /domain           查询域列表<br />net view \\ip                   查询某个ip的共享<br />net view                          查询同域的机器<br />net accounts  /domain     查询域密码策略<br />whoami /all      查询用户的权限<br />ping 域名称        获取域服务器的ip<br />dsquery computer    查看域里的计算机<br />dsquery contact      查看域里的联系人<br />dsquery group   查看域里的用户组<br />dsquery user    查看域用户<br />dsquery subnet   查看网段的划分<br />dsquery server     显示所有域控<br />dsquery subnet     查看域里的子网<br /> <br />_python_ -m SimpleHTTPServer 8080<br /> <br />net config workstation 查看计算机用户名<br />net user 用户名 （查看用户组权限<br />net user 用户名 /domain （查看域内用户权限
<a name="nBxpi"></a>
### 判断域

net config workstation<br />域<br />![图片.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1612012085500-21205d62-b5eb-420f-9379-92d0b49bede6.png#averageHue=%230f0f0f&height=216&id=yujaO&originHeight=288&originWidth=479&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7453&status=done&style=none&title=&width=359)

非域<br />![图片.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1612012130297-dfa45f09-c783-46b1-8577-10503366e038.png#averageHue=%23161412&height=236&id=xDx8o&originHeight=315&originWidth=635&originalType=binary&ratio=1&rotation=0&showTitle=false&size=24909&status=done&style=none&title=&width=476)

域<br />![图片.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1612012217716-066a9ae3-37c0-439b-91b3-de6df1f3a2e3.png#averageHue=%23181818&height=119&id=Qemld&originHeight=119&originWidth=344&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2405&status=done&style=none&title=&width=344)<br />非域<br />![图片.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1612012256025-d6938f8c-c723-4f28-b4ca-9145b9435c26.png#averageHue=%23171412&height=123&id=SoPHD&originHeight=123&originWidth=258&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5201&status=done&style=none&title=&width=258)




 <br /> <br />存在域，但是该用户不是域用户<br />![](https://cdn.nlark.com/yuque/0/2021/png/1345801/1611401383402-125ae313-3645-4f5d-85fb-a33afd928b4b.png#averageHue=%23020202&height=95&id=eL8OY&originHeight=95&originWidth=363&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=&width=363)
<a name="cLnXb"></a>
### 查看域控
方法一：net group "domain controllers" /domain       #这里查询结果后面会多一个 $<br />方法二：nltest /DCLIST:xxxx.com<br />![图片.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1611401579520-8161801c-d4b3-4c87-a96c-eb823dd98cf8.png#averageHue=%230e0e0e&height=353&id=EBc2k&originHeight=353&originWidth=577&originalType=binary&ratio=1&rotation=0&showTitle=false&size=12182&status=done&style=none&title=&width=577)<br />方法三：net time /domain<br />**方法四：nslookup -type=srv _ldap._tcp**<br />![](https://cdn.nlark.com/yuque/0/2021/png/1345801/1611401383669-54119d27-3db3-4a5e-a888-6e8205462ef4.png#averageHue=%23979696&height=268&id=VolVh&originHeight=453&originWidth=1259&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=&width=746)<br />方法五：查看DNS服务器的地址，一般DNS服务器的IP就是域控的地址<br />方法六：netdom query pdc      #该命令只能在域控上执行<br />方法七：dsquery server       #该命令只能在域控上执行<br /> 

<a name="WGZ4d"></a>
### adfind.exe

列出域控制器名称：<br />AdFind -sc dclist

查看域控版本<br />AdFind -schema -s base objectversion

查询当前域中在线的计算机：<br />AdFind -sc computers_active

查询当前域中在线的计算机(只显示名称和操作系统)：<br />AdFind -sc computers_active name operatingSystem

查询当前域中所有计算机：<br />AdFind -f "objectcategory=computer"

查询当前域中所有计算机(只显示名称和操作系统)：<br />AdFind -f "objectcategory=computer" name operatingSystem

查询域内所有用户：<br />AdFind -users name

查询所有GPO：<br />AdFind -sc gpodmp

枚举受保护AD账户:<br />Adfind -f "&(objectcategory=person)(samaccountname=*)(admincount=1)" -dn


<a name="XKEbt"></a>
### 
