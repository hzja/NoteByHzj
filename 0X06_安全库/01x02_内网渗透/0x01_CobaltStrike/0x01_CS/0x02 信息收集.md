## 新信息收集

[新信息收集](https://blog.csdn.net/qq_64973687/article/details/130279539?spm=1001.2014.3001.5501)



## 正规信息收集

+ 信息收集网址：[極客方舟 ](https://deelmind.com.cn/pentest/info/windows.html#系统信息)



## 泛域名解析

泛域名解析是指利用 * 来做子域名，实现所有的子域名都指向同一个IP地址。例如域名 deelmind.com，设置泛解析 *.deelmind.com ，则该域名下所有的子域名（如 a.deelmind.com，b.deelmind.com，c.dns-example.com等）都将指向与 *.deelmind.com 相同的IP地址



## 攻击思路

+ 公网 --> 内网
+ 信息收集

+ 漏洞扫描
+ 漏洞挖掘
+ 漏洞利用
+ 开始攻击
+ 权限维持
  + 一般上传木马并执行，反弹shell

+ 权限提升
+ 内网渗透



## Linux

### 用户信息

~~~ shell
whoami
who/w
id
finger
cat /etc/passwd
cat /etc/shadow
cat /etc/gshadow
cat /etc/group
~~~



### 进程信息

+ 进程信息

~~~ bat
ps aux
ps -efl
top
pstree -aup
~~~



+ 端口进程

~~~ shell
sudo lsof -i:22
sudo netstat -tunlp | grep 53
~~~



+ 关闭进程

~~~ shell
kill -9 PID
~~~



### 系统信息

- 主机名称

```BAT
uname -a
```



- 内核版本

```BAT
uname -srm
hostnamectl
hostnamectl | grep -i kernel
cat /proc/version
```



- CPU信息

```BAT
lscpu
cat /proc/cpuinfo
```



- 内存信息

```BAT
free -m -w
cat /proc/meminfo 
```



- 交换分区

```BAT
free -m -w
cat /proc/meminfo 
```



- 环境变量

```JS
set
```



### 启动信息





### 计划任务

```shell
schtasks
```



### 密码信息

- 查看用户密码

```shell
cat /etc/password
```

```shell
cat /etc/shadow
```



### 票据信息



### 磁盘信息



### 网络信息

- 查看网卡信息

```shell
ifconfig
```



- 查看host信息

```shell
cat /etc/hosts
```



- 查看网卡信息

```shell
ifconfig
arp -a
route print
netstat -anot
Get-NetTCPConnection
```



### 文件信息



### 服务信息

```shell
sc query
wmic service list brief
Get-WmiObject win32_service | select PathName
```



### 日志信息



###  软件信息

```shell
wmic product get name,version
```



### 驱动信息

```shell
DRIVERQUERY
```



### 后缀信息



### 注册表信息



### 防火墙信息



## MacOS



## Windows



### 用户信息

- 用户名称

```shell
net user 查看当前用户名称
whoami 查看当前用户名称 
quser（query user） 查看当前用户名称
wmic useraccount get /ALL /format:csv
```



- 用户权限

```shell
net localgroup administrators
```



### 进程信息

+ 查看进程

~~~ shell
tasklist
get-process
wmic process get caption,executablepath,commandline /format:csv
~~~



+ 筛选进程

~~~ shell
tasklist | findstr "explorer.exe"
tasklist /fi "ImageName eq explorer.exe"
tasklist /? #显示帮助信息
get-process | findstr "explorer.exe"
~~~



+ 进程端口

~~~ shell
netstat -ano | findstr "80"
~~~



+ 进程内存

~~~ shell
Dump进程内存，需要用专业的工具，什么工具都行，例如：
procdump
~~~



+ 进程权限

~~~ shell
涉及Windows编程知识，后续慢慢学习
~~~



+ 进程模块

~~~ shell
tasklist /fi "ImageName eq explorer.exe" /m
~~~



+ 模块搜索

~~~ shell
tasklist /fi "MODULES eq capauthz.dll"
~~~



### 系统信息

+ 主机名称

~~~ shell
hostname
[System.Net.DNS]::GetHostByName($Null)
~~~



### 环境变量

+ 查看变量

~~~ shell
set
~~~



+ 设置变量

~~~ shell
set test=deelmind 一次性
setx test "deelmind" 永久
~~~



### 系统版本

~~~ shell
ver 查看当前服务器操作系统版本
systeminfo 查看当前系统版本与补丁信息
~~~



### 启动信息

+ 查看自启动项

~~~ shell
dir "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"
~~~



### 计划任务

+ 查看计划任务

~~~ shell
schtasks /query
~~~



### 后缀信息

+ 查看文件关联

~~~ shell
assoc .txt
ftype | findstr txt
~~~



### 注册表项

+ 开启3389端口

~~~ shell
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f
~~~



+ 关闭3389端口

~~~ shell
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f
~~~



### 域内信息



### 密码信息



### 票据信息



### 服务信息

+ 查看服务

~~~ shell
tasklist /svc
~~~

~~~ shell
sc query
wmic service list brief
Get-WmiObject win32_service | select PathName
~~~



### 磁盘信息



### 网络信息

+ NET

~~~ shell
ipconfig
arp -a
route print
netstat -anot
Get-NetTCPConnection
~~~



### 文件信息



### 日志信息

~~~ shell
eventvwr
~~~



### 软件信息

+ 查看安装软件

~~~ shell
wmic product get name,version
~~~



### 驱动信息

+ 查看驱动信息

~~~ shell
DRIVERQUERY /V
~~~



### 防火墙信息

~~~ shell
netsh advfirewall firewall
~~~



### 域基础信息

[帮助文档](https://learn.microsoft.com/en-us/powershell/module/activedirectory/?view=windowsserver2022-ps)



+ 获取域名

~~~ shell
systeminfo | findstr /B /C:"Domain"
wmic computersystem get domain
Get-WmiObject -Namespace root\cimv2 -Class Win32_ComputerSystem | Select Name, Domain
~~~



+ 获取域信息

~~~ shell
Get-ADDomain
Get-ADDomain -Current LoggedOnUser
~~~



- 获取域用户

```shell
 Get-ADUser -LDAPFilter '(!userAccountControl:1.2.840.113556.1.4.803:=2)'
```



- 获取域计算机

```shell
Get-ADComputer -Filter *
```



- 获取域组信息

```shell
Get-ADComputer -Filter *
```



- 获取域共享信息

```shell
Get-ADComputer -Filter *
```



## 路由交换机



## 其它设备



## 网络拓扑

### 网卡/网段/子网掩码

+ ipconfig/ifconfig

~~~ shell
10.0.0.0  172.16.0.0  192.168.0.0
~~~



### 端口扫描

+ nmap/...



## 软件服务



## 漏洞扫描



## 信息溯源

视频链接：[什么是溯源](https://www.bilibili.com/video/BV1dd4y117RN/?spm_id_from=888.80997.embed_other.whitelist&t=6&vd_source=1e325091774aa31c4dcd65d8667c69de)



### 什么是溯源

溯源是往"上游"寻找"某"信息发源的地方



### 什么是威胁情报

威胁情报是识别和分析网络威胁的过程。“威胁情报”一词可以指关于潜在威胁收集的数据或收集、处理和分析该数据以更好了解威胁的过程。威胁情报包括筛选数据、根据上下文检查数据以发现问题并针对发现的问题部署解决方案



### 溯源类型

- MD5
- 公司
- 老板
- 社交ID
- 用户名
- IP溯源
- URL溯源
- 病毒溯源
- ......



### 什么是OSINT

OSINT(Open-source intelligence)开源情报信息



### OSINT在线网站

- [virustotal](https://www.virustotal.com/)
- [virusshare](https://virusshare.com/)
- [hybrid-analysis](https://www.hybrid-analysis.com/)



