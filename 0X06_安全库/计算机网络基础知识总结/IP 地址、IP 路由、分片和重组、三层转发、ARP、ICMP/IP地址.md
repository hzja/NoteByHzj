IP地址
<a name="Ve2X0"></a>
## 一、前言
说到互联网，一定听说 ip 地址这个概念，知道 ip 地址是做什么的吗？与之而来的还有公网 ip ，私网 ip ，知道有什么区别吗？
<a name="AkQpD"></a>
## 二、计算机之间点对点的交流
正常情况下，你和我都有一台电脑，但是一台电脑所能做的事情是有限的，可能两台电脑之间为了做更多的事情，需要数据交互，可以通过U盘作为媒介，进行数据交换，但这样效率实在是太慢了，于是，为了提高效率，有人想到了一个好办法，在两台电脑之间插上数据线，通过数据线进行数据交互<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515011-3ebb5cc3-0f9c-4bc2-ba44-8112629663ae.png#clientId=u25395430-f5e3-4&from=paste&id=u0047db60&originHeight=296&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u4cd6ca91-66a2-4751-9c4c-affcd03ff25&title=)<br />有了这根数据线，或者叫网线，这个两台电脑就能进行数据交互了，但是，如果不止有两台电脑呢？有多台电脑的情况下，又该这么牵网线呢？<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515051-dbec8250-4eda-4c92-86da-10eb32582e0f.png#clientId=u25395430-f5e3-4&from=paste&id=u7919b783&originHeight=340&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=ud631cbde-d507-412b-8251-f48332ab935&title=)<br />如果每一台机器为了和其他机器通讯，那就得和那台机器建立连接，如果随着机器越来越多，那网线数目会是多么复杂，这肯定是无法接收的。
<a name="ATmir"></a>
## 三、交换机
为了解决计算机之间点对点交流的复杂性，引入的交换机的概念<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515055-d74a074c-4481-4d0b-8bb9-b10a115d4704.png#clientId=u25395430-f5e3-4&from=paste&id=u78868394&originHeight=444&originWidth=512&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=ue6ebed88-aaeb-40a1-ac3d-b43a506794f&title=)<br />有了交换机之后，由交换机去分发来自每台机器的数据。<br />这时候又有新的问题，在点对点的数据连接上，两台电脑如果想进行数据交互，只需从众多的数据线中找到对应的主机的数据线，但现在都发给交换机了。交换机应该怎么去分发数据呢？这就像应该没有填清楚具体地址的包裹一样，交换机就像快递公司，你给了快递公司，没给地址，那快递公司就不知道应该把包裹发给谁。快递公司只要有快递的地址就知道该把包裹发哪儿，交换机也一样，可以为每一台机器分配一个 ip 地址。<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515065-6181798a-7b73-4adb-a717-4cc05d9c4ab1.png#clientId=u25395430-f5e3-4&from=paste&id=u8dc7dbdf&originHeight=458&originWidth=790&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u59b8b7c5-0a72-42b2-a3a3-487f1177758&title=)<br />有了IP地址之后，只需在发送的数据包里面加上对应主机的IP地址，那交换机就能根据具体的IP地址把数据发送到对应的机器。
<a name="B4OU0"></a>
## 四、局域网到广域网
通过交换机，可以让连接到交换机的计算机进行数据交流，假如这几台机器是你学校的电脑，你的学校想和隔壁学校进行业务合作，就需要彼此的电脑也进行数据交流，正好隔壁的电脑也是用的交换机进行数据交流，于是只要把两个学校的交换机连接，那两边的电脑就能相互访问了。<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515057-02f79148-119f-4be5-a762-7dbbb2d3c0c3.png#clientId=u25395430-f5e3-4&from=paste&id=u6621929d&originHeight=469&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=ua75693d1-7b22-47a7-a6d9-9a09ac7c798&title=)<br />通过连接两台交换机，让两边的电脑能数据交流，之后如果还要加更多的局域网，那在把彼此的交换机进行连接<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515341-793f2704-0e1c-4f59-bd7c-65a1b060fbe9.png#clientId=u25395430-f5e3-4&from=paste&id=u9c0b9fdf&originHeight=725&originWidth=1049&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u225cab41-1028-4ecf-b360-dce80436d75&title=)<br />随着局域网的交换机优越来越多，交换机也像之前计算机之间点对点的连接那样复杂，于是在交换机之间又放入新的交换机。<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515323-694bf944-08c5-47ec-ba36-962547bc97be.png#clientId=u25395430-f5e3-4&from=paste&id=u6a0fc423&originHeight=747&originWidth=937&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u64a3117a-08f0-462f-bf5d-6261a51d961&title=)<br />就是这样，交换机越来越多，直到覆盖全世界，只需进入其中任意一个节点，就能访问到全世界任意一条同样连接到网络的节点，这就构成了广域网。可以理解为：<br />广域网就是无数的局域网的结合。<br />很明显，搭建这些网络肯定都是需要一笔不小的资金，搭建这些网络的公司被称为 ISP 互联网服务供应商，大家所熟悉的移动，电信和联通就是 ISP 供应商，他们通过为用户提供网络赚取费用。<br />![](https://cdn.nlark.com/yuque/0/2022/jpeg/396745/1659448515404-13829228-e9a4-4d6d-a841-122189b058f4.jpeg#clientId=u25395430-f5e3-4&from=paste&id=ud5207d02&originHeight=800&originWidth=800&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=ud985ec99-558a-4052-9b1c-e7f13f26b3f&title=)
<a name="qGlFw"></a>
## 五、IPV4
互联网的每一台机器都是需要一个 IP 地址才能彼此访问的，那首先得来聊聊 IP 地址的构成。IP 地址一般说的是 IPV4 的 IP 地址，它是由 32 位构成，那 IP 地址能用的组合就是 2 的 32 次方，大于等于 42.28 亿。<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515389-44e2ef08-31e6-4f1d-8292-467b333116d4.png#clientId=u25395430-f5e3-4&from=paste&id=u0ee34d42&originHeight=313&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u47ac9dcb-a673-45a9-bc15-93c88ec76b7&title=)<br />为了方便记忆和输入，将每 8 个二进制分为一组，共 4 组，在转换为 10 进制<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515451-b76f0a40-a03c-4829-9021-1007cc6b7b4c.png#clientId=u25395430-f5e3-4&from=paste&id=u2d54fca4&originHeight=345&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u6010e1fa-2405-4adc-84d6-6d00858d2d9&title=)<br />同时，还会对 IP 地址进行分类，一些地址作为特殊用途<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515679-07956a75-642d-4226-8eef-6fc12689e58a.png#clientId=u25395430-f5e3-4&from=paste&id=u70342f85&originHeight=393&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u507a6446-e6c3-41d8-999f-1b8117bfc38&title=)<br />最后真正可用的地址可能还没有 42 亿个。已知全球一共有 70 多亿的人口，虽然不是每个人都会访问互联网，但是有很多人并不止一台设备，一个人可能有多台手机，电脑等等，如果要给每台设备都去分配一个 IP ，那这 42 亿的 IP 地址够用吗？完全不够。
<a name="MbdRX"></a>
## 六、NAT 网络地址转换
为了解决IP不够用的问题使用了一项新的技术，**NAT 网络地址转换**。假如有五台计算机，他们的IP地址是192.168.0.1----192.168.0.5，他们接入了同一台交换机，或者叫路由器，他们接入的这台交换机的广域网IP是6.6.6.6<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515744-37b90f1a-811a-4d87-8df7-c4607e7f514a.png#clientId=u25395430-f5e3-4&from=paste&id=ucfc69bc5&originHeight=269&originWidth=826&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u691bffda-32ec-4828-b0b1-702f08c0881&title=)<br />如果这五台机器要向一台 8.8.8.8 的服务器发送数据，那 NAT 就会把这几台计算机原有的 ip 转换成 6.6.6.6 的 ip 向 8.8.8.8 发送数据，实现 5 台设备共用一个 IP 的效果 。<br />如果 8.8.8.8 这个交换机下面也挂载了很多设备，那这五台服务器都是按照8.8.8.8这个机器发送的，那有怎么发送到8.8.8.8下面挂载的具体设备呢？<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515776-3431d74c-f1b1-4c6e-a025-c78af7956b93.png#clientId=u25395430-f5e3-4&from=paste&id=ue2aca7cb&originHeight=562&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=ude109063-12c1-4ad3-88ab-06f0a833c17&title=)
<a name="vgutx"></a>
## 七、端口映射
为了解决上面的问题，引入了一个新的概念，**端口映射**。可以在IP地址的后面加上一个端口，如图<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515728-8fc0bce6-fa7b-4e04-a246-c4240225eb06.png#clientId=u25395430-f5e3-4&from=paste&id=u0418f11b&originHeight=564&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u9b0a4e92-9138-4f16-b914-e778e097979&title=)<br />比如 192.168.0.1 和 6.6.6.6 的 1000 端口绑定，另一边的 192.168.0.1 和 8.8.8.8 的 500 端口绑定，这样，如果 6.6.6.6 下挂载的机器想访问 8.8.8.8 下挂载的机器，只需要加上对应的端口就行了。
<a name="PIAIY"></a>
## 八、公网IP和私有IP
如果打开 cmd，输入 ipconfig 查看IP地址<br />会看的ip地址是 192.168 开头的，为什么？刚刚提到，ip地址是不够用的，但为了使大多数的机器都能上网，通常是多台机器共用一个公网ip，去百度搜索 ip 查询，<br />![](https://cdn.nlark.com/yuque/0/2022/png/396745/1659448515810-39865860-ce27-49c4-b44d-ab3ed7fcc123.png#clientId=u25395430-f5e3-4&from=paste&id=ufff47984&originHeight=414&originWidth=1080&originalType=url&ratio=1&rotation=0&showTitle=false&status=done&style=shadow&taskId=u69377188-40e5-4d77-85c3-f84882aea42&title=)<br />就能看见当前设备所挂载的公网ip了。现在知道为什么很多 ip 都是 192.168 开头的了吧？因为这是挂载到了一个小的中转设备下的 C 类私有 ip，在这个私类 ip 下依赖转换器的公网 ip 上网。<br />打个比如，公网 ip 就是你小区的名称，私网 ip 就是你住的楼层单元，假设全国小区名字都不重复，那根据小区名字，就可以找到你的大概位置，这就相当于根据公网IP定位到你具体的局域网，但是为了知道你具体位置，那还需要知道你是这个小区几单元几号，小区的几单元几号这玩意儿每个小区都有，这就相当于私网IP，很多机器的私网IP都是重复的。
