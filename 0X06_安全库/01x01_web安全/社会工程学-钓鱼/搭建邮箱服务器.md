<a name="BfbLg"></a>
## 需要的东西
1、首先需要服务器能开25端口(很多厂商服务器都不允许开启25端口<br />2、域名这一块建议用外国服务器和外国域名(如果是腾讯、阿里的话建议买香港那边，注意是云服务器哦）<br />3、建议是centos7版本，搭建ewomail很好用，开发团队日常都会维护([http://doc.ewomail.com/docs/ewomail/install](http://doc.ewomail.com/docs/ewomail/install))

<a name="d9KHO"></a>
## 安装ewoamil
vi /etc/sysconfig/selinux 确保第一个SELINUX是disabled<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654094297700-b0014bf0-9778-4868-a017-92b75a3deeff.png#clientId=ub144a563-d3fc-4&from=paste&height=231&id=ue73d0c9b&originHeight=252&originWidth=677&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21432&status=done&style=none&taskId=uf1f29c5d-6ed7-44d7-b411-b17d22fe903&title=&width=621.6000366210938)

```html
yum -y install git
cd /root
git clone https://gitee.com/laowu5/EwoMail.git
cd /root/EwoMail/install
#需要输入一个邮箱域名，不需要前缀，最好是用自己的域名
sh ./start.sh ewomail.cn
```

![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654243071120-0ad50e97-6bab-4f6d-9301-5526019574f5.png#clientId=u9ce123ee-6914-4&from=paste&height=249&id=uea5726ec&originHeight=234&originWidth=610&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16975&status=done&style=none&taskId=u177672b6-0b65-432b-b9f7-87a0a313195&title=&width=649)<br />安装成功后 ip:8010 或者绑定好的域名:8010端口，就可以访问到后台，默认账号密码   admin/ewomail123  <br />[http://xxx.xxx:8010/System/index](http://cfca.site:8010/System/index)<br />修改默认密码<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654245362026-662bd811-778d-453a-9996-ce6e358193df.png#clientId=u9ce123ee-6914-4&from=paste&height=566&id=u8ead7a13&originHeight=707&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=86743&status=done&style=none&taskId=ubae8c465-64fb-4c41-a9fa-6614657b181&title=&width=1536)

<a name="Wu6SY"></a>
## 域名、smtp等配置
域名安装配置，需要到买域名的服务商那边配置好域名解析记录，@是域名绑定服务器ip。 imap、smtp、pop是邮箱必要条件，都必须指向服务器ip<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654246038597-cf0f848e-6746-43c8-8913-6e7b725cbb83.png#clientId=u60801dd5-2681-4&from=paste&height=268&id=udaf33d1e&originHeight=672&originWidth=1353&originalType=binary&ratio=1&rotation=0&showTitle=false&size=63931&status=done&style=none&taskId=u956516a2-378a-4e2b-8760-4e32f6c9feb&title=&width=539.6000366210938)<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654265014063-808d31c1-c42c-4c11-8efd-e1595da6712a.png#clientId=u511a1a41-3264-4&from=paste&height=66&id=u3269ee02&originHeight=82&originWidth=931&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4054&status=done&style=none&taskId=u48fb4c2b-f975-4fd9-80c8-2c9cf5947ea&title=&width=744.8)

配置好后，跑回8010端口去配置邮箱系统的设置<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654265237970-4423e1c0-b40a-4c1b-b408-17471c01c90d.png#clientId=u79393fc6-3a75-4&from=paste&height=490&id=uc8576ac0&originHeight=613&originWidth=1264&originalType=binary&ratio=1&rotation=0&showTitle=false&size=105912&status=done&style=none&taskId=ue7c77efd-35dd-4df2-9181-c6819303099&title=&width=1011.2)

保存后，测试25端口是否成功  telnet smtp.xxxx.com 25<br />如果回应是mail的邮箱Postfix协议那就没问题了。<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654246456499-c419b847-92ce-4f37-b4b1-295eddc30fcc.png#clientId=u60801dd5-2681-4&from=paste&height=145&id=ue231c8bc&originHeight=125&originWidth=368&originalType=binary&ratio=1&rotation=0&showTitle=false&size=8070&status=done&style=none&taskId=u229ec769-9c0a-4ba7-b94f-03de913e0bb&title=&width=426.3999938964844)

<a name="ok5Rg"></a>
## 邮箱发件(关于spf设置
在8010端口的后台添加需要发送邮件的账号，最好是有设置txt记录的域名配置，这样子就可以通过spf检测。<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654246782447-4a5df450-ed29-4890-aae4-380f78bbb0a0.png#clientId=u60801dd5-2681-4&from=paste&height=452&id=u5148bba1&originHeight=565&originWidth=1083&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52349&status=done&style=none&taskId=ua5bfb262-a7a6-4ec7-be3c-4dc520d94e9&title=&width=866.4)<br />访问对应的8000端口，用8010设添加的邮箱账号登陆。<br />[http://mail.xxx.xxxx:8000/](http://mail.cfca.site:8000/)<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654247017291-8cfefc2d-996c-42f1-aa4d-5ea375bbc165.png#clientId=u60801dd5-2681-4&from=paste&height=189&id=u1eb752eb&originHeight=623&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&size=164336&status=done&style=none&taskId=u3b74b7f3-9948-401d-839a-2b4ed5c2db3&title=&width=582.6000366210938)

这个时候如果对一些没有进行spf校验的企业邮箱，是可以发送邮件过去的，域名也是可以随意伪造，不需要购买，但是对一些金融行业来说邮箱网关比较严格，会检测spf，所以得在域名服务商处配置TXT设置，但是这个TXT配置解析可能需要一定的时间，需要等30分钟到1个小时，才能解析好，这个时候有spf的校验，就可以成功发送邮箱到有spf校验的地址了。<br />"v=spf1 ip4:ip"<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654264975861-df8311da-2138-4f44-9127-90cf2d9f1d83.png#clientId=u511a1a41-3264-4&from=paste&height=78&id=uf56a122a&originHeight=98&originWidth=924&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3613&status=done&style=none&taskId=u9de3114b-8d2e-4857-a0e8-95fe55b517e&title=&width=739.2)

<a name="jfY6S"></a>
## 如果变更钓鱼目标
如果变更的钓鱼目标邮箱会有spf校验，那么需要重新购买一个域名，然后重新配置域名的解析，ewomail会出现"域不匹配"等问题，需要在服务器上重新配置hosts文件和/root/mail/EwoMail/ewomail-admin/core<br />core/config.php目录下的配置路由<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1654265763535-6a682092-3803-4f72-b211-dde2d8aa39d7.png#clientId=u2b6cc8f5-5690-4&from=paste&height=383&id=u6a26eae7&originHeight=407&originWidth=612&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44449&status=done&style=none&taskId=ub1a2dc8e-6828-4ce3-a9dc-ec79bc7a58c&title=&width=575.6000061035156)
