最近在客户现场搞渗透测试，waf+后端过滤太猛，没挖到什么洞，后来突然想到改变请求的格式，果然触发了漏洞...

功能点如下所示，新建个test的流程。<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1647244175150-c35ae7ad-fe35-4204-9f99-7c36a8e45643.png#clientId=ua2a8a0b9-4d02-4&from=paste&height=284&id=u330cda25&originHeight=390&originWidth=1164&originalType=binary&ratio=1&rotation=0&showTitle=false&size=30092&status=done&style=none&taskId=u6bff654e-8900-45a7-9863-75e70c09533&title=&width=846.5454545454545)

直接插入个xss的payload<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1647243721508-d15dfeca-eeda-48c0-a03e-0e9ba30e4433.png#clientId=u396f8dc1-8dab-4&from=paste&height=367&id=ucd8f2af8&originHeight=504&originWidth=1399&originalType=binary&ratio=1&rotation=0&showTitle=false&size=27410&status=done&style=none&taskId=ud508e705-bbf1-4f9c-981d-4c7c42ff207&title=&width=1017.4545454545455)<br />插入完发现一看，">符合被实体了，而且后面的内容都没了。判断是后端过滤了。<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1647243778197-e5d8eb85-6860-4884-b946-3cac7f79dfb3.png#clientId=u396f8dc1-8dab-4&from=paste&height=588&id=u1a7bbe7f&originHeight=808&originWidth=1327&originalType=binary&ratio=1&rotation=0&showTitle=false&size=123145&status=done&style=none&taskId=u5112e091-476d-43ce-958c-1c1348e8a58&title=&width=965.0909090909091)

脑回路一转，把post请求改变成mutipart格式，响应包显示成功。<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1647243836404-45efefa9-acbc-4dea-bf3c-f361b4d5226d.png#clientId=u396f8dc1-8dab-4&from=paste&height=540&id=u0fd9c33c&originHeight=742&originWidth=1394&originalType=binary&ratio=1&rotation=0&showTitle=false&size=52746&status=done&style=none&taskId=uc44ad34b-acef-428e-9921-89a765c8f51&title=&width=1013.8181818181819)

果不其然，成功弹框了，存储型xss  高危，安服仔可以宣布下班了嘿嘿。<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/1345801/1647243882993-07aea576-1d39-464f-a80a-c5b0ff59d1c6.png#clientId=u396f8dc1-8dab-4&from=paste&height=348&id=uddb52c49&originHeight=299&originWidth=596&originalType=binary&ratio=1&rotation=0&showTitle=false&size=66383&status=done&style=none&taskId=u8741816f-3a1b-4b1e-ada4-8d0730501f2&title=&width=694.4545593261719)
